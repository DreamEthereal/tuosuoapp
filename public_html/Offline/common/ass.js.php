<?php
//dezend by http://www.yunlu99.com/
echo '//判断存在选项关联关系' . "\r\n" . 'function _IsOptAssCond( qtnID )' . "\r\n" . '{' . "\r\n" . '	if( typeof OassListArray[qtnID] == \'undefined\') return false;' . "\r\n" . '	return true;' . "\r\n" . '}	' . "\r\n" . '' . "\r\n" . '//得到选项关联关系计算表达式' . "\r\n" . 'function _GetOptAssCond( qtnID,optionID )' . "\r\n" . '{' . "\r\n" . '	//题间关系' . "\r\n" . '	switch(QtnListArray[qtnID].questionType )' . "\r\n" . '	{' . "\r\n" . '		case 2:' . "\r\n" . '		case 24:' . "\r\n" . '			var isLogicAnd = RadioListArray[qtnID][optionID].isLogicAnd;' . "\r\n" . '		break;' . "\r\n" . '		case 3:' . "\r\n" . '		case 25:' . "\r\n" . '			var isLogicAnd = CheckBoxListArray[qtnID][optionID].isLogicAnd;' . "\r\n" . '		break;' . "\r\n" . '		case 6:' . "\r\n" . '		case 7:' . "\r\n" . '		case 19:' . "\r\n" . '		case 28:' . "\r\n" . '			var isLogicAnd = AnswerListArray[qtnID][optionID].isLogicAnd;' . "\r\n" . '		break;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//逻辑关系' . "\r\n" . '	var j = 0;' . "\r\n" . '	var conList = \'\';' . "\r\n" . '	if( typeof OassListArray[qtnID] == \'undefined\') return conList;' . "\r\n" . '	if( typeof OassListArray[qtnID][optionID] == \'undefined\') return conList;' . "\r\n" . '	for( var condOnID in OassListArray[qtnID][optionID] )' . "\r\n" . '	{' . "\r\n" . '	    var theCondOnIDArray = OassListArray[qtnID][optionID][condOnID];' . "\r\n" . '		var condOnID_QuestionType = QtnListArray[condOnID].questionType;' . "\r\n" . '		//1,2,3,6,7,24,25,30,19,28,17,4,23,10,15,16,20,21,22,31' . "\r\n" . '		switch(condOnID_QuestionType)' . "\r\n" . '		{' . "\r\n" . '			case 1: //YesNo' . "\r\n" . '			case 2: //Radio' . "\r\n" . '			case 3: //CheckBox' . "\r\n" . '			case 4: //Text' . "\r\n" . '			case 24: //CombRadio' . "\r\n" . '			case 25: //CombCheckBox' . "\r\n" . '			case 30: //Empty' . "\r\n" . '			case 17: //Auto' . "\r\n" . '				var Con_Total = count(theCondOnIDArray[0]); //qtnID=0' . "\r\n" . '				var i = 0;' . "\r\n" . '				if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '				for( var p in theCondOnIDArray[0] )' . "\r\n" . '				{' . "\r\n" . '					var theOptionArray = theCondOnIDArray[0][p];' . "\r\n" . '					i++;' . "\r\n" . '					if( condOnID_QuestionType == 4 )  //数值填空' . "\r\n" . '					{' . "\r\n" . '						switch(theOptionArray[1])' . "\r\n" . '						{' . "\r\n" . '							case 1:opertion = \'==\';break;' . "\r\n" . '							case 2:opertion = \'<\';break;' . "\r\n" . '							case 3:opertion = \'<=\';break;' . "\r\n" . '							case 4:opertion = \'>\';break;' . "\r\n" . '							case 5:opertion = \'>=\';break;' . "\r\n" . '							case 6:opertion = \'!=\';break;' . "\r\n" . '						}' . "\r\n" . '						if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '						else opertionRelation = \' && \';' . "\r\n" . '						conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '						else{' . "\r\n" . '							if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '							else opertionRelation = \' || \';' . "\r\n" . '						}' . "\r\n" . '						switch( condOnID_QuestionType )' . "\r\n" . '						{' . "\r\n" . '							case 1: //是非题' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 2:  //单选题						   ' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \\\'\'+theOptionArray[0]+\'\\\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 3:  //复选题						   ' . "\r\n" . '								if( theOptionArray[3] == 2 )  //计算模式' . "\r\n" . '								{' . "\r\n" . '									switch(theOptionArray[1])' . "\r\n" . '									{' . "\r\n" . '										case 1:opertion = \'==\';break;' . "\r\n" . '										case 2:opertion = \'<\';break;' . "\r\n" . '										case 3:opertion = \'<=\';break;' . "\r\n" . '										case 4:opertion = \'>\';break;' . "\r\n" . '										case 5:opertion = \'>=\';break;' . "\r\n" . '										case 6:opertion = \'!=\';break;' . "\r\n" . '									}' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else opertionRelation = \' && \';' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'(getCheckBoxSelNum(document.Survey_Form.option_\'+condOnID+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += "( getID(\'option_"+condOnID+"\') != null && getID(\'option_"+condOnID+"\').value.split(\',\').length "+opertion+" "+theOptionArray[0]+")"+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 17:' . "\r\n" . '								if( QtnListArray[condOnID].isSelect == 1 )  //单选' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 24:  //复合单选题						   ' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 25:  //复合复选题						   ' . "\r\n" . '								if( theOptionArray[3] == 2 )  //计算模式' . "\r\n" . '								{' . "\r\n" . '									switch(theOptionArray[1])' . "\r\n" . '									{' . "\r\n" . '										case 1:opertion = \'==\';break;' . "\r\n" . '										case 2:opertion = \'<\';break;' . "\r\n" . '										case 3:opertion = \'<=\';break;' . "\r\n" . '										case 4:opertion = \'>\';break;' . "\r\n" . '										case 5:opertion = \'>=\';break;' . "\r\n" . '										case 6:opertion = \'!=\';break;' . "\r\n" . '									}' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else opertionRelation = \' && \';' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'(getCheckBoxSelNum(document.Survey_Form.option_\'+condOnID+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += "( getID(\'option_"+condOnID+"\') != null && getID(\'option_"+condOnID+"\').value.split(\',\').length "+opertion+" "+theOptionArray[0]+")"+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 30: //空题' . "\r\n" . '								if( theOptionArray[1] == 1 )  //等于' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[0] == 1 )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) == 1 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) == 0 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[0] == 1 )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) != 1 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) != 0 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;	' . "\r\n" . '						} //end of switch' . "\r\n" . '					} //end of if' . "\r\n" . '				} //end of foreach' . "\r\n" . '				if( Con_Total >= 2 )	conList += \')\';' . "\r\n" . '			break;' . "\r\n" . '			case 6:  //Range' . "\r\n" . '			case 7:  //Multiple' . "\r\n" . '			case 19: //AutoRange' . "\r\n" . '			case 28: //AutoMultiple' . "\r\n" . '			case 23: //CombText' . "\r\n" . '			case 10: //Rank' . "\r\n" . '			case 15: //Rating' . "\r\n" . '			case 16: //Weight' . "\r\n" . '			case 20: //AutoRank' . "\r\n" . '			case 21: //AutoRating' . "\r\n" . '			case 22: //AutoWeight' . "\r\n" . '			case 31: //级联' . "\r\n" . '				var RangeTotal = count(theCondOnIDArray); ' . "\r\n" . '				var k = 0;' . "\r\n" . '				if( RangeTotal >= 2 )  conList += \'(\';' . "\r\n" . '				for( var theRangeID in theCondOnIDArray )' . "\r\n" . '				{' . "\r\n" . '					var theRangeArray = theCondOnIDArray[theRangeID];' . "\r\n" . '					var i = 0;' . "\r\n" . '					var Con_Total = count(theRangeArray);' . "\r\n" . '					if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '					for( var p in theRangeArray )' . "\r\n" . '					{' . "\r\n" . '						var theOptionArray = theRangeArray[p];' . "\r\n" . '						i++;' . "\r\n" . '						switch( condOnID_QuestionType )' . "\r\n" . '						{' . "\r\n" . '							case 23:' . "\r\n" . '							case 10:' . "\r\n" . '							case 16:' . "\r\n" . '							case 20:' . "\r\n" . '							case 22:' . "\r\n" . '								switch(theOptionArray[1])' . "\r\n" . '								{' . "\r\n" . '									case 1:opertion = \'==\';break;' . "\r\n" . '									case 2:opertion = \'<\';break;' . "\r\n" . '									case 3:opertion = \'<=\';break;' . "\r\n" . '									case 4:opertion = \'>\';break;' . "\r\n" . '									case 5:opertion = \'>=\';break;' . "\r\n" . '									case 6:opertion = \'!=\';break;' . "\r\n" . '								}' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else opertionRelation = \' && \';' . "\r\n" . '								conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '							break;' . "\r\n" . '							case 15:' . "\r\n" . '							case 21:' . "\r\n" . '								switch(theOptionArray[1])' . "\r\n" . '								{' . "\r\n" . '									case 1:opertion = \'==\';break;' . "\r\n" . '									case 2:opertion = \'<\';break;' . "\r\n" . '									case 3:opertion = \'<=\';break;' . "\r\n" . '									case 4:opertion = \'>\';break;' . "\r\n" . '									case 5:opertion = \'>=\';break;' . "\r\n" . '									case 6:opertion = \'!=\';break;' . "\r\n" . '								}' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else opertionRelation = \' && \';' . "\r\n" . '								switch( QtnListArray[condOnID].isSelect )' . "\r\n" . '								{' . "\r\n" . '									case 0:' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\') != \\\'\\\' && getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\') != 99 && parseInt(getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\') * \'+QtnListArray[condOnID].weight+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != 99 && parseInt(getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value * \'+QtnListArray[condOnID].weight+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 1:' . "\r\n" . '									case 2:' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 6:' . "\r\n" . '							case 19:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '									else opertionRelation = \' || \';' . "\r\n" . '								}' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 7:' . "\r\n" . '							case 28:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '									else opertionRelation = \' || \';' . "\r\n" . '								}' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 31:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '									else opertionRelation = \' || \';' . "\r\n" . '								}' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '						} //end of switch' . "\r\n" . '					}//end of foreach' . "\r\n" . '					if( Con_Total >= 2 )  conList += \')\';					' . "\r\n" . '					k++;' . "\r\n" . '					if( k != RangeTotal )' . "\r\n" . '					{' . "\r\n" . '						if( isLogicAnd == 1) { conList += \' && \'; }' . "\r\n" . '						else { conList += \' || \'; }' . "\r\n" . '					}' . "\r\n" . '				}//end of foreach' . "\r\n" . '				if( RangeTotal >= 2 )  conList += \')\';' . "\r\n" . '			break;' . "\r\n" . '		} //end of switch' . "\r\n" . '		' . "\r\n" . '		j ++;' . "\r\n" . '		if( j != count(OassListArray[qtnID][optionID]))' . "\r\n" . '		{' . "\r\n" . '			if( isLogicAnd == 1) { conList += \' && \'; }' . "\r\n" . '			else { conList += \' || \'; }' . "\r\n" . '		}' . "\r\n" . '	} //end of foreach' . "\r\n" . '	return conList;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//得到矩阵行关联关系表达式' . "\r\n" . 'function _GetQtnAssCond( qtnID,rangeQtnID )' . "\r\n" . '{' . "\r\n" . '	//题间关系' . "\r\n" . '	switch(QtnListArray[qtnID].questionType )' . "\r\n" . '	{' . "\r\n" . '		case 6:' . "\r\n" . '		case 7:' . "\r\n" . '		case 26:' . "\r\n" . '		case 27:' . "\r\n" . '			var isLogicAnd = OptionListArray[qtnID][rangeQtnID].isLogicAnd;' . "\r\n" . '		break;' . "\r\n" . '		case 10:' . "\r\n" . '		case 15:' . "\r\n" . '		case 16:' . "\r\n" . '			var isLogicAnd = RankListArray[qtnID][rangeQtnID].isLogicAnd;' . "\r\n" . '		break;' . "\r\n" . '	}' . "\r\n" . '	' . "\r\n" . '	//逻辑关系' . "\r\n" . '	var j = 0;' . "\r\n" . '	var conList = \'\';' . "\r\n" . '	if( typeof QassListArray[qtnID] == \'undefined\') return conList;' . "\r\n" . '	if( typeof QassListArray[qtnID][rangeQtnID] == \'undefined\') return conList;' . "\r\n" . '	for( var condOnID in QassListArray[qtnID][rangeQtnID] )' . "\r\n" . '	{' . "\r\n" . '		var theCondOnIDArray = QassListArray[qtnID][rangeQtnID][condOnID];' . "\r\n" . '		var condOnID_QuestionType = QtnListArray[condOnID].questionType;' . "\r\n" . '		switch(condOnID_QuestionType)' . "\r\n" . '		{' . "\r\n" . '			case 1: //YesNo' . "\r\n" . '			case 2: //Radio' . "\r\n" . '			case 3: //CheckBox' . "\r\n" . '			case 4: //Text' . "\r\n" . '			case 24: //CombRadio' . "\r\n" . '			case 25: //CombCheckBox' . "\r\n" . '			case 30: //Empty' . "\r\n" . '			case 17: //Auto' . "\r\n" . '				var Con_Total = count(theCondOnIDArray[0]); //qtnID=0' . "\r\n" . '				var i = 0;' . "\r\n" . '				if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '				for( var p in theCondOnIDArray[0] )' . "\r\n" . '				{' . "\r\n" . '					var theOptionArray = theCondOnIDArray[0][p];' . "\r\n" . '					i++;' . "\r\n" . '					if( condOnID_QuestionType == 4 )  //数值填空' . "\r\n" . '					{' . "\r\n" . '						switch(theOptionArray[1])' . "\r\n" . '						{' . "\r\n" . '							case 1:opertion = \'==\';break;' . "\r\n" . '							case 2:opertion = \'<\';break;' . "\r\n" . '							case 3:opertion = \'<=\';break;' . "\r\n" . '							case 4:opertion = \'>\';break;' . "\r\n" . '							case 5:opertion = \'>=\';break;' . "\r\n" . '							case 6:opertion = \'!=\';break;' . "\r\n" . '						}' . "\r\n" . '						if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '						else opertionRelation = \' && \';' . "\r\n" . '						conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '						else{' . "\r\n" . '							if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '							else opertionRelation = \' || \';' . "\r\n" . '						}' . "\r\n" . '						switch( condOnID_QuestionType )' . "\r\n" . '						{' . "\r\n" . '							case 1: //是非题' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 2:  //单选题						   ' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \\\'\'+theOptionArray[0]+\'\\\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 3:  //复选题						   ' . "\r\n" . '								if( theOptionArray[3] == 2 )  //计算模式' . "\r\n" . '								{' . "\r\n" . '									switch(theOptionArray[1])' . "\r\n" . '									{' . "\r\n" . '										case 1:opertion = \'==\';break;' . "\r\n" . '										case 2:opertion = \'<\';break;' . "\r\n" . '										case 3:opertion = \'<=\';break;' . "\r\n" . '										case 4:opertion = \'>\';break;' . "\r\n" . '										case 5:opertion = \'>=\';break;' . "\r\n" . '										case 6:opertion = \'!=\';break;' . "\r\n" . '									}' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else opertionRelation = \' && \';' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'(getCheckBoxSelNum(document.Survey_Form.option_\'+condOnID+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += "( getID(\'option_"+condOnID+"\') != null && getID(\'option_"+condOnID+"\').value.split(\',\').length "+opertion+" "+theOptionArray[0]+")"+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 17:' . "\r\n" . '								if( QtnListArray[condOnID].isSelect == 1 )  //单选' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 24:  //复合单选题						   ' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 25:  //复合复选题						   ' . "\r\n" . '								if( theOptionArray[3] == 2 )  //计算模式' . "\r\n" . '								{' . "\r\n" . '									switch(theOptionArray[1])' . "\r\n" . '									{' . "\r\n" . '										case 1:opertion = \'==\';break;' . "\r\n" . '										case 2:opertion = \'<\';break;' . "\r\n" . '										case 3:opertion = \'<=\';break;' . "\r\n" . '										case 4:opertion = \'>\';break;' . "\r\n" . '										case 5:opertion = \'>=\';break;' . "\r\n" . '										case 6:opertion = \'!=\';break;' . "\r\n" . '									}' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else opertionRelation = \' && \';' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'(getCheckBoxSelNum(document.Survey_Form.option_\'+condOnID+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += "( getID(\'option_"+condOnID+"\') != null && getID(\'option_"+condOnID+"\').value.split(\',\').length "+opertion+" "+theOptionArray[0]+")"+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 30: //空题' . "\r\n" . '								if( theOptionArray[1] == 1 )  //等于' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[0] == 1 )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) == 1 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) == 0 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[0] == 1 )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) != 1 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) != 0 )\'+opertionRelation;	' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;	' . "\r\n" . '						} //end of switch' . "\r\n" . '					} //end of if' . "\r\n" . '				} //end of foreach' . "\r\n" . '				if( Con_Total >= 2 )	conList += \')\';' . "\r\n" . '			break;' . "\r\n" . '			case 6:  //Range' . "\r\n" . '			case 7:  //Multiple' . "\r\n" . '			case 19: //AutoRange' . "\r\n" . '			case 28: //AutoMultiple' . "\r\n" . '			case 23: //CombText' . "\r\n" . '			case 10: //Rank' . "\r\n" . '			case 15: //Rating' . "\r\n" . '			case 16: //Weight' . "\r\n" . '			case 20: //AutoRank' . "\r\n" . '			case 21: //AutoRating' . "\r\n" . '			case 22: //AutoWeight' . "\r\n" . '			case 31: //级联' . "\r\n" . '				var RangeTotal = count(theCondOnIDArray); ' . "\r\n" . '				var k = 0;' . "\r\n" . '				if( RangeTotal >= 2 )  conList += \'(\';' . "\r\n" . '				for( var theRangeID in theCondOnIDArray )' . "\r\n" . '				{' . "\r\n" . '					var theRangeArray = theCondOnIDArray[theRangeID];' . "\r\n" . '					var i = 0;' . "\r\n" . '					var Con_Total = count(theRangeArray);' . "\r\n" . '					if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '					for( var p in theRangeArray )' . "\r\n" . '					{' . "\r\n" . '						var theOptionArray = theRangeArray[p];' . "\r\n" . '						i++;' . "\r\n" . '						switch( condOnID_QuestionType )' . "\r\n" . '						{' . "\r\n" . '							case 23:' . "\r\n" . '							case 10:' . "\r\n" . '							case 16:' . "\r\n" . '							case 20:' . "\r\n" . '							case 22:' . "\r\n" . '								switch(theOptionArray[1])' . "\r\n" . '								{' . "\r\n" . '									case 1:opertion = \'==\';break;' . "\r\n" . '									case 2:opertion = \'<\';break;' . "\r\n" . '									case 3:opertion = \'<=\';break;' . "\r\n" . '									case 4:opertion = \'>\';break;' . "\r\n" . '									case 5:opertion = \'>=\';break;' . "\r\n" . '									case 6:opertion = \'!=\';break;' . "\r\n" . '								}' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else opertionRelation = \' && \';' . "\r\n" . '								conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '							break;' . "\r\n" . '							case 15:' . "\r\n" . '							case 21:' . "\r\n" . '								switch(theOptionArray[1])' . "\r\n" . '								{' . "\r\n" . '									case 1:opertion = \'==\';break;' . "\r\n" . '									case 2:opertion = \'<\';break;' . "\r\n" . '									case 3:opertion = \'<=\';break;' . "\r\n" . '									case 4:opertion = \'>\';break;' . "\r\n" . '									case 5:opertion = \'>=\';break;' . "\r\n" . '									case 6:opertion = \'!=\';break;' . "\r\n" . '								}' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else opertionRelation = \' && \';' . "\r\n" . '								switch( QtnListArray[condOnID].isSelect )' . "\r\n" . '								{' . "\r\n" . '									case 0:' . "\r\n" . '										if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\') != \\\'\\\' && getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\') != 99 && parseInt(getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\') * \'+QtnListArray[condOnID].weight+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != 99 && parseInt(getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value * \'+QtnListArray[condOnID].weight+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 1:' . "\r\n" . '									case 2:' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 6:' . "\r\n" . '							case 19:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '									else opertionRelation = \' || \';' . "\r\n" . '								}' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 7:' . "\r\n" . '							case 28:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '									else opertionRelation = \' || \';' . "\r\n" . '								}' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 31:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '									else opertionRelation = \' || \';' . "\r\n" . '								}' . "\r\n" . '								if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( IsSamePage(qtnID,condOnID) )' . "\r\n" . '									{' . "\r\n" . '										conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '						} //end of switch' . "\r\n" . '					}//end of foreach' . "\r\n" . '					if( Con_Total >= 2 )  conList += \')\';					' . "\r\n" . '					k++;' . "\r\n" . '					if( k != RangeTotal )' . "\r\n" . '					{' . "\r\n" . '						if( isLogicAnd == 1) { conList += \' && \'; }' . "\r\n" . '						else { conList += \' || \'; }' . "\r\n" . '					}' . "\r\n" . '				}//end of foreach' . "\r\n" . '				if( RangeTotal >= 2 )  conList += \')\';' . "\r\n" . '			break;' . "\r\n" . '		} //end of switch' . "\r\n" . '' . "\r\n" . '		j ++;' . "\r\n" . '		if( j != count(QassListArray[qtnID][rangeQtnID]))' . "\r\n" . '		{' . "\r\n" . '			if( isLogicAnd == 1) { conList += \' && \'; }' . "\r\n" . '			else { conList += \' || \'; }' . "\r\n" . '		}' . "\r\n" . '	} //end of foreach' . "\r\n" . '	return conList;' . "\r\n" . '}';

?>
