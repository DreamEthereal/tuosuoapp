<?php
//dezend by http://www.yunlu99.com/
echo 'function _GetSurveyQuotaCond( thisQuestionID,surveyID,surveyLang )' . "\r\n" . '{' . "\r\n" . '    //是否存在本题的配额关系' . "\r\n" . '    var theQtnQuotaRelArray = new Array();' . "\r\n" . '	var o=0;' . "\r\n" . '	for( var theQtnQuotaID in QuotaListArray )' . "\r\n" . '	{' . "\r\n" . '		var theKeyArray = array_keys(QuotaListArray[theQtnQuotaID]);' . "\r\n" . '		var theLastQuestionID = theKeyArray[count(theKeyArray)-1];' . "\r\n" . '		if( parseInt(theLastQuestionID) == parseInt(thisQuestionID) )' . "\r\n" . '		{' . "\r\n" . '			if( theQtnQuotaID != \'\' )' . "\r\n" . '			{' . "\r\n" . '				theQtnQuotaRelArray[o] = theQtnQuotaID;' . "\r\n" . '				o++;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	if( count(theQtnQuotaRelArray) == 0 ) return \'\';' . "\r\n" . '' . "\r\n" . '    //组装本题所有的配额定义' . "\r\n" . '	var endConList = \'\';' . "\r\n" . '	for( var t=0;t<theQtnQuotaRelArray.length;t++ )' . "\r\n" . '	{' . "\r\n" . '		var theQuotaID = theQtnQuotaRelArray[t];' . "\r\n" . '		//开始拼装单一Quota定义的表达式' . "\r\n" . '		var j = 0;' . "\r\n" . '		var conList = \'\';' . "\r\n" . '		for( var condOnID in QuotaListArray[theQuotaID] )' . "\r\n" . '		{' . "\r\n" . '			var theCondOnIDArray = QuotaListArray[theQuotaID][condOnID];' . "\r\n" . '			var condOnID_QuestionType = QtnListArray[condOnID].questionType;' . "\r\n" . '			switch(condOnID_QuestionType)' . "\r\n" . '			{' . "\r\n" . '				case 1: //YesNo' . "\r\n" . '				case 2: //Radio' . "\r\n" . '				case 3: //CheckBox' . "\r\n" . '				case 4: //Text' . "\r\n" . '				case 24: //CombRadio' . "\r\n" . '				case 25: //CombCheckBox' . "\r\n" . '				case 30: //Empty' . "\r\n" . '				case 17: //Auto' . "\r\n" . '					var Con_Total = count(theCondOnIDArray[0]); //qtnID=0' . "\r\n" . '					var i = 0;' . "\r\n" . '					if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '					for(var p in theCondOnIDArray[0] )' . "\r\n" . '					{' . "\r\n" . '						var theOptionArray = theCondOnIDArray[0][p];' . "\r\n" . '						i++;' . "\r\n" . '						if( condOnID_QuestionType == 4 )  //数值填空' . "\r\n" . '						{' . "\r\n" . '							switch(theOptionArray[1])' . "\r\n" . '							{' . "\r\n" . '								case 1:opertion = \'==\';break;' . "\r\n" . '								case 2:opertion = \'<\';break;' . "\r\n" . '								case 3:opertion = \'<=\';break;' . "\r\n" . '								case 4:opertion = \'>\';break;' . "\r\n" . '								case 5:opertion = \'>=\';break;' . "\r\n" . '								case 6:opertion = \'!=\';break;' . "\r\n" . '							}' . "\r\n" . '							if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '							else opertionRelation = \' && \';' . "\r\n" . '							conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '							else{' . "\r\n" . '								if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '								else opertionRelation = \' || \';' . "\r\n" . '							}' . "\r\n" . '							switch( condOnID_QuestionType )' . "\r\n" . '							{' . "\r\n" . '								case 1: //是非题' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 2:  //单选题						   ' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \\\'\'+theOptionArray[0]+\'\\\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 3:  //复选题						   ' . "\r\n" . '									if( theOptionArray[3] == 2 )  //计算模式' . "\r\n" . '									{' . "\r\n" . '										switch(theOptionArray[1])' . "\r\n" . '										{' . "\r\n" . '											case 1:opertion = \'==\';break;' . "\r\n" . '											case 2:opertion = \'<\';break;' . "\r\n" . '											case 3:opertion = \'<=\';break;' . "\r\n" . '											case 4:opertion = \'>\';break;' . "\r\n" . '											case 5:opertion = \'>=\';break;' . "\r\n" . '											case 6:opertion = \'!=\';break;' . "\r\n" . '										}' . "\r\n" . '										if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '										else opertionRelation = \' && \';' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'(getCheckBoxSelNum(document.Survey_Form.option_\'+condOnID+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += "( getID(\'option_"+condOnID+"\') != null && getID(\'option_"+condOnID+"\').value.split(\',\').length "+opertion+" "+theOptionArray[0]+")"+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '												{' . "\r\n" . '													conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '												}' . "\r\n" . '												else' . "\r\n" . '												{' . "\r\n" . '													conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												if( QtnListArray[condOnID].isSelect == 1 ) //下拉' . "\r\n" . '												{' . "\r\n" . '													conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '												}' . "\r\n" . '												else' . "\r\n" . '												{' . "\r\n" . '													conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 17:' . "\r\n" . '									if( QtnListArray[condOnID].isSelect == 1 )  //单选' . "\r\n" . '									{' . "\r\n" . '										if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 24:  //复合单选题						   ' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 25:  //复合复选题						   ' . "\r\n" . '									if( theOptionArray[3] == 2 )  //计算模式' . "\r\n" . '									{' . "\r\n" . '										switch(theOptionArray[1])' . "\r\n" . '										{' . "\r\n" . '											case 1:opertion = \'==\';break;' . "\r\n" . '											case 2:opertion = \'<\';break;' . "\r\n" . '											case 3:opertion = \'<=\';break;' . "\r\n" . '											case 4:opertion = \'>\';break;' . "\r\n" . '											case 5:opertion = \'>=\';break;' . "\r\n" . '											case 6:opertion = \'!=\';break;' . "\r\n" . '										}' . "\r\n" . '										if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '										else opertionRelation = \' && \';' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'(getCheckBoxSelNum(document.Survey_Form.option_\'+condOnID+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += "( getID(\'option_"+condOnID+"\') != null && getID(\'option_"+condOnID+"\').value.split(\',\').length "+opertion+" "+theOptionArray[0]+")"+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'\\\').value) )\'+opertionRelation;				' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 30: //空题' . "\r\n" . '									if( theOptionArray[1] == 1 )  //等于' . "\r\n" . '									{' . "\r\n" . '										if( theOptionArray[0] == 1 )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) == 1 )\'+opertionRelation;	' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) == 0 )\'+opertionRelation;	' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( theOptionArray[0] == 1 )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) != 1 )\'+opertionRelation;	' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'\\\') != null && parseInt(getID(\\\'option_\'+condOnID+\'\\\').value) != 0 )\'+opertionRelation;	' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;	' . "\r\n" . '							} //end of switch' . "\r\n" . '						} //end of if' . "\r\n" . '					} //end of foreach' . "\r\n" . '					if( Con_Total >= 2 )	conList += \')\';' . "\r\n" . '				break;' . "\r\n" . '				case 6:  //Range' . "\r\n" . '				case 7:  //Multiple' . "\r\n" . '				case 19: //AutoRange' . "\r\n" . '				case 28: //AutoMultiple' . "\r\n" . '				case 23: //CombText' . "\r\n" . '				case 10: //Rank' . "\r\n" . '				case 15: //Rating' . "\r\n" . '				case 16: //Weight' . "\r\n" . '				case 20: //AutoRank' . "\r\n" . '				case 21: //AutoRating' . "\r\n" . '				case 22: //AutoWeight' . "\r\n" . '				case 31: //级联' . "\r\n" . '					var RangeTotal = count(theCondOnIDArray); ' . "\r\n" . '					var k = 0;' . "\r\n" . '					if( RangeTotal >= 2 )  conList += \'(\';' . "\r\n" . '					for( var qtnID in theCondOnIDArray )' . "\r\n" . '					{' . "\r\n" . '						var theRangeArray = theCondOnIDArray[qtnID];' . "\r\n" . '						var i = 0;' . "\r\n" . '						var Con_Total = count(theRangeArray);' . "\r\n" . '						if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '						for( var p in theRangeArray)' . "\r\n" . '						{' . "\r\n" . '							var theOptionArray = theRangeArray[p];' . "\r\n" . '							i++;' . "\r\n" . '							switch( condOnID_QuestionType )' . "\r\n" . '							{' . "\r\n" . '								case 23:' . "\r\n" . '								case 10:' . "\r\n" . '								case 16:' . "\r\n" . '								case 20:' . "\r\n" . '								case 22:' . "\r\n" . '									switch(theOptionArray[1])' . "\r\n" . '									{' . "\r\n" . '										case 1:opertion = \'==\';break;' . "\r\n" . '										case 2:opertion = \'<\';break;' . "\r\n" . '										case 3:opertion = \'<=\';break;' . "\r\n" . '										case 4:opertion = \'>\';break;' . "\r\n" . '										case 5:opertion = \'>=\';break;' . "\r\n" . '										case 6:opertion = \'!=\';break;' . "\r\n" . '									}' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else opertionRelation = \' && \';' . "\r\n" . '									conList += \'( getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '								break;' . "\r\n" . '								case 15:' . "\r\n" . '								case 21:' . "\r\n" . '									switch(theOptionArray[1])' . "\r\n" . '									{' . "\r\n" . '										case 1:opertion = \'==\';break;' . "\r\n" . '										case 2:opertion = \'<\';break;' . "\r\n" . '										case 3:opertion = \'<=\';break;' . "\r\n" . '										case 4:opertion = \'>\';break;' . "\r\n" . '										case 5:opertion = \'>=\';break;' . "\r\n" . '										case 6:opertion = \'!=\';break;' . "\r\n" . '									}' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else opertionRelation = \' && \';' . "\r\n" . '									switch( QtnListArray[condOnID].isSelect )' . "\r\n" . '									{' . "\r\n" . '										case 0:' . "\r\n" . '											if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\') != null && getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+qtnID+\') != \\\'\\\' && getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+qtnID+\') != 99 && parseInt(getRadioCheckBoxValue(document.Survey_Form.option_\'+condOnID+\'_\'+qtnID+\') * \'+QtnListArray[condOnID].weight+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												conList += \'( getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value != 99 && parseInt(getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value * \'+QtnListArray[condOnID].weight+\') \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 1:' . "\r\n" . '										case 2:' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\') != null && !isNaN(getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value) && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value != \\\'\\\' && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value \'+opertion+\' \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 6:' . "\r\n" . '								case 19:' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else{' . "\r\n" . '										if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '										else opertionRelation = \' || \';' . "\r\n" . '									}' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+qtnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 7:' . "\r\n" . '								case 28:' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else{' . "\r\n" . '										if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '										else opertionRelation = \' || \';' . "\r\n" . '									}' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+qtnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\') != null && isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value) )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInCheckBox(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && !isInValueList(\'+theOptionArray[0]+\',getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value) )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 31:' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else{' . "\r\n" . '										if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' && \';' . "\r\n" . '										else opertionRelation = \' || \';' . "\r\n" . '									}' . "\r\n" . '									if( theOptionArray[1] == 1 )  //选择' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( IsInSelectedList(document.Survey_Form.option_\'+condOnID+\'_\'+qtnID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+qtnID+\'\\\').value == \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										if( IsSamePage(thisQuestionID,condOnID) )' . "\r\n" . '										{' . "\r\n" . '											conList += \'( !IsInSelectedList(document.Survey_Form.option_\'+condOnID+\'_\'+theRangeID+\',\'+theOptionArray[0]+\') )\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											conList += \'( getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\') != null && getID(\\\'option_\'+condOnID+\'_\'+theRangeID+\'\\\').value != \'+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '							} //end of switch' . "\r\n" . '						}//end of foreach' . "\r\n" . '						if( Con_Total >= 2 )  conList += \')\';					' . "\r\n" . '						k++;' . "\r\n" . '						if( k != RangeTotal )' . "\r\n" . '						{' . "\r\n" . '							conList += \' && \';' . "\r\n" . '						}' . "\r\n" . '					}//end of foreach' . "\r\n" . '					if( RangeTotal >= 2 )  conList += \')\';' . "\r\n" . '				break;' . "\r\n" . '			} //end of switch' . "\r\n" . '			' . "\r\n" . '			j ++;' . "\r\n" . '			if( j != count(QuotaListArray[theQuotaID]))' . "\r\n" . '			{' . "\r\n" . '				conList += \' && \'; ' . "\r\n" . '			}' . "\r\n" . '		} //end of foreach' . "\r\n" . '		if( conList != \'\' )' . "\r\n" . '		{' . "\r\n" . '			endConList += "\\t\\tif("+conList+")\\n\\t\\t{\\n";' . "\r\n" . '			endConList += "\\t\\t\\tthisCheckStr += \'0*"+theQuotaID+"$"+thisQuestionID+"$"+theMgtFunc+"$"+theResponseID+"|\';\\n";' . "\r\n" . '			endConList +=  "\\t\\t}\\n";' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			endConList += \'\';' . "\r\n" . '		}' . "\r\n" . '	} //End for while' . "\r\n" . '	return endConList;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function check_survey_quota()' . "\r\n" . '{' . "\r\n" . '	var csql = " SELECT isCheckStat0,isRelZero FROM eq_survey_list WHERE surveyID ="+qid+" LIMIT 1 ";' . "\r\n" . '	var cCheckRow = eval(\'(\'+getDbRows(csql,\'rexsee:enableq.db\')+\')\');' . "\r\n" . '	var checkSQLString = \'\';' . "\r\n" . '	if( parseInt(cCheckRow.rows[0][0]) == 1 )' . "\r\n" . '	{' . "\r\n" . '		checkSQLString = " overFlag != 2 ";' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		checkSQLString = " overFlag IN (1,3) ";' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	var thisCheck = thisCheckStr.substr(0,thisCheckStr.length-1).split(\'|\');' . "\r\n" . '	var isCheckPass = \'\';' . "\r\n" . '	var fBreak = false;' . "\r\n" . '	for(var s=0;s<thisCheck.length;s++)' . "\r\n" . '	{' . "\r\n" . '	   if( fBreak == true ) break;' . "\r\n" . '	   var qtnType = thisCheck[s].split(\'*\');' . "\r\n" . '	   switch(qtnType[0].toString())' . "\r\n" . '	   {' . "\r\n" . '			case \'4\':  //例子: 4*option_1' . "\r\n" . '				var thisCheckQtnID = qtnType[1].split(\'_\');' . "\r\n" . '				var theQuestionID = thisCheckQtnID[1];' . "\r\n" . '				var objValue = trim(eval(\'document.Survey_Form.\'+qtnType[1]+\'.value\'));' . "\r\n" . '				if( QtnListArray[theQuestionID].isNeg == 1 ) //唯一性检查' . "\r\n" . '				{' . "\r\n" . '					if( theResponseID != 0 )' . "\r\n" . '					{' . "\r\n" . '						var sql = "SELECT count(*) as theRemainNum FROM eq_response_"+qid+" WHERE "+qtnType[1]+" != \'\' and "+qtnType[1]+" = \'"+qLiteCharFilter(objValue)+"\' and "+checkSQLString+" and responseID != "+theResponseID;' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var sql = "SELECT count(*) as theRemainNum FROM eq_response_"+qid+" WHERE "+qtnType[1]+" != \'\' and "+qtnType[1]+" = \'"+qLiteCharFilter(objValue)+"\' and "+checkSQLString;' . "\r\n" . '					}' . "\r\n" . '					dataCheckRow = eval(\'(\'+getDbRows(sql,\'rexsee:enableq.db\')+\')\');' . "\r\n" . '					var theRemainNum = 0;' . "\r\n" . '					if( count(dataCheckRow.rows) != 0 )' . "\r\n" . '					{' . "\r\n" . '						theRemainNum = dataCheckRow.rows[0][0];' . "\r\n" . '					}' . "\r\n" . '					if( parseInt(theRemainNum) > 0 )' . "\r\n" . '					{' . "\r\n" . '						var thisMess = "showMessage(\'"+qNoScriptString(QtnListArray[theQuestionID].questionName)+",存在重复的输入值\');\\n";' . "\r\n" . '						thisMess += "document.Survey_Form."+qtnType[1]+".focus();\\n";' . "\r\n" . '						isCheckPass = \'0|false\';' . "\r\n" . '						fBreak = true;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				if( QtnListArray[theQuestionID].isSelect == 1 ) //合法性检查' . "\r\n" . '				{' . "\r\n" . '					if( objValue != \'\' )' . "\r\n" . '					{' . "\r\n" . '						if( in_array(objValue,textCheckArray[theQuestionID].split(\'######\') )){}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							var thisMess = "showMessage(\'"+qNoScriptString(QtnListArray[theQuestionID].questionName)+",输入的值不在问卷设计员允许的列表范围内\');\\n";' . "\r\n" . '							thisMess += "document.Survey_Form."+qtnType[1]+".focus();\\n";' . "\r\n" . '							isCheckPass = \'0|false\';' . "\r\n" . '							fBreak = true;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			break;' . "\r\n" . '			case \'23\': //组合填空题:23*option_2_23' . "\r\n" . '				var thisCheckQtnID = qtnType[1].split(\'_\');' . "\r\n" . '				var theQuestionID = thisCheckQtnID[1];' . "\r\n" . '				var theOptionID = thisCheckQtnID[2];' . "\r\n" . '				var objValue = eval(\'document.Survey_Form.\'+qtnType[1]+\'.value\');' . "\r\n" . '				if( theResponseID != 0 )' . "\r\n" . '				{' . "\r\n" . '					var sql = "SELECT count(*) as theRemainNum FROM eq_response_"+qid+" WHERE "+qtnType[1]+" != \'\' and "+qtnType[1]+" = \'"+qLiteCharFilter(objValue)+"\' and "+checkSQLString+" and responseID != "+theResponseID;' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					var sql = "SELECT count(*) as theRemainNum FROM eq_response_"+qid+" WHERE "+qtnType[1]+" != \'\' and "+qtnType[1]+" = \'"+qLiteCharFilter(objValue)+"\' and "+checkSQLString;' . "\r\n" . '				}' . "\r\n" . '				dataCheckRow = eval(\'(\'+getDbRows(sql,\'rexsee:enableq.db\')+\')\');' . "\r\n" . '				var theRemainNum = 0;' . "\r\n" . '				if( count(dataCheckRow.rows) != 0 )' . "\r\n" . '				{' . "\r\n" . '					theRemainNum = dataCheckRow.rows[0][0];' . "\r\n" . '				}' . "\r\n" . '				if( parseInt(theRemainNum) > 0 )' . "\r\n" . '				{' . "\r\n" . '					var thisMess = "showMessage(\'"+qNoScriptString(QtnListArray[theQuestionID].questionName)+" - "+qNoScriptString(YesNoListArray[theQuestionID][theOptionID].optionName)+",存在重复的输入值\');\\n";' . "\r\n" . '					thisMess += "document.Survey_Form."+qtnType[1]+".focus();\\n";' . "\r\n" . '					isCheckPass = \'0|false\';' . "\r\n" . '					fBreak = true;' . "\r\n" . '				}' . "\r\n" . '			break;' . "\r\n" . '			case \'0\': //配额检查:0*$theQuotaID#thisQuestionID#$theMgtFunc#$theResponseID' . "\r\n" . '				var theVarArray = qtnType[1].split(\'$\');' . "\r\n" . '				var theQuotaID = theVarArray[0];' . "\r\n" . '				var conList = survey_quota_exp(theQuotaID);' . "\r\n" . '				if( conList == \'\' )' . "\r\n" . '				{' . "\r\n" . '					continue;' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					if( theResponseID != 0 )' . "\r\n" . '					{' . "\r\n" . '						var sql = "SELECT count(*) as theQuotaNum FROM eq_response_"+qid+" WHERE "+checkSQLString+" and responseID != "+theResponseID +" and "+conList;' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var sql = "SELECT count(*) as theQuotaNum FROM eq_response_"+qid+" WHERE "+checkSQLString+" and "+conList;' . "\r\n" . '					}' . "\r\n" . '					dataCheckRow = eval(\'(\'+getDbRows(sql,\'rexsee:enableq.db\')+\')\');' . "\r\n" . '					var theQuotaNum = 0;' . "\r\n" . '					if( count(dataCheckRow.rows) != 0 )' . "\r\n" . '					{' . "\r\n" . '						theQuotaNum = dataCheckRow.rows[0][0];' . "\r\n" . '					}' . "\r\n" . '					if( parseInt(theQuotaNum) >= parseInt(QuotaNumArray[theQuotaID].quotaNum) )' . "\r\n" . '					{' . "\r\n" . '						var thisMess = "$(\'#surveyQuotaFlag\').val(2);\\n";' . "\r\n" . '						thisMess += "quota_info_id="+theQuotaID+";\\n";' . "\r\n" . '						thisMess += "document.Survey_Form.Action.value=\'SurveyOverSubmit\';\\n";' . "\r\n" . '						isCheckPass = \'1|true\';' . "\r\n" . '						fBreak = true;' . "\r\n" . '					}	' . "\r\n" . '				}' . "\r\n" . '			break;' . "\r\n" . '			case \'s1\': //关联关系检查:s1*运算符*值模式*变量组合*运算符组合*焦点对象*提示信息' . "\r\n" . '				var theFieldsList = qtnType[3].split(\'$\');' . "\r\n" . '				var theOpertionsList = qtnType[4].split(\'$\');' . "\r\n" . '				var theExpression = \'\';' . "\r\n" . '				var objValue;' . "\r\n" . '				var theCheckSkip = false;' . "\r\n" . '				if( qtnType[2] == \'m2\' )  //回复值' . "\r\n" . '				{' . "\r\n" . '					for(var m=1;m<count(theFieldsList);m++)' . "\r\n" . '					{' . "\r\n" . '						var objFieldList = theFieldsList[m].split(\'-\');' . "\r\n" . '						switch(parseInt(objFieldList[0])){' . "\r\n" . '							case 1: //Radio' . "\r\n" . '								if( typeof $(\'input[id=\'+objFieldList[1]+\']:checked\').val() == \'undefined\' )' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									var thisValue = $(\'input[id=\'+objFieldList[1]+\']:checked\').val();' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 2: //Radio' . "\r\n" . '											var skipFlag = false;' . "\r\n" . '											if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '											{' . "\r\n" . '												if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '												{' . "\r\n" . '													if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '													{ ' . "\r\n" . '														skipFlag = true;' . "\r\n" . '													}' . "\r\n" . '												}' . "\r\n" . '												else' . "\r\n" . '												{' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										default:' . "\r\n" . '											var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '									if( skipFlag == true ) //跳过' . "\r\n" . '									{' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 1:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 2:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 6:' . "\r\n" . '											case 19:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 15:' . "\r\n" . '											case 21:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 24:' . "\r\n" . '												objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 2: //CheckBox' . "\r\n" . '								var thisValue = \'\';' . "\r\n" . '								var arr = $(\'input[id=\'+objFieldList[1]+\']:checked\');' . "\r\n" . '								arr = arr.sort(function(a,b){' . "\r\n" . '									return parseInt($(a).val()) - parseInt($(b).val());' . "\r\n" . '								});' . "\r\n" . '								arr.each(function(){' . "\r\n" . '									thisValue += $(this).val() + ",";' . "\r\n" . '								});' . "\r\n" . '								if( thisValue != \'\' ){' . "\r\n" . '									thisValue = thisValue.substr(0,thisValue.length-1)' . "\r\n" . '									var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '									if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else{' . "\r\n" . '										var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '										var theQtnId = theQtnIDArray[1];' . "\r\n" . '										var theOptionId = objFieldList[2];' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 3:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 7:' . "\r\n" . '											case 28:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 25:' . "\r\n" . '												objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}										' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 3: //Select' . "\r\n" . '								var thisValue = $("#"+objFieldList[1]).val();' . "\r\n" . '								if(objFieldList.length == 3 ){ //多选' . "\r\n" . '									if( thisValue != \'\' ){' . "\r\n" . '										var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '										if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '											if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '											{' . "\r\n" . '												objValue = 0;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												objValue = \'\';' . "\r\n" . '												theCheckSkip = true;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else{ //选中' . "\r\n" . '											var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '											var theQtnId = theQtnIDArray[1];' . "\r\n" . '											var theOptionId = objFieldList[2];' . "\r\n" . '											switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '											{' . "\r\n" . '												case 3:' . "\r\n" . '													switch(parseInt(theOptionId))' . "\r\n" . '													{' . "\r\n" . '														case 0:' . "\r\n" . '															objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '														break;' . "\r\n" . '														case 99999:' . "\r\n" . '															objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '														break;' . "\r\n" . '														default:' . "\r\n" . '															objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '														break;' . "\r\n" . '													}' . "\r\n" . '												break;' . "\r\n" . '												case 7:' . "\r\n" . '												case 28:' . "\r\n" . '													objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 17:' . "\r\n" . '													switch(parseInt(theOptionId))' . "\r\n" . '													{' . "\r\n" . '														case 0:' . "\r\n" . '															var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '															objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '														break;' . "\r\n" . '														case 99999:' . "\r\n" . '															objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '														break;' . "\r\n" . '														default:' . "\r\n" . '															var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '															objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '														break;' . "\r\n" . '													}' . "\r\n" . '												break;' . "\r\n" . '												case 18:' . "\r\n" . '													objValue = YesNoListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 25:' . "\r\n" . '													objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}//end for switch								' . "\r\n" . '										}//选中' . "\r\n" . '									}' . "\r\n" . '									else{ //未选中' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{ //单选' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 2: //Radio' . "\r\n" . '											var skipFlag = false;' . "\r\n" . '											if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '											{' . "\r\n" . '												if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '												{' . "\r\n" . '													if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '													{ ' . "\r\n" . '														skipFlag = true;' . "\r\n" . '													}' . "\r\n" . '												}' . "\r\n" . '												else' . "\r\n" . '												{' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 4:' . "\r\n" . '										case 16:' . "\r\n" . '										case 22:' . "\r\n" . '										case 23:' . "\r\n" . '										case 27:' . "\r\n" . '											var skipFlag = ( thisValue == \'\' ) ? true : false;' . "\r\n" . '										break;' . "\r\n" . '										default:' . "\r\n" . '											var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '									if( skipFlag == true ) //跳过' . "\r\n" . '									{' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 1:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 2:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 4:' . "\r\n" . '											case 16:' . "\r\n" . '											case 22:' . "\r\n" . '											case 23:' . "\r\n" . '											case 27:' . "\r\n" . '												objValue = thisValue;' . "\r\n" . '											break;' . "\r\n" . '											case 6:' . "\r\n" . '											case 19:' . "\r\n" . '											case 26:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 15:' . "\r\n" . '											case 21:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 18:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 24:' . "\r\n" . '												objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}//end for switch' . "\r\n" . '									}//有值' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '						} //end of switch' . "\r\n" . '' . "\r\n" . '						//Skip For' . "\r\n" . '						if( theCheckSkip == true ) break;' . "\r\n" . '' . "\r\n" . '						if( m == 1 )' . "\r\n" . '						{' . "\r\n" . '							theExpression += objValue;' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							var t = m-2;' . "\r\n" . '							switch( parseInt(theOpertionsList[t]) )' . "\r\n" . '							{' . "\r\n" . '								case 1:' . "\r\n" . '									theExpression += \'+\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '								case 2:' . "\r\n" . '									theExpression += \'-\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '								case 3:' . "\r\n" . '									theExpression += \'*\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '								case 4:' . "\r\n" . '									theExpression += \'/\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					theExpression = \'round((\'+theExpression+\'),3)\';' . "\r\n" . '					switch( parseInt(qtnType[1]) )' . "\r\n" . '					{' . "\r\n" . '						case 1:' . "\r\n" . '							theExpression += \'==\';' . "\r\n" . '						break;' . "\r\n" . '						case 2:' . "\r\n" . '							theExpression += \'<\';' . "\r\n" . '						break;' . "\r\n" . '						case 3:' . "\r\n" . '							theExpression += \'<=\';' . "\r\n" . '						break;' . "\r\n" . '						case 4:' . "\r\n" . '							theExpression += \'>\';' . "\r\n" . '						break;' . "\r\n" . '						case 5:' . "\r\n" . '							theExpression += \'>=\';' . "\r\n" . '						break;' . "\r\n" . '						case 6:' . "\r\n" . '							theExpression += \'!=\';' . "\r\n" . '						break;' . "\r\n" . '					}' . "\r\n" . '' . "\r\n" . '					//回复值' . "\r\n" . '					var objFieldList = theFieldsList[0].split(\'-\');' . "\r\n" . '					switch(parseInt(objFieldList[0])){' . "\r\n" . '						case 1: //Radio' . "\r\n" . '							if( typeof $(\'input[id=\'+objFieldList[1]+\']:checked\').val() == \'undefined\' )' . "\r\n" . '							{' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								var thisValue = $(\'input[id=\'+objFieldList[1]+\']:checked\').val();' . "\r\n" . '								var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '								var theQtnId = theQtnIDArray[1];' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 2: //Radio' . "\r\n" . '										var skipFlag = false;' . "\r\n" . '										if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '											{' . "\r\n" . '												if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '												{ ' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									default:' . "\r\n" . '										var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '								if( skipFlag == true ) //跳过' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 1:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 2:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 6:' . "\r\n" . '										case 19:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 15:' . "\r\n" . '										case 21:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 24:' . "\r\n" . '											objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '						case 2: //CheckBox' . "\r\n" . '							var thisValue = \'\';' . "\r\n" . '							var arr = $(\'input[id=\'+objFieldList[1]+\']:checked\');' . "\r\n" . '							arr = arr.sort(function(a,b){' . "\r\n" . '								return parseInt($(a).val()) - parseInt($(b).val());' . "\r\n" . '							});' . "\r\n" . '							arr.each(function(){' . "\r\n" . '								thisValue += $(this).val() + ",";' . "\r\n" . '							});' . "\r\n" . '							if( thisValue != \'\' ){' . "\r\n" . '								thisValue = thisValue.substr(0,thisValue.length-1)' . "\r\n" . '								var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '								if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									var theOptionId = objFieldList[2];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 3:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 7:' . "\r\n" . '										case 28:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 25:' . "\r\n" . '											objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}										' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else{ //未选中' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '						case 3: //Select' . "\r\n" . '							var thisValue = $("#"+objFieldList[1]).val();' . "\r\n" . '							if(objFieldList.length == 3 ){ //多选' . "\r\n" . '								if( thisValue != \'\' ){' . "\r\n" . '									var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '									if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else{ //选中' . "\r\n" . '										var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '										var theQtnId = theQtnIDArray[1];' . "\r\n" . '										var theOptionId = objFieldList[2];' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 3:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 7:' . "\r\n" . '											case 28:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 18:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 25:' . "\r\n" . '												objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}//end for switch								' . "\r\n" . '									}//选中' . "\r\n" . '								}' . "\r\n" . '								else{ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else{ //单选' . "\r\n" . '								var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '								var theQtnId = theQtnIDArray[1];' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 2: //Radio' . "\r\n" . '										var skipFlag = false;' . "\r\n" . '										if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '											{' . "\r\n" . '												if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '												{ ' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 4:' . "\r\n" . '									case 16:' . "\r\n" . '									case 22:' . "\r\n" . '									case 23:' . "\r\n" . '									case 27:' . "\r\n" . '										var skipFlag = ( thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '									default:' . "\r\n" . '										var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '								if( skipFlag == true ) //跳过' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 1:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 2:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 4:' . "\r\n" . '										case 16:' . "\r\n" . '										case 22:' . "\r\n" . '										case 23:' . "\r\n" . '										case 27:' . "\r\n" . '											objValue = thisValue;' . "\r\n" . '										break;' . "\r\n" . '										case 6:' . "\r\n" . '										case 19:' . "\r\n" . '										case 26:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 15:' . "\r\n" . '										case 21:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 18:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 24:' . "\r\n" . '											objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}//end for switch' . "\r\n" . '								}//有值' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '					} //end of switch' . "\r\n" . '' . "\r\n" . '					theExpression += \'round((\'+objValue+\'),3)\';' . "\r\n" . '				}' . "\r\n" . '				else //固定值' . "\r\n" . '				{' . "\r\n" . '					for(var m=0;m<count(theFieldsList);m++)' . "\r\n" . '					{' . "\r\n" . '						var objFieldList = theFieldsList[m].split(\'-\');' . "\r\n" . '						switch(parseInt(objFieldList[0])){' . "\r\n" . '							case 1: //Radio' . "\r\n" . '								if( typeof $(\'input[id=\'+objFieldList[1]+\']:checked\').val() == \'undefined\' )' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									var thisValue = $(\'input[id=\'+objFieldList[1]+\']:checked\').val();' . "\r\n" . '									var thisValue = $(\'input[id=\'+objFieldList[1]+\']:checked\').val();' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 2: //Radio' . "\r\n" . '											var skipFlag = false;' . "\r\n" . '											if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '											{' . "\r\n" . '												if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '												{' . "\r\n" . '													if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '													{ ' . "\r\n" . '														skipFlag = true;' . "\r\n" . '													}' . "\r\n" . '												}' . "\r\n" . '												else' . "\r\n" . '												{' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										default:' . "\r\n" . '											var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '									if( skipFlag == true ) //跳过' . "\r\n" . '									{' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 1:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 2:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 6:' . "\r\n" . '											case 19:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 15:' . "\r\n" . '											case 21:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 24:' . "\r\n" . '												objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 2: //CheckBox' . "\r\n" . '								var thisValue = \'\';' . "\r\n" . '								var arr = $(\'input[id=\'+objFieldList[1]+\']:checked\');' . "\r\n" . '								arr = arr.sort(function(a,b){' . "\r\n" . '									return parseInt($(a).val()) - parseInt($(b).val());' . "\r\n" . '								});' . "\r\n" . '								arr.each(function(){' . "\r\n" . '									thisValue += $(this).val() + ",";' . "\r\n" . '								});' . "\r\n" . '								if( thisValue != \'\' ){' . "\r\n" . '									thisValue = thisValue.substr(0,thisValue.length-1)' . "\r\n" . '									var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '									if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else{' . "\r\n" . '										var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '										var theQtnId = theQtnIDArray[1];' . "\r\n" . '										var theOptionId = objFieldList[2];' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 3:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 7:' . "\r\n" . '											case 28:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 25:' . "\r\n" . '												objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}										' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 3: //Select' . "\r\n" . '								var thisValue = $("#"+objFieldList[1]).val();' . "\r\n" . '								if(objFieldList.length == 3 ){ //多选' . "\r\n" . '									if( thisValue != \'\' ){' . "\r\n" . '										var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '										if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '											if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '											{' . "\r\n" . '												objValue = 0;' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												objValue = \'\';' . "\r\n" . '												theCheckSkip = true;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else{ //选中' . "\r\n" . '											var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '											var theQtnId = theQtnIDArray[1];' . "\r\n" . '											var theOptionId = objFieldList[2];' . "\r\n" . '											switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '											{' . "\r\n" . '												case 3:' . "\r\n" . '													switch(parseInt(theOptionId))' . "\r\n" . '													{' . "\r\n" . '														case 0:' . "\r\n" . '															objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '														break;' . "\r\n" . '														case 99999:' . "\r\n" . '															objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '														break;' . "\r\n" . '														default:' . "\r\n" . '															objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '														break;' . "\r\n" . '													}' . "\r\n" . '												break;' . "\r\n" . '												case 7:' . "\r\n" . '												case 28:' . "\r\n" . '													objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 17:' . "\r\n" . '													switch(parseInt(theOptionId))' . "\r\n" . '													{' . "\r\n" . '														case 0:' . "\r\n" . '															var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '															objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '														break;' . "\r\n" . '														case 99999:' . "\r\n" . '															objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '														break;' . "\r\n" . '														default:' . "\r\n" . '															var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '															objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '														break;' . "\r\n" . '													}' . "\r\n" . '												break;' . "\r\n" . '												case 18:' . "\r\n" . '													objValue = YesNoListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 25:' . "\r\n" . '													objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}//end for switch								' . "\r\n" . '										}//选中' . "\r\n" . '									}' . "\r\n" . '									else{ //未选中' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{ //单选' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 2: //Radio' . "\r\n" . '											var skipFlag = false;' . "\r\n" . '											if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '											{' . "\r\n" . '												if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '												{' . "\r\n" . '													if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '													{ ' . "\r\n" . '														skipFlag = true;' . "\r\n" . '													}' . "\r\n" . '												}' . "\r\n" . '												else' . "\r\n" . '												{' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 4:' . "\r\n" . '										case 16:' . "\r\n" . '										case 22:' . "\r\n" . '										case 23:' . "\r\n" . '										case 27:' . "\r\n" . '											var skipFlag = ( thisValue == \'\' ) ? true : false;' . "\r\n" . '										break;' . "\r\n" . '										default:' . "\r\n" . '											var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '									if( skipFlag == true ) //跳过' . "\r\n" . '									{' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 1:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 2:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 4:' . "\r\n" . '											case 16:' . "\r\n" . '											case 22:' . "\r\n" . '											case 23:' . "\r\n" . '											case 27:' . "\r\n" . '												objValue = thisValue;' . "\r\n" . '											break;' . "\r\n" . '											case 6:' . "\r\n" . '											case 19:' . "\r\n" . '											case 26:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 15:' . "\r\n" . '											case 21:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(thisValue))' . "\r\n" . '												{' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 18:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 24:' . "\r\n" . '												objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}//end for switch' . "\r\n" . '									}//有值' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '						} //end of switch' . "\r\n" . '' . "\r\n" . '						//Skip For' . "\r\n" . '						if( theCheckSkip == true ) break;' . "\r\n" . '' . "\r\n" . '						if( m == 0 )' . "\r\n" . '						{' . "\r\n" . '							theExpression += objValue;' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							var t = m-1;' . "\r\n" . '							switch(parseInt(theOpertionsList[t]))' . "\r\n" . '							{' . "\r\n" . '								case 1:' . "\r\n" . '									theExpression += \'+\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '								case 2:' . "\r\n" . '									theExpression += \'-\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '								case 3:' . "\r\n" . '									theExpression += \'*\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '								case 4:' . "\r\n" . '									theExpression += \'/\'+objValue;' . "\r\n" . '								break;' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					theExpression = \'round((\'+theExpression+\'),3)\';' . "\r\n" . '					switch(parseInt(qtnType[1]))' . "\r\n" . '					{' . "\r\n" . '						case 1:' . "\r\n" . '							theExpression += \'==\';' . "\r\n" . '						break;' . "\r\n" . '						case 2:' . "\r\n" . '							theExpression += \'<\';' . "\r\n" . '						break;' . "\r\n" . '						case 3:' . "\r\n" . '							theExpression += \'<=\';' . "\r\n" . '						break;' . "\r\n" . '						case 4:' . "\r\n" . '							theExpression += \'>\';' . "\r\n" . '						break;' . "\r\n" . '						case 5:' . "\r\n" . '							theExpression += \'>=\';' . "\r\n" . '						break;' . "\r\n" . '						case 6:' . "\r\n" . '							theExpression += \'!=\';' . "\r\n" . '						break;' . "\r\n" . '					}' . "\r\n" . '					theExpression += \'round(\'+qtnType[2]+\',3)\';' . "\r\n" . '				} //end of if' . "\r\n" . '				if( theCheckSkip == false )' . "\r\n" . '				{' . "\r\n" . '					if( eval(theExpression) == false )' . "\r\n" . '					{' . "\r\n" . '						var thisMess = "var theObj = document.getElementById(\'question_"+qtnType[5]+"\');\\n";' . "\r\n" . '						thisMess += "if(theObj != null ) {\\n";' . "\r\n" . '						thisMess += "\\ttheObj.scrollIntoView(true);\\n";' . "\r\n" . '						thisMess += "\\ttheObj.focus();\\n";' . "\r\n" . '						thisMess += "}\\n";' . "\r\n" . '						thisMess += "showMessage(\'"+qNoScriptString(base64_decode(qtnType[6]))+",表达式不成立\');\\n";' . "\r\n" . '						isCheckPass = \'0|false\';' . "\r\n" . '						fBreak = true;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			break;' . "\r\n" . ' 		}//end of switch' . "\r\n" . '	}//end of for' . "\r\n" . '	if( isCheckPass != \'\'   )' . "\r\n" . '	{' . "\r\n" . '		eval(thisMess);' . "\r\n" . '		return isCheckPass;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		return true;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function check_survey_empty()' . "\r\n" . '{' . "\r\n" . '	jQuery.Survey_Empty_List();' . "\r\n" . '	if( emptyCheckStr != \'\')' . "\r\n" . '	{' . "\r\n" . '		var csql = " SELECT isCheckStat0,isRelZero FROM eq_survey_list WHERE surveyID ="+qid+" LIMIT 1 ";' . "\r\n" . '		var cCheckRow = eval(\'(\'+getDbRows(csql,\'rexsee:enableq.db\')+\')\');' . "\r\n" . '		var emptyCheck = emptyCheckStr.substr(0,emptyCheckStr.length-1).split(\'|\');' . "\r\n" . '		for(var o=0;o<emptyCheck.length;o++){' . "\r\n" . '			var qtnType = emptyCheck[o].split(\'*\');' . "\r\n" . '			var theFieldsList = qtnType[3].split(\'$\');' . "\r\n" . '			var theOpertionsList = qtnType[4].split(\'$\');' . "\r\n" . '			var theExpression = \'\';' . "\r\n" . '			var objValue;' . "\r\n" . '			var theCheckSkip = false;' . "\r\n" . '			if( qtnType[2] == \'m2\' )  //回复值' . "\r\n" . '			{' . "\r\n" . '				for(var m=1;m<count(theFieldsList);m++)' . "\r\n" . '				{' . "\r\n" . '					var objFieldList = theFieldsList[m].split(\'-\');' . "\r\n" . '					switch(parseInt(objFieldList[0])){' . "\r\n" . '						case 1: //Radio' . "\r\n" . '							if( typeof $(\'input[id=\'+objFieldList[1]+\']:checked\').val() == \'undefined\' )' . "\r\n" . '							{' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								var thisValue = $(\'input[id=\'+objFieldList[1]+\']:checked\').val();' . "\r\n" . '								var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '								var theQtnId = theQtnIDArray[1];' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 2: //Radio' . "\r\n" . '										var skipFlag = false;' . "\r\n" . '										if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '											{' . "\r\n" . '												if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '												{ ' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									default:' . "\r\n" . '										var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '								if( skipFlag == true ) //跳过' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 1:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 2:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 6:' . "\r\n" . '										case 19:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 15:' . "\r\n" . '										case 21:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 24:' . "\r\n" . '											objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '						case 2: //CheckBox' . "\r\n" . '							var thisValue = \'\';' . "\r\n" . '							var arr = $(\'input[id=\'+objFieldList[1]+\']:checked\');' . "\r\n" . '							arr = arr.sort(function(a,b){' . "\r\n" . '								return parseInt($(a).val()) - parseInt($(b).val());' . "\r\n" . '							});' . "\r\n" . '							arr.each(function(){' . "\r\n" . '								thisValue += $(this).val() + ",";' . "\r\n" . '							});' . "\r\n" . '							if( thisValue != \'\' ){' . "\r\n" . '								thisValue = thisValue.substr(0,thisValue.length-1)' . "\r\n" . '								var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '								if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									var theOptionId = objFieldList[2];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 3:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 7:' . "\r\n" . '										case 28:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 25:' . "\r\n" . '											objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}										' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else{ //未选中' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '						case 3: //Select' . "\r\n" . '							var thisValue = $("#"+objFieldList[1]).val();' . "\r\n" . '							if(objFieldList.length == 3 ){ //多选' . "\r\n" . '								if( thisValue != \'\' ){' . "\r\n" . '									var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '									if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else{ //选中' . "\r\n" . '										var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '										var theQtnId = theQtnIDArray[1];' . "\r\n" . '										var theOptionId = objFieldList[2];' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 3:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 7:' . "\r\n" . '											case 28:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 18:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 25:' . "\r\n" . '												objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}//end for switch								' . "\r\n" . '									}//选中' . "\r\n" . '								}' . "\r\n" . '								else{ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else{ //单选' . "\r\n" . '								var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '								var theQtnId = theQtnIDArray[1];' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 2: //Radio' . "\r\n" . '										var skipFlag = false;' . "\r\n" . '										if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '											{' . "\r\n" . '												if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '												{ ' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 4:' . "\r\n" . '									case 16:' . "\r\n" . '									case 22:' . "\r\n" . '									case 23:' . "\r\n" . '									case 27:' . "\r\n" . '										var skipFlag = ( thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '									default:' . "\r\n" . '										var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '								if( skipFlag == true ) //跳过' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 1:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 2:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 4:' . "\r\n" . '										case 16:' . "\r\n" . '										case 22:' . "\r\n" . '										case 23:' . "\r\n" . '										case 27:' . "\r\n" . '											objValue = thisValue;' . "\r\n" . '										break;' . "\r\n" . '										case 6:' . "\r\n" . '										case 19:' . "\r\n" . '										case 26:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 15:' . "\r\n" . '										case 21:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 18:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 24:' . "\r\n" . '											objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}//end for switch' . "\r\n" . '								}//有值' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '					} //end of switch' . "\r\n" . '' . "\r\n" . '					//Skip For' . "\r\n" . '					if( theCheckSkip == true ) break;' . "\r\n" . '					if( m == 1 )' . "\r\n" . '					{' . "\r\n" . '						theExpression += objValue;' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var t = m-2;' . "\r\n" . '						switch( parseInt(theOpertionsList[t]) )' . "\r\n" . '						{' . "\r\n" . '							case 1:' . "\r\n" . '								theExpression += \'+\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '							case 2:' . "\r\n" . '								theExpression += \'-\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '							case 3:' . "\r\n" . '								theExpression += \'*\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '							case 4:' . "\r\n" . '								theExpression += \'/\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				theExpression = \'round((\'+theExpression+\'),3)\';' . "\r\n" . '				switch( parseInt(qtnType[1]) )' . "\r\n" . '				{' . "\r\n" . '					case 1:' . "\r\n" . '						theExpression += \'==\';' . "\r\n" . '					break;' . "\r\n" . '					case 2:' . "\r\n" . '						theExpression += \'<\';' . "\r\n" . '					break;' . "\r\n" . '					case 3:' . "\r\n" . '						theExpression += \'<=\';' . "\r\n" . '					break;' . "\r\n" . '					case 4:' . "\r\n" . '						theExpression += \'>\';' . "\r\n" . '					break;' . "\r\n" . '					case 5:' . "\r\n" . '						theExpression += \'>=\';' . "\r\n" . '					break;' . "\r\n" . '					case 6:' . "\r\n" . '						theExpression += \'!=\';' . "\r\n" . '					break;' . "\r\n" . '				}' . "\r\n" . '				//回复值' . "\r\n" . '				var objFieldList = theFieldsList[0].split(\'-\');' . "\r\n" . '				switch(parseInt(objFieldList[0])){' . "\r\n" . '					case 1: //Radio' . "\r\n" . '						if( typeof $(\'input[id=\'+objFieldList[1]+\']:checked\').val() == \'undefined\' )' . "\r\n" . '						{' . "\r\n" . '							if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '							{' . "\r\n" . '								objValue = 0;' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								objValue = \'\';' . "\r\n" . '								theCheckSkip = true;' . "\r\n" . '								break;' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							var thisValue = $(\'input[id=\'+objFieldList[1]+\']:checked\').val();' . "\r\n" . '							var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '							var theQtnId = theQtnIDArray[1];' . "\r\n" . '							switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '							{' . "\r\n" . '								case 2: //Radio' . "\r\n" . '									var skipFlag = false;' . "\r\n" . '									if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '									{' . "\r\n" . '										if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '										{' . "\r\n" . '											if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '											{ ' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											skipFlag = true;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								default:' . "\r\n" . '									var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '								break;' . "\r\n" . '							}' . "\r\n" . '							if( skipFlag == true ) //跳过' . "\r\n" . '							{' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 1:' . "\r\n" . '										objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '									break;' . "\r\n" . '									case 2:' . "\r\n" . '										switch(parseInt(thisValue))' . "\r\n" . '										{' . "\r\n" . '											case 0:' . "\r\n" . '												objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 6:' . "\r\n" . '									case 19:' . "\r\n" . '										objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '									break;' . "\r\n" . '									case 15:' . "\r\n" . '									case 21:' . "\r\n" . '										switch(parseInt(thisValue))' . "\r\n" . '										{' . "\r\n" . '											case 99:' . "\r\n" . '												objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 17:' . "\r\n" . '										switch(parseInt(thisValue))' . "\r\n" . '										{' . "\r\n" . '											case 99999:' . "\r\n" . '												objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '											break;' . "\r\n" . '											case 0:' . "\r\n" . '												var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '												objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '												objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 24:' . "\r\n" . '										objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					break;' . "\r\n" . '					case 2: //CheckBox' . "\r\n" . '						var thisValue = \'\';' . "\r\n" . '						var arr = $(\'input[id=\'+objFieldList[1]+\']:checked\');' . "\r\n" . '						arr = arr.sort(function(a,b){' . "\r\n" . '							return parseInt($(a).val()) - parseInt($(b).val());' . "\r\n" . '						});' . "\r\n" . '						arr.each(function(){' . "\r\n" . '							thisValue += $(this).val() + ",";' . "\r\n" . '						});' . "\r\n" . '						if( thisValue != \'\' ){' . "\r\n" . '							thisValue = thisValue.substr(0,thisValue.length-1)' . "\r\n" . '							var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '							if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else{' . "\r\n" . '								var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '								var theQtnId = theQtnIDArray[1];' . "\r\n" . '								var theOptionId = objFieldList[2];' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 3:' . "\r\n" . '										switch(parseInt(theOptionId))' . "\r\n" . '										{' . "\r\n" . '											case 0:' . "\r\n" . '												objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 99999:' . "\r\n" . '												objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 7:' . "\r\n" . '									case 28:' . "\r\n" . '										objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '									break;' . "\r\n" . '									case 17:' . "\r\n" . '										switch(parseInt(theOptionId))' . "\r\n" . '										{' . "\r\n" . '											case 0:' . "\r\n" . '												var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '												objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 99999:' . "\r\n" . '												objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '												objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 25:' . "\r\n" . '										objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '									break;' . "\r\n" . '								}										' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '						else{ //未选中' . "\r\n" . '							if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '							{' . "\r\n" . '								objValue = 0;' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								objValue = \'\';' . "\r\n" . '								theCheckSkip = true;' . "\r\n" . '								break;' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					break;' . "\r\n" . '					case 3: //Select' . "\r\n" . '						var thisValue = $("#"+objFieldList[1]).val();' . "\r\n" . '						if(objFieldList.length == 3 ){ //多选' . "\r\n" . '							if( thisValue != \'\' ){' . "\r\n" . '								var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '								if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{ //选中' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									var theOptionId = objFieldList[2];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 3:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 7:' . "\r\n" . '										case 28:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 18:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 25:' . "\r\n" . '											objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}//end for switch								' . "\r\n" . '								}//选中' . "\r\n" . '							}' . "\r\n" . '							else{ //未选中' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '						else{ //单选' . "\r\n" . '							var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '							var theQtnId = theQtnIDArray[1];' . "\r\n" . '							switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '							{' . "\r\n" . '								case 2: //Radio' . "\r\n" . '									var skipFlag = false;' . "\r\n" . '									if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '									{' . "\r\n" . '										if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '										{' . "\r\n" . '											if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '											{ ' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											skipFlag = true;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '								break;' . "\r\n" . '								case 4:' . "\r\n" . '								case 16:' . "\r\n" . '								case 22:' . "\r\n" . '								case 23:' . "\r\n" . '								case 27:' . "\r\n" . '									var skipFlag = ( thisValue == \'\' ) ? true : false;' . "\r\n" . '								break;' . "\r\n" . '								default:' . "\r\n" . '									var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '								break;' . "\r\n" . '							}' . "\r\n" . '							if( skipFlag == true ) //跳过' . "\r\n" . '							{' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 1:' . "\r\n" . '										objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '									break;' . "\r\n" . '									case 2:' . "\r\n" . '										switch(parseInt(thisValue))' . "\r\n" . '										{' . "\r\n" . '											case 0:' . "\r\n" . '												objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 4:' . "\r\n" . '									case 16:' . "\r\n" . '									case 22:' . "\r\n" . '									case 23:' . "\r\n" . '									case 27:' . "\r\n" . '										objValue = thisValue;' . "\r\n" . '									break;' . "\r\n" . '									case 6:' . "\r\n" . '									case 19:' . "\r\n" . '									case 26:' . "\r\n" . '										objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '									break;' . "\r\n" . '									case 15:' . "\r\n" . '									case 21:' . "\r\n" . '										switch(parseInt(thisValue))' . "\r\n" . '										{' . "\r\n" . '											case 99:' . "\r\n" . '												objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 17:' . "\r\n" . '										switch(parseInt(thisValue))' . "\r\n" . '										{' . "\r\n" . '											case 99999:' . "\r\n" . '												objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '											break;' . "\r\n" . '											case 0:' . "\r\n" . '												var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '												objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											default:' . "\r\n" . '												var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '												objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 18:' . "\r\n" . '										objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '									break;' . "\r\n" . '									case 24:' . "\r\n" . '										objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '									break;' . "\r\n" . '								}//end for switch' . "\r\n" . '							}//有值' . "\r\n" . '						}' . "\r\n" . '					break;' . "\r\n" . '				} //end of switch' . "\r\n" . '' . "\r\n" . '				theExpression += \'round((\'+objValue+\'),3)\';' . "\r\n" . '			}' . "\r\n" . '			else //固定值' . "\r\n" . '			{' . "\r\n" . '				for(var m=0;m<count(theFieldsList);m++)' . "\r\n" . '				{' . "\r\n" . '					var objFieldList = theFieldsList[m].split(\'-\');' . "\r\n" . '					switch(parseInt(objFieldList[0])){' . "\r\n" . '						case 1: //Radio' . "\r\n" . '							if( typeof $(\'input[id=\'+objFieldList[1]+\']:checked\').val() == \'undefined\' )' . "\r\n" . '							{' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								var thisValue = $(\'input[id=\'+objFieldList[1]+\']:checked\').val();' . "\r\n" . '								var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '								var theQtnId = theQtnIDArray[1];' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 2: //Radio' . "\r\n" . '										var skipFlag = false;' . "\r\n" . '										if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '											{' . "\r\n" . '												if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '												{ ' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									default:' . "\r\n" . '										var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '								if( skipFlag == true ) //跳过' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 1:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 2:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 6:' . "\r\n" . '										case 19:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 15:' . "\r\n" . '										case 21:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 24:' . "\r\n" . '											objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '						case 2: //CheckBox' . "\r\n" . '							var thisValue = \'\';' . "\r\n" . '							var arr = $(\'input[id=\'+objFieldList[1]+\']:checked\');' . "\r\n" . '							arr = arr.sort(function(a,b){' . "\r\n" . '								return parseInt($(a).val()) - parseInt($(b).val());' . "\r\n" . '							});' . "\r\n" . '							arr.each(function(){' . "\r\n" . '								thisValue += $(this).val() + ",";' . "\r\n" . '							});' . "\r\n" . '							if( thisValue != \'\' ){' . "\r\n" . '								thisValue = thisValue.substr(0,thisValue.length-1)' . "\r\n" . '								var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '								if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else{' . "\r\n" . '									var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '									var theQtnId = theQtnIDArray[1];' . "\r\n" . '									var theOptionId = objFieldList[2];' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 3:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 7:' . "\r\n" . '										case 28:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(theOptionId))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 25:' . "\r\n" . '											objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}										' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else{ //未选中' . "\r\n" . '								if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '								{' . "\r\n" . '									objValue = 0;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									objValue = \'\';' . "\r\n" . '									theCheckSkip = true;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '						case 3: //Select' . "\r\n" . '							var thisValue = $("#"+objFieldList[1]).val();' . "\r\n" . '							if(objFieldList.length == 3 ){ //多选' . "\r\n" . '								if( thisValue != \'\' ){' . "\r\n" . '									var theAllValueStr = \',\'+thisValue+\',\';' . "\r\n" . '									if( theAllValueStr.indexOf(\',\'+objFieldList[2]+\',\') == -1 ){ //未选中' . "\r\n" . '										if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '										{' . "\r\n" . '											objValue = 0;' . "\r\n" . '										}' . "\r\n" . '										else' . "\r\n" . '										{' . "\r\n" . '											objValue = \'\';' . "\r\n" . '											theCheckSkip = true;' . "\r\n" . '											break;' . "\r\n" . '										}' . "\r\n" . '									}' . "\r\n" . '									else{ //选中' . "\r\n" . '										var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '										var theQtnId = theQtnIDArray[1];' . "\r\n" . '										var theOptionId = objFieldList[2];' . "\r\n" . '										switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '										{' . "\r\n" . '											case 3:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 7:' . "\r\n" . '											case 28:' . "\r\n" . '												objValue = AnswerListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 17:' . "\r\n" . '												switch(parseInt(theOptionId))' . "\r\n" . '												{' . "\r\n" . '													case 0:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '													break;' . "\r\n" . '													case 99999:' . "\r\n" . '														objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '													break;' . "\r\n" . '													default:' . "\r\n" . '														var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '														objValue = CheckBoxListArray[theBaseID][theOptionId].optionValue;' . "\r\n" . '													break;' . "\r\n" . '												}' . "\r\n" . '											break;' . "\r\n" . '											case 18:' . "\r\n" . '												objValue = YesNoListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '											case 25:' . "\r\n" . '												objValue = CheckBoxListArray[theQtnId][theOptionId].optionValue;' . "\r\n" . '											break;' . "\r\n" . '										}//end for switch								' . "\r\n" . '									}//选中' . "\r\n" . '								}' . "\r\n" . '								else{ //未选中' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else{ //单选' . "\r\n" . '								var theQtnIDArray = objFieldList[1].split(\'_\');' . "\r\n" . '								var theQtnId = theQtnIDArray[1];' . "\r\n" . '								switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '								{' . "\r\n" . '									case 2: //Radio' . "\r\n" . '										var skipFlag = false;' . "\r\n" . '										if( thisValue == 0 || thisValue == \'\' )' . "\r\n" . '										{' . "\r\n" . '											if( QtnListArray[theQtnId].isHaveOther == 1 )											' . "\r\n" . '											{' . "\r\n" . '												if(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theQtnId]] == \'\' ) //Other' . "\r\n" . '												{ ' . "\r\n" . '													skipFlag = true;' . "\r\n" . '												}' . "\r\n" . '											}' . "\r\n" . '											else' . "\r\n" . '											{' . "\r\n" . '												skipFlag = true;' . "\r\n" . '											}' . "\r\n" . '										}' . "\r\n" . '									break;' . "\r\n" . '									case 4:' . "\r\n" . '									case 16:' . "\r\n" . '									case 22:' . "\r\n" . '									case 23:' . "\r\n" . '									case 27:' . "\r\n" . '										var skipFlag = ( thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '									default:' . "\r\n" . '										var skipFlag = ( thisValue == 0 || thisValue == \'\' ) ? true : false;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '								if( skipFlag == true ) //跳过' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(cCheckRow.rows[0][1]) == 1 ) //isRelZero' . "\r\n" . '									{' . "\r\n" . '										objValue = 0;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										objValue = \'\';' . "\r\n" . '										theCheckSkip = true;' . "\r\n" . '										break;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									switch(QtnListArray[theQtnId].questionType)' . "\r\n" . '									{' . "\r\n" . '										case 1:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 2:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 0:' . "\r\n" . '													objValue = QtnListArray[theQtnId].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 4:' . "\r\n" . '										case 16:' . "\r\n" . '										case 22:' . "\r\n" . '										case 23:' . "\r\n" . '										case 27:' . "\r\n" . '											objValue = thisValue;' . "\r\n" . '										break;' . "\r\n" . '										case 6:' . "\r\n" . '										case 19:' . "\r\n" . '										case 26:' . "\r\n" . '											objValue = AnswerListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 15:' . "\r\n" . '										case 21:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													objValue = thisValue * QtnListArray[theQtnId].weight;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 17:' . "\r\n" . '											switch(parseInt(thisValue))' . "\r\n" . '											{' . "\r\n" . '												case 99999:' . "\r\n" . '													objValue = QtnListArray[theQtnId].negValue;' . "\r\n" . '												break;' . "\r\n" . '												case 0:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = QtnListArray[theBaseID].optionValue;' . "\r\n" . '												break;' . "\r\n" . '												default:' . "\r\n" . '													var theBaseID = QtnListArray[theQtnId].baseID;' . "\r\n" . '													objValue = CheckBoxListArray[theBaseID][thisValue].optionValue;' . "\r\n" . '												break;' . "\r\n" . '											}' . "\r\n" . '										break;' . "\r\n" . '										case 18:' . "\r\n" . '											objValue = YesNoListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '										case 24:' . "\r\n" . '											objValue = RadioListArray[theQtnId][thisValue].optionValue;' . "\r\n" . '										break;' . "\r\n" . '									}//end for switch' . "\r\n" . '								}//有值' . "\r\n" . '							}' . "\r\n" . '						break;' . "\r\n" . '					} //end of switch' . "\r\n" . '					//Skip For' . "\r\n" . '					if( theCheckSkip == true ) break;' . "\r\n" . '					if( m == 0 )' . "\r\n" . '					{' . "\r\n" . '						theExpression += objValue;' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var t = m-1;' . "\r\n" . '						switch(parseInt(theOpertionsList[t]))' . "\r\n" . '						{' . "\r\n" . '							case 1:' . "\r\n" . '								theExpression += \'+\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '							case 2:' . "\r\n" . '								theExpression += \'-\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '							case 3:' . "\r\n" . '								theExpression += \'*\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '							case 4:' . "\r\n" . '								theExpression += \'/\'+objValue;' . "\r\n" . '							break;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				theExpression = \'round((\'+theExpression+\'),3)\';' . "\r\n" . '				switch(parseInt(qtnType[1]))' . "\r\n" . '				{' . "\r\n" . '					case 1:' . "\r\n" . '						theExpression += \'==\';' . "\r\n" . '					break;' . "\r\n" . '					case 2:' . "\r\n" . '						theExpression += \'<\';' . "\r\n" . '					break;' . "\r\n" . '					case 3:' . "\r\n" . '						theExpression += \'<=\';' . "\r\n" . '					break;' . "\r\n" . '					case 4:' . "\r\n" . '						theExpression += \'>\';' . "\r\n" . '					break;' . "\r\n" . '					case 5:' . "\r\n" . '						theExpression += \'>=\';' . "\r\n" . '					break;' . "\r\n" . '					case 6:' . "\r\n" . '						theExpression += \'!=\';' . "\r\n" . '					break;' . "\r\n" . '				}' . "\r\n" . '				theExpression += \'round(\'+qtnType[2]+\',3)\';' . "\r\n" . '			} //end of if' . "\r\n" . '			var thisEmptyId = qtnType[7];' . "\r\n" . '			if( theCheckSkip == false )' . "\r\n" . '			{' . "\r\n" . '				if( eval(theExpression) == false )' . "\r\n" . '				{' . "\r\n" . '					var theObj = document.getElementById(\'option_\'+thisEmptyId);' . "\r\n" . '					if(theObj != null ) {' . "\r\n" . '						theObj.value = 0;' . "\r\n" . '						jQuery.Run_Survey_Conditions();' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					var theObj = document.getElementById(\'option_\'+thisEmptyId);' . "\r\n" . '					if(theObj != null ) {' . "\r\n" . '						theObj.value = 1;' . "\r\n" . '						jQuery.Run_Survey_Conditions();' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				var theObj = document.getElementById(\'option_\'+thisEmptyId);' . "\r\n" . '				if(theObj != null ) {' . "\r\n" . '					theObj.value = 0;' . "\r\n" . '					jQuery.Run_Survey_Conditions();' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}//end of for' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		jQuery.Run_Survey_Conditions();' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function survey_quota_exp(theQuotaID)' . "\r\n" . '{' . "\r\n" . '	//组合配额表达式' . "\r\n" . '	var j = 0;' . "\r\n" . '	var conList = \'\';' . "\r\n" . '	for( var condOnID in QuotaListArray[theQuotaID] )' . "\r\n" . '	{' . "\r\n" . '		var theCondOnIDArray = QuotaListArray[theQuotaID][condOnID];' . "\r\n" . '		var condOnID_QuestionType = QtnListArray[condOnID].questionType;' . "\r\n" . '		switch(condOnID_QuestionType)' . "\r\n" . '		{' . "\r\n" . '			case 1: //YesNo' . "\r\n" . '			case 2: //Radio' . "\r\n" . '			case 3: //CheckBox' . "\r\n" . '			case 4: //Text' . "\r\n" . '			case 24: //CombRadio' . "\r\n" . '			case 25: //CombCheckBox' . "\r\n" . '			case 30: //Empty' . "\r\n" . '			case 17: //Auto' . "\r\n" . '				var Con_Total = count(theCondOnIDArray[0]); //qtnID=0' . "\r\n" . '				var i = 0;' . "\r\n" . '				if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '				for( var p in theCondOnIDArray[0] )' . "\r\n" . '				{' . "\r\n" . '					var theOptionArray = theCondOnIDArray[0][p];' . "\r\n" . '					i++;' . "\r\n" . '					if( condOnID_QuestionType == 4 )  //数值填空' . "\r\n" . '					{' . "\r\n" . '						switch(theOptionArray[1])' . "\r\n" . '						{' . "\r\n" . '							case 1:opertion = \'=\';break;' . "\r\n" . '							case 2:opertion = \'<\';break;' . "\r\n" . '							case 3:opertion = \'<=\';break;' . "\r\n" . '							case 4:opertion = \'>\';break;' . "\r\n" . '							case 5:opertion = \'>=\';break;' . "\r\n" . '							case 6:opertion = \'!=\';break;' . "\r\n" . '						}' . "\r\n" . '						if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '						else opertionRelation = \' AND \';' . "\r\n" . '' . "\r\n" . '						//强行转数值比较' . "\r\n" . '						conList += \'(option_\'+condOnID+\' != \\\'\\\' AND (option_\'+condOnID+\'+1)\'+opertion+\'(\'+theOptionArray[0]+\'+1)) \'+opertionRelation;' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '						else{' . "\r\n" . '							if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' AND \';' . "\r\n" . '							else opertionRelation = \' OR \';' . "\r\n" . '						}' . "\r\n" . '						switch( condOnID_QuestionType )' . "\r\n" . '						{' . "\r\n" . '							case 1:   //是非题' . "\r\n" . '							case 2:   //单选题						   ' . "\r\n" . '							case 24:  //复合单选题' . "\r\n" . '								if( parseInt(theOptionArray[1]) == 1 ) //选择' . "\r\n" . '								{' . "\r\n" . '									conList += \'option_\'+condOnID+\' = \'+theOptionArray[0]+\' \'+opertionRelation;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									conList += \'option_\'+condOnID+\' != \'+theOptionArray[0]+\' \'+opertionRelation;' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 3:   //复选题						   ' . "\r\n" . '							case 25:  //复合复选题						   ' . "\r\n" . '								if( theOptionArray[3] == 2 )  //计算模式' . "\r\n" . '								{' . "\r\n" . '									switch(theOptionArray[1])' . "\r\n" . '									{' . "\r\n" . '										case 1:opertion = \'==\';break;' . "\r\n" . '										case 2:opertion = \'<\';break;' . "\r\n" . '										case 3:opertion = \'<=\';break;' . "\r\n" . '										case 4:opertion = \'>\';break;' . "\r\n" . '										case 5:opertion = \'>=\';break;' . "\r\n" . '										case 6:opertion = \'!=\';break;' . "\r\n" . '									}' . "\r\n" . '									if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '									else opertionRelation = \' AND \';' . "\r\n" . '									conList += \'(LENGTH(option_\'+condOnID+\')-LENGTH(REPLACE(option_\'+condOnID+\',\\\',\\\',\\\'\\\'))+1\'+opertion+theOptionArray[0]+\')\'+opertionRelation;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(theOptionArray[1]) == 1 ) //选择' . "\r\n" . '									{' . "\r\n" . '										conList += "(\',\' || option_"+condOnID+" || \',\') LIKE \'%,"+theOptionArray[0]+",%\' "+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += "(\',\' || option_"+condOnID+" || \',\') NOT LIKE \'%,"+theOptionArray[0]+",%\' "+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 17: //Auto' . "\r\n" . '								if( QtnListArray[condOnID].isSelect == 1 ) //单选' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(theOptionArray[1]) == 1 ) //选择' . "\r\n" . '									{' . "\r\n" . '										conList += \'option_\'+condOnID+\' = \'+theOptionArray[0]+\' \'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'option_\'+condOnID+\' != \'+theOptionArray[0]+\' \'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									if( parseInt(theOptionArray[1]) == 1 ) //选择' . "\r\n" . '									{' . "\r\n" . '										conList += "(\',\' || option_"+condOnID+" || \',\') LIKE \'%,"+theOptionArray[0]+",%\' "+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += "(\',\' || option_"+condOnID+" || \',\') NOT LIKE \'%,"+theOptionArray[0]+",%\' "+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 30:' . "\r\n" . '								if( parseInt(theOptionArray[1]) == 1 ) //等于' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[0] == 1 )' . "\r\n" . '									{' . "\r\n" . '										conList += \'option_\'+condOnID+\'="1" \'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'option_\'+condOnID+\'="0" \'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							    else' . "\r\n" . '								{' . "\r\n" . '									if( theOptionArray[0] == 1 )' . "\r\n" . '									{' . "\r\n" . '										conList += \'option_\'+condOnID+\'="0" \'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '									else' . "\r\n" . '									{' . "\r\n" . '										conList += \'option_\'+condOnID+\'="1" \'+opertionRelation;' . "\r\n" . '									}' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '						} //end of switch' . "\r\n" . '					} //end of if' . "\r\n" . '				} //end of foreach' . "\r\n" . '				if( Con_Total >= 2 )	conList += \')\';' . "\r\n" . '			break;' . "\r\n" . '			case 6:  //Range' . "\r\n" . '			case 7:  //Multiple' . "\r\n" . '			case 19: //AutoRange' . "\r\n" . '			case 28: //AutoMultiple' . "\r\n" . '			case 23: //CombText' . "\r\n" . '			case 10: //Rank' . "\r\n" . '			case 15: //Rating' . "\r\n" . '			case 16: //Weight' . "\r\n" . '			case 20: //AutoRank' . "\r\n" . '			case 21: //AutoRating' . "\r\n" . '			case 22: //AutoWeight' . "\r\n" . '			case 31: //级联' . "\r\n" . '				var RangeTotal = count(theCondOnIDArray); ' . "\r\n" . '				var k = 0;' . "\r\n" . '				if( RangeTotal >= 2 )  conList += \'(\';' . "\r\n" . '				for( var qtnID in theCondOnIDArray )' . "\r\n" . '				{' . "\r\n" . '					var theRangeArray = theCondOnIDArray[qtnID];' . "\r\n" . '					var i = 0;' . "\r\n" . '					var Con_Total = count(theRangeArray);' . "\r\n" . '					if( Con_Total >= 2 )  conList += \'(\';' . "\r\n" . '					for( var p in theRangeArray)' . "\r\n" . '					{' . "\r\n" . '						var theOptionArray = theRangeArray[p];' . "\r\n" . '						i++;' . "\r\n" . '						switch( condOnID_QuestionType )' . "\r\n" . '						{' . "\r\n" . '							case 23:' . "\r\n" . '								switch(theOptionArray[1])' . "\r\n" . '								{' . "\r\n" . '									case 1:opertion = \'=\';break;' . "\r\n" . '									case 2:opertion = \'<\';break;' . "\r\n" . '									case 3:opertion = \'<=\';break;' . "\r\n" . '									case 4:opertion = \'>\';break;' . "\r\n" . '									case 5:opertion = \'>=\';break;' . "\r\n" . '									case 6:opertion = \'!=\';break;' . "\r\n" . '								}' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else opertionRelation = \' AND \';' . "\r\n" . '' . "\r\n" . '								//强行转数值比较' . "\r\n" . '								conList += \'(option_\'+condOnID+\'_\'+qtnID+\' != \\\'\\\' AND (option_\'+condOnID+\'_\'+qtnID+\'+1)\'+opertion+\'(\'+theOptionArray[0]+\'+1)) \'+opertionRelation;' . "\r\n" . '							break;' . "\r\n" . '							case 10:' . "\r\n" . '							case 16:' . "\r\n" . '							case 20:' . "\r\n" . '							case 22:' . "\r\n" . '								switch(theOptionArray[1])' . "\r\n" . '								{' . "\r\n" . '									case 1:opertion = \'=\';break;' . "\r\n" . '									case 2:opertion = \'<\';break;' . "\r\n" . '									case 3:opertion = \'<=\';break;' . "\r\n" . '									case 4:opertion = \'>\';break;' . "\r\n" . '									case 5:opertion = \'>=\';break;' . "\r\n" . '									case 6:opertion = \'!=\';break;' . "\r\n" . '								}' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else opertionRelation = \' AND \';' . "\r\n" . '								conList += \'(option_\'+condOnID+\'_\'+qtnID+\' != \\\'0\\\' AND option_\'+condOnID+\'_\'+qtnID+opertion+theOptionArray[0]+\') \'+opertionRelation;' . "\r\n" . '							break;' . "\r\n" . '							case 15:' . "\r\n" . '							case 21:' . "\r\n" . '								switch(theOptionArray[1])' . "\r\n" . '								{' . "\r\n" . '									case 1:opertion = \'=\';break;' . "\r\n" . '									case 2:opertion = \'<\';break;' . "\r\n" . '									case 3:opertion = \'<=\';break;' . "\r\n" . '									case 4:opertion = \'>\';break;' . "\r\n" . '									case 5:opertion = \'>=\';break;' . "\r\n" . '									case 6:opertion = \'!=\';break;' . "\r\n" . '								}' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else opertionRelation = \' AND \';' . "\r\n" . '								switch( QtnListArray[condOnID].isSelect )' . "\r\n" . '								{' . "\r\n" . '									case 0:' . "\r\n" . '										conList += \'(option_\'+condOnID+\'_\'+qtnID+\' != \\\'0\\\' AND option_\'+condOnID+\'_\'+qtnID+\' != \\\'99\\\' AND option_\'+condOnID+\'_\'+qtnID+\' * \'+QtnListArray[condOnID].weight+opertion+theOptionArray[0]+\') \'+opertionRelation;' . "\r\n" . '									break;' . "\r\n" . '									case 1:' . "\r\n" . '									case 2:' . "\r\n" . '										conList += \'(option_\'+condOnID+\'_\'+qtnID+\' != \\\'0\\\' AND option_\'+condOnID+\'_\'+qtnID+opertion+theOptionArray[0]+\') \'+opertionRelation;' . "\r\n" . '									break;' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 6:' . "\r\n" . '							case 19:' . "\r\n" . '							case 31:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' AND \';' . "\r\n" . '									else opertionRelation = \' OR \';' . "\r\n" . '								}' . "\r\n" . '								if( parseInt(theOptionArray[1]) == 1 ) //选择' . "\r\n" . '								{' . "\r\n" . '									conList += \'option_\'+condOnID+\'_\'+qtnID+\' = \'+theOptionArray[0]+\' \'+opertionRelation;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									conList += \'option_\'+condOnID+\'_\'+qtnID+\' != \'+theOptionArray[0]+\' \'+opertionRelation;' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '							case 7:' . "\r\n" . '							case 28:' . "\r\n" . '								if( i == Con_Total) opertionRelation = \'\';' . "\r\n" . '								else{' . "\r\n" . '									if( parseInt(theOptionArray[2]) == 1 ) opertionRelation = \' AND \';' . "\r\n" . '									else opertionRelation = \' OR \';' . "\r\n" . '								}' . "\r\n" . '								if( parseInt(theOptionArray[1]) == 1 ) //选择' . "\r\n" . '								{' . "\r\n" . '									conList += "(\',\' || option_"+condOnID+\'_\'+qtnID+" || \',\') LIKE \'%,"+theOptionArray[0]+",%\' "+opertionRelation;' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									conList += "(\',\' || option_"+condOnID+\'_\'+qtnID+" || \',\') NOT LIKE \'%,"+theOptionArray[0]+",%\' "+opertionRelation;' . "\r\n" . '								}' . "\r\n" . '							break;' . "\r\n" . '						} //end of switch' . "\r\n" . '					}//end of foreach' . "\r\n" . '					if( Con_Total >= 2 )  conList += \')\';					' . "\r\n" . '					k++;' . "\r\n" . '					if( k != RangeTotal )' . "\r\n" . '					{' . "\r\n" . '						conList += \' AND \';' . "\r\n" . '					}' . "\r\n" . '				}//end of foreach' . "\r\n" . '				if( RangeTotal >= 2 )  conList += \')\';' . "\r\n" . '			break;' . "\r\n" . '		 }//end of switch' . "\r\n" . '' . "\r\n" . '		 j ++;' . "\r\n" . '		 if( j != count(QuotaListArray[theQuotaID]))' . "\r\n" . '		 {' . "\r\n" . '			  conList += \' AND \';' . "\r\n" . '		 }' . "\r\n" . '	} //End for foreach' . "\r\n" . '	return conList;' . "\r\n" . '}';

?>
