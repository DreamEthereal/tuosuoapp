<?php
//dezend by http://www.yunlu99.com/
echo 'function PagerB(pageInfo){' . "\r\n" . '  this.recordCount=pageInfo.recordCount;' . "\r\n" . '  this.pageSize=pageInfo.pageSize || 10;' . "\r\n" . '  this.pageContainer=$("#"+pageInfo.pageContainer);   ' . "\r\n" . '  this.funPageSearch=pageInfo.funPageSearch;' . "\r\n" . '  this.currentPage=pageInfo.currentPage || 1;' . "\r\n" . '  this.totalPage=this.calculateTotalPage();' . "\r\n" . '  this.pageNum=Math.max(pageInfo.pageNum || 10 , 10);' . "\r\n" . '  pageInfo.sync===false ? this.sync=false:this.sync=true;' . "\r\n" . '  ' . "\r\n" . '  this.htmlNumContainer=null;//页码的容器div' . "\r\n" . '  this.htmlFirstPage=null; //首页' . "\r\n" . '  this.htmlPrvPage=null; //上一页' . "\r\n" . '  this.htmlNextPage=null; //下一页' . "\r\n" . '  this.htmlLastPage=null; //尾页' . "\r\n" . '  this.htmlPageNumContainer=null; //页码集合的容器div' . "\r\n" . '  this.htmlPageNum=null; //所有页码的集合 ' . "\r\n" . '  this.htmlTotalRecord=null; //' . "\r\n" . '  this.htmlPageSize=null;' . "\r\n" . '  this.htmlTotalPage=null;' . "\r\n" . '  ' . "\r\n" . '  this.draw();' . "\r\n" . ' }' . "\r\n" . '' . "\r\n" . ' PagerB.prototype={' . "\r\n" . '  draw:function(){' . "\r\n" . '  /*' . "\r\n" . '  *页码的显示形式为：' . "\r\n" . '  * <div id="pager">' . "\r\n" . '  * 共<span>300</span>行  ' . "\r\n" . '  * 每页<span>20</span>行  ' . "\r\n" . '  * 共<span>15</span>页' . "\r\n" . '  * <div class="a">' . "\r\n" . '  * <span class="unUse">首页</span>' . "\r\n" . '  * <span class="unUse">上一页</span>' . "\r\n" . '  * <div class="b">' . "\r\n" . '  * <span class="cur">1</span>' . "\r\n" . '  * <span class="use">2</span>' . "\r\n" . '  * <span class="use">3</span>' . "\r\n" . '  * </div>' . "\r\n" . '  * <span class="use">下一页</span>' . "\r\n" . '  * <span class="use">尾页</span>' . "\r\n" . '  * </div>' . "\r\n" . '  * </div>  ' . "\r\n" . '  */' . "\r\n" . 'var that=this;' . "\r\n" . 'var pageHtml=\'共<span>\'+this.recordCount+\'</span>条&nbsp;&nbsp;\'' . "\r\n" . '//+\'每页<span>\'+this.pageSize+\'</span>行&nbsp;&nbsp;&nbsp;\'' . "\r\n" . '//+\'共<span>\'+this.totalPage+\'</span>页&nbsp;&nbsp;&nbsp;\'' . "\r\n" . '+"<div class=\'a\' style=\'display:none\'>"' . "\r\n" . '+"<span>首页</span>&nbsp;"' . "\r\n" . '+"<span>上一页</span>&nbsp;"' . "\r\n" . '+"<div class=\'b\' style=\'display:inline\'>"' . "\r\n" . '+this.setPageNum()' . "\r\n" . '+"</div>"' . "\r\n" . '+"&nbsp;<span>下一页</span>"' . "\r\n" . '+"&nbsp;<span>尾页</span>"' . "\r\n" . '+"</div>";' . "\r\n" . 'this.pageContainer.append(pageHtml);' . "\r\n" . 'this.htmlTotalRecord=$("span:eq(0)",this.pageContainer);' . "\r\n" . 'this.htmlPageSize=$("span:eq(1)",this.pageContainer);' . "\r\n" . 'this.htmlTotalPage=$("span:eq(2)",this.pageContainer);' . "\r\n" . 'this.htmlNumContainer=$(".a",this.pageContainer);' . "\r\n" . 'this.htmlFirstPage=$(".a > span:eq(0)",this.pageContainer);' . "\r\n" . 'this.htmlPrvPage=$(".a > span:eq(1)",this.pageContainer); ' . "\r\n" . 'this.htmlNextPage=$(".a > span:eq(2)",this.pageContainer);' . "\r\n" . 'this.htmlLastPage=$(".a > span:eq(3)",this.pageContainer);' . "\r\n" . 'this.htmlPageNumContainer=$(".b",this.htmlNumContainer);' . "\r\n" . 'this.htmlPageNum=$("span",this.htmlPageNumContainer);' . "\r\n" . 'this.htmlFirstPage.click(function(){' . "\r\n" . 'if(that.currentPage!=1){' . "\r\n" . 'that.currentPage=1;' . "\r\n" . 'that.gotoPage();' . "\r\n" . '}' . "\r\n" . '});' . "\r\n" . 'this.htmlPrvPage.click(function(){' . "\r\n" . 'if(that.currentPage!=1){' . "\r\n" . 'that.currentPage--;' . "\r\n" . 'that.gotoPage();' . "\r\n" . '} ' . "\r\n" . '});' . "\r\n" . 'this.htmlNextPage.click(function(){' . "\r\n" . 'if(that.currentPage!=that.totalPage){' . "\r\n" . 'that.currentPage++;' . "\r\n" . 'that.gotoPage();' . "\r\n" . '}' . "\r\n" . '});' . "\r\n" . 'this.htmlLastPage.click(function(){' . "\r\n" . 'if(that.currentPage!=that.totalPage){' . "\r\n" . 'that.currentPage=that.totalPage;' . "\r\n" . 'that.gotoPage();' . "\r\n" . '}' . "\r\n" . '});' . "\r\n" . 'if(this.totalPage>1){ ' . "\r\n" . 'this.htmlNumContainer.css("display","inline"); ' . "\r\n" . 'this.setStyle();' . "\r\n" . '}' . "\r\n" . '},' . "\r\n" . '  setPageNum:function(){' . "\r\n" . '//设置每页显示的页码，' . "\r\n" . '//页码的显示取决与3个因素：' . "\r\n" . '//1、每页显示的页码数量' . "\r\n" . '//2、当前页' . "\r\n" . '//3、总页数 ' . "\r\n" . 'var pageNumArray=[];' . "\r\n" . 'var firstNum=1,' . "\r\n" . 'lastNum=this.totalPage;' . "\r\n" . '  ' . "\r\n" . '//当总页数>每页显示的页数时才需要额外的处理   ' . "\r\n" . 'if(this.totalPage>this.pageNum){' . "\r\n" . 'var halfNum=Math.floor(this.pageNum/2);' . "\r\n" . 'firstNum=this.currentPage-halfNum;' . "\r\n" . 'if(firstNum<=0){' . "\r\n" . 'firstNum=1;' . "\r\n" . '}else{' . "\r\n" . 'var isTotalPage=false;' . "\r\n" . 'while((firstNum+this.pageNum)>(this.totalPage+1)){' . "\r\n" . 'isTotalPage=true;' . "\r\n" . 'firstNum--;' . "\r\n" . '}' . "\r\n" . '}' . "\r\n" . 'if(isTotalPage){' . "\r\n" . 'lastNum=this.totalPage;' . "\r\n" . '}else{' . "\r\n" . 'lastNum=firstNum+this.pageNum-1;' . "\r\n" . '} ' . "\r\n" . '}   ' . "\r\n" . 'for(var i=firstNum;i<=lastNum;i++){' . "\r\n" . 'pageNumArray.push("<span>"+i+"</span>");' . "\r\n" . '} ' . "\r\n" . 'return pageNumArray.join("&nbsp;");' . "\r\n" . '},' . "\r\n" . 'setStyle:function(){//设置显示的样式' . "\r\n" . 'var that=this;' . "\r\n" . 'if(this.currentPage!=1){' . "\r\n" . 'this.htmlFirstPage.css({cursor:"pointer",color:""}).removeClass("unUse").addClass("use");' . "\r\n" . 'this.htmlPrvPage.css({cursor:"pointer",color:""}).removeClass("unUse").addClass("use");' . "\r\n" . '}else{' . "\r\n" . 'this.htmlFirstPage.css({cursor:"",color:"grey"}).removeClass("use").addClass("unUse");' . "\r\n" . 'this.htmlPrvPage.css({cursor:"",color:"grey"}).removeClass("use").addClass("unUse");' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'if(this.currentPage!=this.totalPage){' . "\r\n" . 'this.htmlLastPage.css({cursor:"pointer",color:""}).removeClass("unUse").addClass("use");' . "\r\n" . 'this.htmlNextPage.css({cursor:"pointer",color:""}).removeClass("unUse").addClass("use");' . "\r\n" . '}else{' . "\r\n" . 'this.htmlLastPage.css({cursor:"",color:"grey"}).removeClass("use").addClass("unUse");' . "\r\n" . 'this.htmlNextPage.css({cursor:"",color:"grey"}).removeClass("use").addClass("unUse");' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'this.htmlPageNum.each(function(){' . "\r\n" . 'var pageNum=Number($(this).html());' . "\r\n" . 'if(that.currentPage!=pageNum){' . "\r\n" . '$(this).css({cursor:"pointer",' . "\r\n" . 'textDecoration:"underline"' . "\r\n" . '})' . "\r\n" . '.click(function(){' . "\r\n" . 'that.currentPage=pageNum;' . "\r\n" . 'that.gotoPage();' . "\r\n" . '})' . "\r\n" . '.mouseover(function(){' . "\r\n" . '$(this).css("color","green");' . "\r\n" . '})' . "\r\n" . '.mouseout(function(){' . "\r\n" . '$(this).css("color","");' . "\r\n" . '}).removeClass("cur").addClass("use");' . "\r\n" . '}else{' . "\r\n" . '$(this).css("color","blue").removeClass("use").addClass("cur");' . "\r\n" . '}' . "\r\n" . '});' . "\r\n" . '' . "\r\n" . '},' . "\r\n" . 'reDraw:function(_recordCount,_pageSize){' . "\r\n" . 'this.recordCount=_recordCount;' . "\r\n" . 'this.pageSize=_pageSize || this.pageSize;' . "\r\n" . 'this.currentPage=1;' . "\r\n" . 'this.totalPage=this.calculateTotalPage();' . "\r\n" . 'this.htmlTotalRecord.html(this.recordCount);' . "\r\n" . '  this.htmlPageSize.html(this.pageSize);' . "\r\n" . '  this.htmlTotalPage.html(this.totalPage);' . "\r\n" . 'if(this.totalPage>1){' . "\r\n" . 'this.htmlNumContainer.css("display","inline");' . "\r\n" . 'this.htmlPageNumContainer.html(this.setPageNum());' . "\r\n" . 'this.htmlPageNum=$("span",this.htmlPageNumContainer);' . "\r\n" . 'this.setStyle();' . "\r\n" . '}else{' . "\r\n" . 'this.htmlNumContainer.css("display","none");' . "\r\n" . '}' . "\r\n" . '},   ' . "\r\n" . '  calculateTotalPage:function(){//计算总页数' . "\r\n" . 'return Math.floor((this.recordCount+this.pageSize-1)/this.pageSize);' . "\r\n" . '},' . "\r\n" . 'gotoPage:function(){' . "\r\n" . 'if(!this.sync){//异步时，需要更新组件的外观' . "\r\n" . 'this.htmlPageNumContainer.html(this.setPageNum());' . "\r\n" . 'this.htmlPageNum=$("span",this.htmlPageNumContainer);' . "\r\n" . 'this.setStyle();' . "\r\n" . '}' . "\r\n" . 'this.funPageSearch(this.currentPage);' . "\r\n" . '}' . "\r\n" . ' };  ' . "\r\n" . '';

?>
