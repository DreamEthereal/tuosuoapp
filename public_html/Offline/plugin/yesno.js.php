<?php
//dezend by http://www.yunlu99.com/
echo '//是非题' . "\r\n" . 'function create_yesno_qtn(questionID)' . "\r\n" . '{' . "\r\n" . '    var questionRequire = \'\';' . "\r\n" . '    var questionName = \'\';' . "\r\n" . '    var questionNotes = \'\';' . "\r\n" . '    var check_survey_form_no_con_list =\'\';' . "\r\n" . '    if( QtnListArray[questionID].isRequired == \'1\' )' . "\r\n" . '    {' . "\r\n" . '       questionRequire = \'<span class=red>*</span>\';' . "\r\n" . '       //提交检查' . "\r\n" . '       check_survey_form_no_con_list += "\\tif (!CheckRadioNoClick(document.Survey_Form.option_"+questionID+", \'"+qNoScriptString(QtnListArray[questionID].questionName)+"\')){return false;} \\n";' . "\r\n" . '    }' . "\r\n" . '    questionName = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionName));' . "\r\n" . '	questionNotes = \'[是非题]\';' . "\r\n" . '' . "\r\n" . '    //字段' . "\r\n" . '    this_fields_list += \'option_\'+questionID+\'|\';' . "\r\n" . '	this_fields_type += \'1|\';' . "\r\n" . '	//逻辑条件' . "\r\n" . '	var QuestionCon = _GetQuestionCond(questionID,qid);' . "\r\n" . '	if( QuestionCon != \'\' )' . "\r\n" . '	{' . "\r\n" . '		check_survey_conditions_list += "\\tif("+QuestionCon+")\\n\\t{\\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').show();\\n\\t} \\n";' . "\r\n" . '		check_survey_conditions_list += "\\telse { \\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').hide();\\n\\t} \\n";' . "\r\n" . '' . "\r\n" . '		var check_form_list = "\\tif("+QuestionCon+")\\n\\t{\\n";' . "\r\n" . '		check_form_list += check_survey_form_no_con_list;' . "\r\n" . '		check_form_list += "\\t}\\n";' . "\r\n" . '		//移除已回复的值' . "\r\n" . '		check_form_list += "\\telse{\\n";' . "\r\n" . '		check_form_list +="\\tRadioUnClick(document.Survey_Form.option_"+questionID+");\\n";' . "\r\n" . '		check_form_list += "\\t}\\n";' . "\r\n" . '	 ' . "\r\n" . '		check_survey_form_list += check_form_list;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		check_survey_form_list += check_survey_form_no_con_list;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//关联关系' . "\r\n" . '	var RelSurveyCon = _GetSurveyValueRelationCond(questionID,qid,\'cn\');' . "\r\n" . '	if( RelSurveyCon != \'\' )' . "\r\n" . '	{' . "\r\n" . '		//此题存在多个数值关联关系的检查点' . "\r\n" . '		var theRelSurveyCon = RelSurveyCon.split(\'$$$$$$\');' . "\r\n" . '		for( var t in theRelSurveyCon )' . "\r\n" . '		{' . "\r\n" . '			var tRelSurveyCon = theRelSurveyCon[t].split(\'######\');' . "\r\n" . '			if( parseInt(tRelSurveyCon[0]) == 2 ) //空题' . "\r\n" . '			{' . "\r\n" . '				survey_empty_list += tRelSurveyCon[1];' . "\r\n" . '				var theEmptyList = tRelSurveyCon[1].split(\'*\');' . "\r\n" . '				var theEmptyId = parseInt(substr(theEmptyList[7],0,-3));' . "\r\n" . '				if( !IsSamePage(theEmptyId,questionID)) //不在同页' . "\r\n" . '				{' . "\r\n" . '					//空题字段' . "\r\n" . '					this_fields_list += \'option_\'+theEmptyId+\'|\';' . "\r\n" . '					this_fields_type += \'3|\';' . "\r\n" . '					//跑一遍空题的配额表达式' . "\r\n" . '					var theEmptyEndSurveyCon = _GetSurveyQuotaCond(theEmptyId,qid,\'cn\');' . "\r\n" . '					if( theEmptyEndSurveyCon != \'\' )' . "\r\n" . '					{' . "\r\n" . '						survey_quota_list += theEmptyEndSurveyCon;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				theEmptyList = null;' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				survey_quota_list += tRelSurveyCon[1];' . "\r\n" . '			}' . "\r\n" . '			tRelSurveyCon = null;' . "\r\n" . '		}' . "\r\n" . '		theRelSurveyCon = null;' . "\r\n" . '	}' . "\r\n" . '	' . "\r\n" . '	//问卷配额条件' . "\r\n" . '	var EndSurveyCon = _GetSurveyQuotaCond(questionID,qid,\'cn\');' . "\r\n" . '	if( EndSurveyCon != \'\' )' . "\r\n" . '	{' . "\r\n" . '		survey_quota_list += EndSurveyCon;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '    var yesno = "{ ";' . "\r\n" . '    yesno += " questionID: "+questionID+",";' . "\r\n" . '    yesno += " questionRequire: \'"+questionRequire+"\',";' . "\r\n" . '    yesno += " questionName: \'"+qShowQtnName(questionName,questionID,1)+"\',";' . "\r\n" . '    yesno += " questionNotes: \'"+questionNotes+"\',";' . "\r\n" . '    questionTips = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionNotes));' . "\r\n" . '    yesno += " questionTips: \'"+qShowQtnName(questionTips,questionID,2)+"\',";' . "\r\n" . '    yesno += " qtns:[ ";' . "\r\n" . '	var theOptionOdNum = 0;' . "\r\n" . '    for( var question_yesnoID in YesNoListArray[questionID])' . "\r\n" . '    {' . "\r\n" . '		yesno += "{";' . "\r\n" . '        yesno += " theOptionOdNum:"+theOptionOdNum+",";' . "\r\n" . ' 		theOptionOdNum ++;' . "\r\n" . '		if(  theOptionOdNum % 2 == 0 )' . "\r\n" . '		{' . "\r\n" . '			yesno += " bgcolor:\'#ffffff\',";' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			yesno += " bgcolor:\'#f5f5f5\',";' . "\r\n" . '		}' . "\r\n" . '        yesno += " optionName:\'"+YesNoListArray[questionID][question_yesnoID].optionName+"\',";' . "\r\n" . '        yesno += " optionValue:\'"+question_yesnoID+"\',";' . "\r\n" . '        yesno += " optionID:\'option_"+questionID+"\',";' . "\r\n" . '		var optionID = \'option_\'+questionID;' . "\r\n" . '		if( count(dataRow.rows) != 0 )' . "\r\n" . '		{' . "\r\n" . '			if( dataRow.rows[0][dataIndex[optionID]] != \'\' && dataRow.rows[0][dataIndex[optionID]] == question_yesnoID.toString() )' . "\r\n" . '			{' . "\r\n" . '				yesno += " isCheck:\'checked\',";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				yesno += " isCheck:\'\',";' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			yesno += " isCheck:\'\',";' . "\r\n" . '		}' . "\r\n" . '        yesno += " perLine:\'\'";' . "\r\n" . '	    yesno += "},";' . "\r\n" . '	}' . "\r\n" . '	yesno = yesno.substr(0,yesno.length-1)+"] }";' . "\r\n" . '	var jsonyesno = eval(\'(\'+yesno+\')\');' . "\r\n" . '' . "\r\n" . '	var tplText = \'<table width="100%" class="pertable" id="question_{$questionID}"><tr><td class="question" valign=center>&nbsp;{$questionRequire}<span class="textEdit" id="questionName_{$questionID}">{$questionName}</span>&nbsp;<span class=notes>{$questionNotes}</span></td></tr><tr><td class="tips"><span class="textEdit" id="questionNotes_{$questionID}">{$questionTips}</span></td></tr><tr><td><table width=100%>{foreach $qtns as $i => $qtn}<tr class="tdheight" bgcolor="{$qtn.bgcolor}"><td class=answer align=center valign=center width=1%><input onclick="jQuery.Check_Survey_Conditions()" type="radio" value="{$qtn.optionValue}" name="{$qtn.optionID}" id="{$qtn.optionID}" {$qtn.isCheck}></td><td align=left valign=center class=answer nowrap width=99%><a href="javascript:void(0)" onclick=javascript:selRadioCheckRows("{$qtn.optionID}",{$qtn.theOptionOdNum});><div style="white-space:nowrap;" class=tdlineheight><span class="textEdit" id="optionName_1_{$questionID}_{$qtn.optionID}">{$qtn.optionName}</span></div></a></td></tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '' . "\r\n" . '	var t = new jSmart(tplText);' . "\r\n" . '	//$(\'#survey_content_container\').append( t.fetch(jsonyesno));         ' . "\r\n" . '    survey_content_container_html += t.fetch(jsonyesno);' . "\r\n" . '	jsonyesno = null;' . "\r\n" . '}' . "\r\n" . '';

?>
