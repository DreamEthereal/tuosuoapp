<?php
//dezend by http://www.yunlu99.com/
echo 'function create_autorating_qtn(questionID)' . "\r\n" . '{' . "\r\n" . '	var theInfoQtnName = qNoScriptString(QtnListArray[questionID].questionName);' . "\r\n" . '	switch( QtnListArray[questionID].isSelect )' . "\r\n" . '	{' . "\r\n" . '		case 1: //开放回复' . "\r\n" . '			var tplText = \'<table width="100%" class="pertable" id="question_{$questionID}"><tr><td class="question" valign=center>&nbsp;{$questionRequire}<span class="textEdit" id="questionName_{$questionID}">{$questionName}</span>&nbsp;<span class=notes>{$questionNotes}</span></td></tr><tr><td class="tips"><span class="textEdit" id="questionNotes_{$questionID}">{$questionTips}</span></td></tr><tr><td><table cellSpacing=0 cellPadding=0 width=100% id="qtn_table_{$questionID}">{foreach $qtns as $i => $qtn}<tr style="display:none" id="rating_{$baseID}_{$questionID}_{$qtn.optionNameID}"><td class="answer tdheight" align="center" nowrap><input type="number" size=8 name="{$qtn.optionID}" id="{$qtn.optionID}" maxlength="8" onKeyUp="this.value=this.value.replace(/[^\\\\d\\\\.\\\\d]/g,\\\'\\\')" onafterpaste="this.value=this.value.replace(/[^\\\\d\\\\.\\\\d]/g,\\\'\\\')" onblur="jQuery.Check_Survey_Conditions();" value="{$qtn.optionValue}"></td><td class="answer" nowrap>&nbsp;{$qtn.optionName}</td><td width=10></td><td style="display:none" id="TextInput_{$questionID}_{$qtn.optionNameID}" class="answer" nowrap>理由：<input name="TextOtherValue_{$questionID}_{$qtn.optionNameID}" id="TextOtherValue_{$questionID}_{$qtn.optionNameID}" value="{$qtn.otherValue}" type="text" size=40></td><td width=90%></td></tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '		break;' . "\r\n" . '		case 0:' . "\r\n" . '			var tplText = \'<table width="100%" class="pertable" id="question_{$questionID}"><tr><td class="question" valign=center>&nbsp;{$questionRequire}<span class="textEdit" id="questionName_{$questionID}">{$questionName}</span>&nbsp;<span class=notes>{$questionNotes}</span></td></tr><tr><td class="tips"><span class="textEdit" id="questionNotes_{$questionID}">{$questionTips}</span></td></tr><tr><td><table cellSpacing=0 cellPadding=0 id="qtn_table_{$questionID}"><tr class=tdheight style="display:none" id="rating_{$baseID}_{$questionID}_title"><td>&nbsp;</td><td width=8></td><td colspan="{$colWidth}" class="answer" nowrap><span style="float:left" class="answer">{$unitTextLeft}&nbsp;</span><span style="float:right" class="answer">&nbsp;{$unitTextRight}</span></td><td style="display:{$isHaveUnkown}">&nbsp;</td><td width=10></td><td>&nbsp;</td></tr><tr style="display:none" id="rating_{$baseID}_{$questionID}_text"><td class=tdheight>&nbsp;</td><td width=8></td>{foreach $answers as $j => $answer}<td class="answer" align="center" nowrap>{$answer.ratingName}</span></td><td width=10></td>{/foreach}<td class="answer" align="center" nowrap style="display:{$isHaveUnkown}">不清楚</span></td><td width=10></td><td>&nbsp;</td></tr>{foreach $qtns as $i => $qtn}<tr style="display:none" id="rating_{$baseID}_{$questionID}_{$qtn.optionNameID}"><td class="answer tdheight" nowrap>&nbsp;&nbsp;{$qtn.optionName}</td><td width=8></td>{$qtn.sub_option_list}<td style="display:none" id="TextInput_{$questionID}_{$qtn.optionNameID}" class="answer" nowrap>理由：<input name="TextOtherValue_{$questionID}_{$qtn.optionNameID}" id="TextOtherValue_{$questionID}_{$qtn.optionNameID}" value="{$qtn.otherValue}" type="text" size=30></td></tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '		break;' . "\r\n" . '		case 2:  //滑动条' . "\r\n" . '			var tplText = \'<table width="100%" class="pertable" id="question_{$questionID}"><tr><td class="question" valign=center>&nbsp;{$questionRequire}<span class="textEdit" id="questionName_{$questionID}">{$questionName}</span>&nbsp;<span class=notes>{$questionNotes}</span></td></tr><tr><td class="tips"><span class="textEdit" id="questionNotes_{$questionID}">{$questionTips}</span></td></tr><tr><td style="padding-top:10px"><table cellSpacing=0 cellPadding=0 width=100% id="qtn_table_{$questionID}">{foreach $qtns as $i => $qtn}<tr style="display:none" id="rating_{$baseID}_{$questionID}_{$qtn.optionNameID}"><td class="answer tdheight" align=right nowrap>&nbsp;&nbsp;<span class="textEdit" id="optionName_21_{$questionID}_{$qtn.optionNameID}">{$qtn.optionName}</span></td><td width=8></td><td><input name="{$qtn.optionID}" id="{$qtn.optionID}" type="text" value="{$qtn.optionValue}" size=10 onclick="javascript:selslider(this,{$qtn.startScale},{$qtn.endScale});" onblur="jQuery.Check_Survey_Conditions();"></td><td width=90%></td></tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '		break;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//显示题目' . "\r\n" . '	var check_survey_form_no_con_list = \'\';' . "\r\n" . '	var questionRequire = \'\';' . "\r\n" . '	var questionName = \'\';' . "\r\n" . '	var questionNotes = \'\';' . "\r\n" . '	if( QtnListArray[questionID].isRequired == 1 )' . "\r\n" . '	{' . "\r\n" . '		questionRequire = \'<span class=red>*</span>\';' . "\r\n" . '	}' . "\r\n" . '	questionName = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionName));' . "\r\n" . '	questionNotes = \'[自动评分题]\';' . "\r\n" . '' . "\r\n" . '	var dataqtn = "{ ";' . "\r\n" . '    dataqtn += " questionID: "+questionID+",";' . "\r\n" . '    dataqtn += " questionRequire: \'"+questionRequire+"\',";' . "\r\n" . '    dataqtn += " questionName: \'"+qShowQtnName(questionName,questionID,1)+"\',";' . "\r\n" . '    dataqtn += " questionNotes: \'"+questionNotes+"\',";' . "\r\n" . '    questionTips = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionNotes));' . "\r\n" . '    dataqtn += " questionTips: \'"+qShowQtnName(questionTips,questionID,2)+"\',";' . "\r\n" . '' . "\r\n" . '	var remove_value_list = \'\';' . "\r\n" . '	var the_check_survey_conditions_list = \'\';' . "\r\n" . '' . "\r\n" . '	//来源问题及选项' . "\r\n" . '	var theBaseID = QtnListArray[questionID].baseID;' . "\r\n" . '	var theBaseQtnArray = QtnListArray[theBaseID];' . "\r\n" . '	var theCheckBoxListArray = CheckBoxListArray[theBaseQtnArray.questionID];' . "\r\n" . '' . "\r\n" . '	//来源问题不存在' . "\r\n" . '	if( count(theBaseQtnArray)==0 && QtnListArray[questionID].isRequired == 1)' . "\r\n" . '	{' . "\r\n" . '		check_survey_form_no_con_list += "\\tshowMessage(\'"+theInfoQtnName+"，来源问题不存在或已被删除\');return false;\\n";' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	switch(QtnListArray[questionID].isSelect)' . "\r\n" . '	{' . "\r\n" . '		case 1:  //开放回复' . "\r\n" . '			var optionAutoArray = [];' . "\r\n" . '			var optionMinMaxArray = [];' . "\r\n" . '			var i=0;' . "\r\n" . '			for( var question_checkboxID in theCheckBoxListArray )' . "\r\n" . '			{' . "\r\n" . '				var theQuestionArray = theCheckBoxListArray[question_checkboxID];' . "\r\n" . '				if( theBaseQtnArray.questionType == 3 )' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '				}' . "\r\n" . '' . "\r\n" . '				if( theBaseQtnArray.questionType == 25 )  //组合多选' . "\r\n" . '				{' . "\r\n" . '					if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '					{' . "\r\n" . '						if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							if( count(dataRow.rows) != 0 )' . "\r\n" . '							{' . "\r\n" . '								if( typeof dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID] != \'undefined\' && dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]] != \'\' )' . "\r\n" . '								{' . "\r\n" . '									optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]])+\')\';' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				optionMinMaxArray[i] = question_checkboxID;' . "\r\n" . '				i++;' . "\r\n" . '			}' . "\r\n" . '' . "\r\n" . '			//有其他项' . "\r\n" . '			if( theBaseQtnArray.isHaveOther == 1 )' . "\r\n" . '			{' . "\r\n" . '				optionMinMaxArray[i] = 0;' . "\r\n" . '				if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '				{' . "\r\n" . '					if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						if( count(dataRow.rows) != 0 )' . "\r\n" . '						{' . "\r\n" . '							if( dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]] != \'\' )' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]])+\')\';' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			' . "\r\n" . '			var isHaveOther = (theBaseQtnArray.isHaveOther != \'\' ) ? theBaseQtnArray.isHaveOther : 0;' . "\r\n" . '' . "\r\n" . '			dataqtn += " baseID: \'"+theBaseID+"\',";' . "\r\n" . '			var theOptionAutoIDList = \'\';' . "\r\n" . '			dataqtn += " qtns:[ ";' . "\r\n" . '			for( var tmp in optionMinMaxArray )' . "\r\n" . '			{' . "\r\n" . '				var optionAutoID = optionMinMaxArray[tmp];' . "\r\n" . '				var optionAutoName = optionAutoArray[optionAutoID];' . "\r\n" . '				theOptionAutoIDList += optionAutoID+\',\';' . "\r\n" . '' . "\r\n" . '				dataqtn += "{";' . "\r\n" . '				dataqtn += " optionName: \'"+optionAutoName+"\',";' . "\r\n" . '				dataqtn += " optionNameID: \'"+optionAutoID+"\',";' . "\r\n" . '				dataqtn += " optionID: \'option_"+questionID+\'_\'+optionAutoID+"\',";' . "\r\n" . '				if( count(dataRow.rows) != 0 )' . "\r\n" . '				{' . "\r\n" . '					if( dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]] != \'\' && dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]] != \'0\' && dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]] != \'0.00\')' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " optionValue:\'"+dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]]+"\',";' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " optionValue:\'\',";' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					dataqtn += " optionValue:\'\',";' . "\r\n" . '				}' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					if( count(dataRow.rows) != 0 )' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " otherValue:\'"+qhtmlspecialchars(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+questionID+\'_\'+optionAutoID]])+"\'";' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " otherValue:\'\'";' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					dataqtn += " otherValue: \'\'";' . "\r\n" . '				}' . "\r\n" . '				dataqtn += "},";' . "\r\n" . '				' . "\r\n" . '				var theInfoAutoName = qNoScriptString(optionAutoName);' . "\r\n" . '' . "\r\n" . '				//记录移除值' . "\r\n" . '				remove_value_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '				remove_value_list +="\\t\\tTextUnInput(document.Survey_Form.option_"+questionID+\'_\'+optionAutoID+");\\n";' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					 remove_value_list +="\\t\\tTextUnInput(document.Survey_Form.TextOtherValue_"+questionID+\'_\'+optionAutoID+");\\n";' . "\r\n" . '				}' . "\r\n" . '				remove_value_list +="\\t}\\n";' . "\r\n" . '' . "\r\n" . '				//处理页面字段' . "\r\n" . '				this_fields_list += \'option_\'+questionID+\'_\'+optionAutoID+\'|\';' . "\r\n" . '				this_fields_type += \'3|\';' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					this_fields_list += \'TextOtherValue_\'+questionID+\'_\'+optionAutoID+\'|\';' . "\r\n" . '					this_fields_type += \'3|\';' . "\r\n" . '				}' . "\r\n" . '' . "\r\n" . '				//页面检查' . "\r\n" . '				if( QtnListArray[questionID].isRequired == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif(!CheckNotNull(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+theInfoAutoName+"\')){return false;} \\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif(!CheckIsValue(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+theInfoAutoName+"\',"+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+")){return false;} \\n";' . "\r\n" . '					check_survey_form_no_con_list +="\\t}\\n";		' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif(!CheckIsValue(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+theInfoAutoName+"\',"+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+")){return false;} \\n";' . "\r\n" . '					check_survey_form_no_con_list +="\\t}\\n";' . "\r\n" . '				}' . "\r\n" . '' . "\r\n" . '				//有说明理由项' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					var theMarginValue  = QtnListArray[questionID].maxOption;' . "\r\n" . '' . "\r\n" . '					//输入检查' . "\r\n" . '					check_survey_form_no_con_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif ( Number(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+".value) <= "+theMarginValue+" && Trim(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+".value) != \'\' )\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\t{\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\t\\tif(!CheckNotNull(document.Survey_Form."+\'TextOtherValue_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+qNoScriptString(optionAutoName)+\' - \'+QtnListArray[questionID].maxOption+"分以下的理由\')){return false;}\\n\\t\\t}\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\telse\\n\\t\\t{\\n\\t\\t\\tTextUnInput(document.Survey_Form.TextOtherValue_"+questionID+\'_\'+optionAutoID+");\\n\\t\\t}\\n";' . "\r\n" . '					check_survey_form_no_con_list +="\\t}\\n";' . "\r\n" . '' . "\r\n" . '					//控制理由项的显示' . "\r\n" . '					the_check_survey_conditions_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					the_check_survey_conditions_list +=  "\\t\\tif( Number(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+".value) <= "+theMarginValue+" && Trim(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+".value) != \'\' )\\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\t{\\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\t\\tdocument.getElementById(\'TextInput_"+questionID+\'_\'+optionAutoID+"\').style.display=\'block\';\\n\\t\\t} \\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\telse { \\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\t\\tdocument.getElementById(\'TextInput_"+questionID+\'_\'+optionAutoID+"\').style.display=\'none\';\\n\\t\\t} \\n";' . "\r\n" . '					the_check_survey_conditions_list +="\\t}\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '			theQuestionArray = null;' . "\r\n" . '		break;' . "\r\n" . '		case 0:   //刻度选择' . "\r\n" . '			dataqtn += " baseID: \'"+theBaseID+"\',";' . "\r\n" . '			var Answer = [];' . "\r\n" . '			var answers = " answers:[";' . "\r\n" . '			var tmp =0;' . "\r\n" . '			if( QtnListArray[questionID].isColArrange == 1 )' . "\r\n" . '			{' . "\r\n" . '				for(var i= QtnListArray[questionID].startScale;i<=QtnListArray[questionID].endScale;i++)' . "\r\n" . '				{' . "\r\n" . '					answers += "{";' . "\r\n" . '					answers += " ratingName:\'"+QtnListArray[questionID].weight*i +"\'";' . "\r\n" . '					answers += "},";' . "\r\n" . '					Answer.push(i);' . "\r\n" . '					tmp++;' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				for(i=QtnListArray[questionID].endScale;i>=QtnListArray[questionID].startScale;i--)' . "\r\n" . '				{' . "\r\n" . '					answers += "{";' . "\r\n" . '					answers += " ratingName:\'"+QtnListArray[questionID].weight*i +"\'";' . "\r\n" . '					answers += "},";' . "\r\n" . '					Answer.push(i);' . "\r\n" . '					tmp++;' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			//两端文本' . "\r\n" . '			if( Trim(QtnListArray[questionID].unitText) == \'\' )' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " isHaveUnitText: \'none\',";' . "\r\n" . '				dataqtn += " unitTextLeft: \'\',";' . "\r\n" . '				dataqtn += " unitTextRight: \'\',";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " isHaveUnitText: \'\',";' . "\r\n" . '				var theUnitText = QtnListArray[questionID].unitText.split(\'###\');' . "\r\n" . '				dataqtn += " unitTextLeft: \'"+theUnitText[0]+"\',";' . "\r\n" . '				dataqtn += " unitTextRight: \'"+theUnitText[1]+"\',";' . "\r\n" . '			}' . "\r\n" . '			dataqtn += " colWidth: "+tmp*2+",";' . "\r\n" . '' . "\r\n" . '			//不清楚' . "\r\n" . '			if( QtnListArray[questionID].isHaveUnkown == 1 ) ' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " isHaveUnkown: \'\',";' . "\r\n" . '				Answer.push(99);' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " isHaveUnkown: \'none\',";' . "\r\n" . '			}' . "\r\n" . '			dataqtn += answers.substr(0,answers.length-1)+"], ";' . "\r\n" . '' . "\r\n" . '			var optionAutoArray = [];' . "\r\n" . '			var optionMinMaxArray = [];' . "\r\n" . '			var i=0;' . "\r\n" . '			for( var question_checkboxID in theCheckBoxListArray )' . "\r\n" . '			{' . "\r\n" . '				var theQuestionArray = theCheckBoxListArray[question_checkboxID];' . "\r\n" . '				if( theBaseQtnArray.questionType == 3 )' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '				}' . "\r\n" . '' . "\r\n" . '				if( theBaseQtnArray.questionType == 25 )  //组合多选' . "\r\n" . '				{' . "\r\n" . '					if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '					{' . "\r\n" . '						if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							if( count(dataRow.rows) != 0 )' . "\r\n" . '							{' . "\r\n" . '								if( typeof dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID] != \'undefined\' && dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]] != \'\' )' . "\r\n" . '								{' . "\r\n" . '									optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]])+\')\';' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				optionMinMaxArray[i] = question_checkboxID;' . "\r\n" . '				i++;' . "\r\n" . '			}' . "\r\n" . '' . "\r\n" . '			//来源问题的最大与最少ID值' . "\r\n" . '			var theFirstID = (optionMinMaxArray[0] != \'\') ? optionMinMaxArray[0] : 0;' . "\r\n" . '			var theLastID = (optionMinMaxArray[count(optionMinMaxArray)-1] != \'\' ) ? optionMinMaxArray[count(optionMinMaxArray)-1] :0;' . "\r\n" . '' . "\r\n" . '			//有其他项' . "\r\n" . '			if( theBaseQtnArray.isHaveOther == 1 )' . "\r\n" . '			{' . "\r\n" . '				optionMinMaxArray[i] = 0;' . "\r\n" . '				if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '				{' . "\r\n" . '					if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						if( count(dataRow.rows) != 0 )' . "\r\n" . '						{' . "\r\n" . '							if( dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]] != \'\' )' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]])+\')\';' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			var isHaveOther = (theBaseQtnArray.isHaveOther != \'\' ) ? theBaseQtnArray.isHaveOther : 0;' . "\r\n" . '' . "\r\n" . '			dataqtn += " qtns:[ ";' . "\r\n" . '			var theOptionAutoIDList = \'\';' . "\r\n" . '			for( var tmp in optionMinMaxArray )' . "\r\n" . '			{' . "\r\n" . '				var optionAutoID = optionMinMaxArray[tmp];' . "\r\n" . '				var optionAutoName = optionAutoArray[optionAutoID];' . "\r\n" . '				theOptionAutoIDList += optionAutoID+\',\';' . "\r\n" . '' . "\r\n" . '				dataqtn += "{";' . "\r\n" . '				dataqtn += " optionName: \'"+optionAutoName+"\',";' . "\r\n" . '				dataqtn += " optionNameID: \'"+optionAutoID+"\',";' . "\r\n" . '' . "\r\n" . '				var theInfoAutoName = qNoScriptString(optionAutoName);' . "\r\n" . '				//记录移除值' . "\r\n" . '				remove_value_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '				remove_value_list +="\\t\\tRadioUnClick(document.Survey_Form.option_"+questionID+\'_\'+optionAutoID+");\\n";' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					 remove_value_list +="\\t\\tTextUnInput(document.Survey_Form.TextOtherValue_"+questionID+\'_\'+optionAutoID+");\\n";' . "\r\n" . '				}' . "\r\n" . '				remove_value_list +="\\t}\\n";' . "\r\n" . '' . "\r\n" . '				var sub_option_list = \'\';' . "\r\n" . '				for( var optionValue in Answer )' . "\r\n" . '				{' . "\r\n" . '					sub_option_list += \'<td class="answer" align="center" id="ratingcheck_\'+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+\'_\'+Answer[optionValue]+\'"><input type="radio" value="\'+Answer[optionValue]+\'" name="option_\'+questionID+\'_\'+optionAutoID+\'" id="option_\'+questionID+\'_\'+optionAutoID+\'" onclick="jQuery.Check_Survey_Conditions()" \';' . "\r\n" . '					if( count(dataRow.rows) != 0 )' . "\r\n" . '					{' . "\r\n" . '						if( dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]] != \'0\' && dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]] == Answer[optionValue].toString() )' . "\r\n" . '						{' . "\r\n" . '							sub_option_list += \'checked\';  //checked' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							sub_option_list += \'\';' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						sub_option_list += \'\';' . "\r\n" . '					}' . "\r\n" . '					sub_option_list += \'></td><td width=10></td>\';' . "\r\n" . '				}' . "\r\n" . '				dataqtn += " sub_option_list:\'"+ sub_option_list +"\',";' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					if( count(dataRow.rows) != 0 )' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " otherValue:\'"+qhtmlspecialchars(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+questionID+\'_\'+optionAutoID]])+"\'";' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " otherValue:\'\'";' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					dataqtn += " otherValue:\'\'";' . "\r\n" . '				}' . "\r\n" . '				dataqtn += "},";' . "\r\n" . '' . "\r\n" . '				//处理页面字段' . "\r\n" . '				this_fields_list += \'option_\'+questionID+\'_\'+optionAutoID+\'|\';' . "\r\n" . '				this_fields_type += \'1|\';' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					this_fields_list += \'TextOtherValue_\'+questionID+\'_\'+optionAutoID+\'|\';' . "\r\n" . '					this_fields_type += \'3|\';' . "\r\n" . '				}' . "\r\n" . '' . "\r\n" . '				//页面检查' . "\r\n" . '				if( QtnListArray[questionID].isRequired == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif(!CheckRadioNoClick(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+theInfoAutoName+"\')){return false;} \\n";' . "\r\n" . '					check_survey_form_no_con_list +="\\t}\\n";' . "\r\n" . '				}' . "\r\n" . '' . "\r\n" . '				//有说明理由项' . "\r\n" . '				if(QtnListArray[questionID].isHaveOther == 1)' . "\r\n" . '				{' . "\r\n" . '					var theMarginValue  = QtnListArray[questionID].maxOption / QtnListArray[questionID].weight;' . "\r\n" . '' . "\r\n" . '					//输入检查' . "\r\n" . '					check_survey_form_no_con_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif ( getRatingValue(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+") <= "+theMarginValue+" && getRatingValue(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+") != 0 )\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\t{\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\t\\tif(!CheckNotNull(document.Survey_Form."+\'TextOtherValue_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+qNoScriptString(optionAutoName)+\' - \'+QtnListArray[questionID].maxOption+"分以下的理由\')){return false;}\\n\\t\\t}\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\telse\\n\\t\\t{\\n\\t\\t\\tTextUnInput(document.Survey_Form.TextOtherValue_"+questionID+\'_\'+optionAutoID+");\\n\\t\\t}\\n";' . "\r\n" . '					check_survey_form_no_con_list +="\\t}\\n";' . "\r\n" . '' . "\r\n" . '					//控制理由项的显示' . "\r\n" . '					the_check_survey_conditions_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					the_check_survey_conditions_list +=  "\\t\\tif( getRatingValue(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+") <= "+theMarginValue+" && getRatingValue(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+") != 0 )\\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\t{\\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\t\\tdocument.getElementById(\'TextInput_"+questionID+\'_\'+optionAutoID+"\').style.display=\'block\';\\n\\t\\t} \\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\telse { \\n";' . "\r\n" . '					the_check_survey_conditions_list += "\\t\\t\\tdocument.getElementById(\'TextInput_"+questionID+\'_\'+optionAutoID+"\').style.display=\'none\';\\n\\t\\t} \\n";' . "\r\n" . '					the_check_survey_conditions_list +="\\t}\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '			//连续回复' . "\r\n" . '			if( QtnListArray[questionID].isContInvalid == 1 && QtnListArray[questionID].contInvalidValue != 0 )' . "\r\n" . '			{' . "\r\n" . '				check_survey_form_no_con_list += "\\tif (!CheckRangeIsContInvalid("+questionID+","+theFirstID+","+theLastID+",\'"+theInfoQtnName+"\',"+QtnListArray[questionID].contInvalidValue+")){return false;} \\n";' . "\r\n" . '			}' . "\r\n" . '			Answer = null;' . "\r\n" . '			theQuestionArray = null;' . "\r\n" . '		break;' . "\r\n" . '		case 2:' . "\r\n" . '			var optionAutoArray = [];' . "\r\n" . '			var optionMinMaxArray = [];' . "\r\n" . '			var i=0;' . "\r\n" . '			for( var question_checkboxID in theCheckBoxListArray )' . "\r\n" . '			{' . "\r\n" . '				var theQuestionArray = theCheckBoxListArray[question_checkboxID];' . "\r\n" . '				if( theBaseQtnArray.questionType == 3 )' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '				}' . "\r\n" . '' . "\r\n" . '				if( theBaseQtnArray.questionType == 25 )  //组合多选' . "\r\n" . '				{' . "\r\n" . '					if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '					{' . "\r\n" . '						if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							if( count(dataRow.rows) != 0 )' . "\r\n" . '							{' . "\r\n" . '								if( typeof dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID] != \'undefined\' && dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]] != \'\' )' . "\r\n" . '								{' . "\r\n" . '									optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]])+\')\';' . "\r\n" . '								}' . "\r\n" . '								else' . "\r\n" . '								{' . "\r\n" . '									optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				optionMinMaxArray[i] = question_checkboxID;' . "\r\n" . '				i++;' . "\r\n" . '			}' . "\r\n" . '' . "\r\n" . '			//来源问题的最大与最少ID值' . "\r\n" . '			var theFirstID = (optionMinMaxArray[0] != \'\') ? optionMinMaxArray[0] : 0;' . "\r\n" . '			var theLastID = (optionMinMaxArray[count(optionMinMaxArray)-1] != \'\' ) ? optionMinMaxArray[count(optionMinMaxArray)-1] :0;' . "\r\n" . '' . "\r\n" . '			//有其他项' . "\r\n" . '			if( theBaseQtnArray.isHaveOther == 1 )' . "\r\n" . '			{' . "\r\n" . '				optionMinMaxArray[i] = 0;' . "\r\n" . '				if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '				{' . "\r\n" . '					if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						if( count(dataRow.rows) != 0 )' . "\r\n" . '						{' . "\r\n" . '							if( dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]] != \'\' )' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]])+\')\';' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			' . "\r\n" . '			var isHaveOther = (theBaseQtnArray.isHaveOther != \'\' ) ? theBaseQtnArray.isHaveOther : 0;' . "\r\n" . '' . "\r\n" . '			dataqtn += " baseID: \'"+theBaseID+"\',";' . "\r\n" . '			var theOptionAutoIDList = \'\';' . "\r\n" . '			dataqtn += " qtns:[ ";' . "\r\n" . '			for( var tmp in optionMinMaxArray )' . "\r\n" . '			{' . "\r\n" . '				var optionAutoID = optionMinMaxArray[tmp];' . "\r\n" . '				var optionAutoName = optionAutoArray[optionAutoID];' . "\r\n" . '				theOptionAutoIDList += optionAutoID+\',\';' . "\r\n" . '' . "\r\n" . '				dataqtn += "{";' . "\r\n" . '				dataqtn += " optionName: \'"+optionAutoName+"\',";' . "\r\n" . '				dataqtn += " optionNameID: \'"+optionAutoID+"\',";' . "\r\n" . '				dataqtn += " optionID: \'option_"+questionID+\'_\'+optionAutoID+"\',";' . "\r\n" . '				dataqtn += " startScale: \'"+QtnListArray[questionID].startScale+"\',";' . "\r\n" . '				dataqtn += " endScale: \'"+QtnListArray[questionID].endScale+"\',";' . "\r\n" . '				if( count(dataRow.rows) != 0 )' . "\r\n" . '				{' . "\r\n" . '					if( dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]] != \'0\' && dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]] != \'\' )' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " optionValue:\'"+dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+optionAutoID]]+"\'";' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " optionValue:\'\'";' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					dataqtn += " optionValue:\'\'";' . "\r\n" . '				}' . "\r\n" . '				dataqtn += "},";' . "\r\n" . '			' . "\r\n" . '				var theInfoAutoName = qNoScriptString(optionAutoName);' . "\r\n" . '' . "\r\n" . '				//记录移除值' . "\r\n" . '				remove_value_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '				remove_value_list +="\\t\\tTextUnInput(document.Survey_Form.option_"+questionID+\'_\'+optionAutoID+");\\n";' . "\r\n" . '				remove_value_list +="\\t}\\n";' . "\r\n" . '' . "\r\n" . '				//处理页面字段' . "\r\n" . '				this_fields_list += \'option_\'+questionID+\'_\'+optionAutoID+\'|\';' . "\r\n" . '				this_fields_type += \'3|\';' . "\r\n" . '' . "\r\n" . '				//页面检查' . "\r\n" . '				if( QtnListArray[questionID].isRequired == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif(!CheckNotNull(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+theInfoAutoName+"\')){return false;} \\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif(!CheckNumber(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+theInfoAutoName+"\',"+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+")){return false;} \\n";' . "\r\n" . '					check_survey_form_no_con_list +="\\t}\\n";		' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list +="\\tif (document.getElementById(\'rating_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '					check_survey_form_no_con_list += "\\t\\tif(!CheckNumber(document.Survey_Form."+\'option_\'+questionID+\'_\'+optionAutoID+", \'"+theInfoQtnName+\' - \'+theInfoAutoName+"\',"+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+")){return false;} \\n";' . "\r\n" . '					check_survey_form_no_con_list +="\\t}\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '		break;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//逻辑条件' . "\r\n" . '	var QuestionCon = _GetQuestionCond(questionID,qid);' . "\r\n" . '	var theBaseIsSelect = (count(theBaseQtnArray) ==0 ) ? 0 : theBaseQtnArray.isSelect;' . "\r\n" . '    var theIsSamePage = IsSamePage(questionID,theBaseID)? 1:0 ;' . "\r\n" . '	var theOriValue = \'\';' . "\r\n" . '	if( count(dataRow.rows) != 0 )' . "\r\n" . '	{' . "\r\n" . '		if( dataRow.rows[0][dataIndex[\'option_\'+theBaseID]] != \'0\' && dataRow.rows[0][dataIndex[\'option_\'+theBaseID]] != \'\' )' . "\r\n" . '		{' . "\r\n" . '			theOriValue = dataRow.rows[0][dataIndex[\'option_\'+theBaseID]];' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	var getCheckBoxNoneofAbove = "_getCheckBoxNoneofAbove("+theBaseQtnArray.questionType+","+theBaseID+","+theBaseIsSelect+","+theIsSamePage+","+QtnListArray[questionID].isNeg+",\'"+theOriValue+"\')";' . "\r\n" . '	if( QuestionCon != \'\' )' . "\r\n" . '	{' . "\r\n" . '		check_survey_conditions_list += "\\tif("+QuestionCon+" && "+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').show();\\n\\t} \\n";' . "\r\n" . '		check_survey_conditions_list += "\\telse { \\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').hide();\\n\\t} \\n";' . "\r\n" . '' . "\r\n" . '		check_form_list = "\\tif("+QuestionCon+" && "+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '		check_form_list += check_survey_form_no_con_list;' . "\r\n" . '		check_form_list += "\\t}\\n";' . "\r\n" . '		//移除已回复的值' . "\r\n" . '		check_form_list += "\\telse{\\n";' . "\r\n" . '		check_form_list += remove_value_list;' . "\r\n" . '		check_form_list += "\\t}\\n";    ' . "\r\n" . '		check_survey_form_list += check_form_list;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		check_survey_conditions_list += "\\tif("+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').show();\\n\\t} \\n";' . "\r\n" . '		check_survey_conditions_list += "\\telse { \\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').hide();\\n\\t} \\n";' . "\r\n" . '		if( check_survey_form_no_con_list != \'\' )' . "\r\n" . '		{' . "\r\n" . '			check_form_list = "\\tif("+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '			check_form_list += check_survey_form_no_con_list;' . "\r\n" . '			check_form_list += "\\t}\\n";' . "\r\n" . '			check_survey_form_list += check_form_list;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//选项生成' . "\r\n" . '	if( QtnListArray[questionID].isSelect != 0 )   //开放回复' . "\r\n" . '	{' . "\r\n" . '		if( count(theBaseQtnArray) != 0 && ! IsSamePage(questionID,theBaseID) )  //不在同页' . "\r\n" . '		{' . "\r\n" . '			theOptionAutoIDList = substr(theOptionAutoIDList,0,-1);' . "\r\n" . '			theOriValue = \',\'+theOriValue+\',\';' . "\r\n" . '			if( QtnListArray[questionID].isSelect == 1 )' . "\r\n" . '			{' . "\r\n" . '				if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingOpenNoSamePageIsNeg("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingOpenNoSamePage("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingSliderNoSamePageIsNeg("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingSliderNoSamePage("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else   //同页' . "\r\n" . '		{' . "\r\n" . '			var theBaseIsSelect = (count(theBaseQtnArray)==0) ? 0 : theBaseQtnArray.isSelect;' . "\r\n" . '			if( QtnListArray[questionID].isSelect == 1 )' . "\r\n" . '			{' . "\r\n" . '				if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingOpenSamePageIsNeg("+theBaseID+","+theBaseIsSelect+","+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingOpenSamePage("+theBaseID+","+theBaseIsSelect+","+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingSliderSamePageIsNeg("+theBaseID+","+theBaseIsSelect+","+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_conditions_list += "\\tgetAutoRatingSliderSamePage("+theBaseID+","+theBaseIsSelect+","+questionID+");\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else //刻度' . "\r\n" . '	{' . "\r\n" . '		if( count(theBaseQtnArray) != 0 && ! IsSamePage(questionID,theBaseID) )  //不在同页' . "\r\n" . '		{' . "\r\n" . '			theOptionAutoIDList = substr(theOptionAutoIDList,0,-1);' . "\r\n" . '			theOriValue = \',\'+theOriValue+\',\';' . "\r\n" . '			if( Trim(QtnListArray[questionID].unitText) == \'\' ) ' . "\r\n" . '			{' . "\r\n" . '				var isHaveUnitText = 0;' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				var isHaveUnitText = 1;' . "\r\n" . '			}' . "\r\n" . '			if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '			{' . "\r\n" . '				check_survey_conditions_list += "\\tgetAutoRatingNoSamePageIsNeg("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+","+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+","+theFirstID+","+theLastID+","+isHaveOther+","+QtnListArray[questionID].isHaveUnkown+","+isHaveUnitText+");\\n";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				check_survey_conditions_list += "\\tgetAutoRatingNoSamePage("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+","+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+","+theFirstID+","+theLastID+","+isHaveOther+","+QtnListArray[questionID].isHaveUnkown+","+isHaveUnitText+");\\n";' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else   //同页' . "\r\n" . '		{' . "\r\n" . '			if( Trim(QtnListArray[questionID].unitText) == \'\' ) ' . "\r\n" . '			{' . "\r\n" . '				var isHaveUnitText = 0;' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				var isHaveUnitText = 1;' . "\r\n" . '			}' . "\r\n" . '			var theBaseIsSelect = (count(theBaseQtnArray)==0) ? 0 : theBaseQtnArray.isSelect;' . "\r\n" . '			if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '			{' . "\r\n" . '				check_survey_conditions_list += "\\tgetAutoRatingSamePageIsNeg("+theBaseID+","+theBaseIsSelect+","+questionID+","+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+","+theFirstID+","+theLastID+","+isHaveOther+","+QtnListArray[questionID].isHaveUnkown+","+isHaveUnitText+");\\n";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				check_survey_conditions_list += "\\tgetAutoRatingSamePage("+theBaseID+","+theBaseIsSelect+","+questionID+","+QtnListArray[questionID].startScale+","+QtnListArray[questionID].endScale+","+theFirstID+","+theLastID+","+isHaveOther+","+QtnListArray[questionID].isHaveUnkown+","+isHaveUnitText+");\\n";' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	check_survey_conditions_list += the_check_survey_conditions_list;' . "\r\n" . '' . "\r\n" . '	switch(QtnListArray[questionID].isSelect)' . "\r\n" . '	{' . "\r\n" . '		case 0:  //刻度' . "\r\n" . '			//改变背景颜色' . "\r\n" . '			check_survey_conditions_list += "\\tchangeMaskingRatingBgColor("+questionID+");\\n";' . "\r\n" . '		break;' . "\r\n" . '		default:' . "\r\n" . '			check_survey_conditions_list += "\\tchangeMaskingSingleQtnBgColor("+questionID+");\\n";' . "\r\n" . '		break;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//关联关系' . "\r\n" . '	var RelSurveyCon = _GetSurveyValueRelationCond(questionID,qid,\'cn\');' . "\r\n" . '	if( RelSurveyCon != \'\' )' . "\r\n" . '	{' . "\r\n" . '		//此题存在多个数值关联关系的检查点' . "\r\n" . '		var theRelSurveyCon = RelSurveyCon.split(\'$$$$$$\');' . "\r\n" . '		for( var t in theRelSurveyCon )' . "\r\n" . '		{' . "\r\n" . '			var tRelSurveyCon = theRelSurveyCon[t].split(\'######\');' . "\r\n" . '			if( parseInt(tRelSurveyCon[0]) == 2 ) //空题' . "\r\n" . '			{' . "\r\n" . '				survey_empty_list += tRelSurveyCon[1];' . "\r\n" . '				var theEmptyList = tRelSurveyCon[1].split(\'*\');' . "\r\n" . '				var theEmptyId = parseInt(substr(theEmptyList[7],0,-3));' . "\r\n" . '				if( !IsSamePage(theEmptyId,questionID)) //不在同页' . "\r\n" . '				{' . "\r\n" . '					//空题字段' . "\r\n" . '					this_fields_list += \'option_\'+theEmptyId+\'|\';' . "\r\n" . '					this_fields_type += \'3|\';' . "\r\n" . '					//跑一遍空题的配额表达式' . "\r\n" . '					var theEmptyEndSurveyCon = _GetSurveyQuotaCond(theEmptyId,qid,\'cn\');' . "\r\n" . '					if( theEmptyEndSurveyCon != \'\' )' . "\r\n" . '					{' . "\r\n" . '						survey_quota_list += theEmptyEndSurveyCon;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				theEmptyList = null;' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				survey_quota_list += tRelSurveyCon[1];' . "\r\n" . '			}' . "\r\n" . '			tRelSurveyCon = null;' . "\r\n" . '		}' . "\r\n" . '		theRelSurveyCon = null;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//问卷结束条件' . "\r\n" . '	var EndSurveyCon = _GetSurveyQuotaCond(questionID,qid,\'cn\');' . "\r\n" . '	if( EndSurveyCon != \'\' )' . "\r\n" . '	{' . "\r\n" . '		survey_quota_list += EndSurveyCon;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '    var jsondata = eval(\'(\'+dataqtn+\')\');' . "\r\n" . '	var t = new jSmart(tplText);' . "\r\n" . '	//$(\'#survey_content_container\').append( t.fetch(jsondata)); ' . "\r\n" . '    survey_content_container_html += t.fetch(jsondata);' . "\r\n" . '    jsondata = null;' . "\r\n" . '	optionAutoArray = null;' . "\r\n" . '	theBaseQtnArray = null;' . "\r\n" . '	theCheckBoxListArray = null;' . "\r\n" . '	optionMinMaxArray = null;' . "\r\n" . '}' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRatingSamePage(baseID,isList,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther,isHaveUnkown,isHaveUnitText)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(j=endScale;j>=startScale;j--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+\'_\'+j+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						if( isHaveUnkown == 1 )' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+\'_\'+99+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						//理由' . "\r\n" . '						theTextObj = eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '						if(theTextObj != null ) theTextObj.value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(k=endScale;k>=startScale;k--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField[i].value+"_"+k+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						if( isHaveUnkown == 1 )' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField[i].value+"_"+99+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						//理由' . "\r\n" . '						theTextObj = eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '						if(theTextObj != null ) theTextObj.value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '		//判断刻度是否显示' . "\r\n" . '		var isHaveShow = false;' . "\r\n" . '		for(m=theFirstID;m<=theLastID;m++)' . "\r\n" . '		{' . "\r\n" . '		   theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+m+"\')");' . "\r\n" . '		   if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		   {' . "\r\n" . '				isHaveShow = true;' . "\r\n" . '				break;' . "\r\n" . '		   }' . "\r\n" . '	    }' . "\r\n" . '		//有其他项' . "\r\n" . '		if( isHaveOther == 1 )' . "\r\n" . '		{' . "\r\n" . '		   theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		   if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		   {' . "\r\n" . '				isHaveShow = true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '		var theTextObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '		var theTitleObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_title"+"\')");' . "\r\n" . '		if( isHaveShow == true )' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'\';' . "\r\n" . '			if( isHaveUnitText == 1 ) //有显示文本' . "\r\n" . '			{' . "\r\n" . '				theTitleObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theTitleObj.style.display = \'none\';' . "\r\n" . '			}				' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'none\';' . "\r\n" . '			theTitleObj.style.display = \'none\';' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRatingOpenSamePage(baseID,isList,questionID)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						//理由' . "\r\n" . '						eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						//理由' . "\r\n" . '						eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRatingNoSamePage(baseID,theAllValue,theSelectValue,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther,isHaveUnkown,isHaveUnitText)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i] + ",") == -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				for(j=endScale;j>=startScale;j--)' . "\r\n" . '				{' . "\r\n" . '				   theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+\'_\'+j+"\')");' . "\r\n" . '				   if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '				}' . "\r\n" . '				if( isHaveUnkown == 1 )' . "\r\n" . '				{' . "\r\n" . '					theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+\'_\'+99+"\')");' . "\r\n" . '					if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '				}' . "\r\n" . '				' . "\r\n" . '				//理由' . "\r\n" . '				theTextObj = eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '				if(theTextObj != null ) theTextObj.value = \'\';' . "\r\n" . '				eval("document.getElementById(\'TextInput_"+questionID+"_"+theAllValueArray[i]+"\')").style.display = \'none\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//判断刻度是否显示' . "\r\n" . '	var isHaveShow = false;' . "\r\n" . '	for(i=theFirstID;i<=theLastID;i++)' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+i+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '			break;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var theTextObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '	var theTitleObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_title"+"\')");' . "\r\n" . '	if( isHaveShow == true )' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'\';' . "\r\n" . '		if( isHaveUnitText == 1 ) //有显示文本' . "\r\n" . '		{' . "\r\n" . '			theTitleObj.style.display = \'\';' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theTitleObj.style.display = \'none\';' . "\r\n" . '		}				' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'none\';' . "\r\n" . '		theTitleObj.style.display = \'none\';' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRatingOpenNoSamePage(baseID,theAllValue,theSelectValue,questionID)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+ theAllValueArray[i] + ",") == -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				eval("document.getElementById(\'option_"+questionID+"_"+theAllValueArray[i]+"\')").value = \'\';' . "\r\n" . '				//理由' . "\r\n" . '				eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+theAllValueArray[i]+"\')").value = \'\';' . "\r\n" . '				eval("document.getElementById(\'TextInput_"+questionID+"_"+theAllValueArray[i]+"\')").style.display = \'none\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRatingSliderSamePage(baseID,isList,questionID)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'0\';' . "\r\n" . '						//theSliderVar = "#option_"+questionID+"_"+objField[i].value;' . "\r\n" . '						//jQuery(theSliderVar).slider(\'value\', 0 );' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRatingSliderNoSamePage(baseID,theAllValue,theSelectValue,questionID)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+ theAllValueArray[i] + ",") == -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				eval("document.getElementById(\'option_"+questionID+"_"+theAllValueArray[i]+"\')").value = \'0\';' . "\r\n" . '				//theSliderVar = "#option_"+questionID+"_"+theAllValueArray[i]' . "\r\n" . '				//jQuery(theSliderVar).slider(\'value\', 0 );' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '//以下为未选择项的生成' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRatingSamePageIsNeg(baseID,isList,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther,isHaveUnkown,isHaveUnitText)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected != true && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(j=endScale;j>=startScale;j--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+\'_\'+j+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						if( isHaveUnkown == 1 )' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+\'_\'+99+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						//理由' . "\r\n" . '						theTextObj = eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '						if(theTextObj != null ) theTextObj.value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked != true )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(k=endScale;k>=startScale;k--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField[i].value+"_"+k+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						if( isHaveUnkown == 1 )' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+objField[i].value+"_"+99+"\')");' . "\r\n" . '							if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						}' . "\r\n" . '						//理由' . "\r\n" . '						theTextObj = eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '						if(theTextObj != null ) theTextObj.value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '		//判断刻度是否显示' . "\r\n" . '		var isHaveShow = false;' . "\r\n" . '		for(m=theFirstID;m<=theLastID;m++)' . "\r\n" . '		{' . "\r\n" . '		   theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+m+"\')");' . "\r\n" . '		   if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		   {' . "\r\n" . '				isHaveShow = true;' . "\r\n" . '				break;' . "\r\n" . '		   }' . "\r\n" . '	    }' . "\r\n" . '		//有其他项' . "\r\n" . '		if( isHaveOther == 1 )' . "\r\n" . '		{' . "\r\n" . '		   theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		   if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		   {' . "\r\n" . '				isHaveShow = true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '		var theTextObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '		var theTitleObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_title"+"\')");' . "\r\n" . '		if( isHaveShow == true )' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'\';' . "\r\n" . '			if( isHaveUnitText == 1 ) //有显示文本' . "\r\n" . '			{' . "\r\n" . '				theTitleObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theTitleObj.style.display = \'none\';' . "\r\n" . '			}				' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'none\';' . "\r\n" . '			theTitleObj.style.display = \'none\';' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRatingOpenSamePageIsNeg(baseID,isList,questionID)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected != true && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						//理由' . "\r\n" . '						eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked != true )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						//理由' . "\r\n" . '						eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '						eval("document.getElementById(\'TextInput_"+questionID+"_"+objField[i].value+"\')").style.display = \'none\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRatingNoSamePageIsNeg(baseID,theAllValue,theSelectValue,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther,isHaveUnkown,isHaveUnitText)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i] + ",") != -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				for(j=endScale;j>=startScale;j--)' . "\r\n" . '				{' . "\r\n" . '				   theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+\'_\'+j+"\')");' . "\r\n" . '				   if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '				}' . "\r\n" . '				if( isHaveUnkown == 1 )' . "\r\n" . '				{' . "\r\n" . '					theInputObj = eval("document.getElementById(\'ratingcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+\'_\'+99+"\')");' . "\r\n" . '					if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '				}' . "\r\n" . '				' . "\r\n" . '				//理由' . "\r\n" . '				theTextObj = eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '				if(theTextObj != null ) theTextObj.value = \'\';' . "\r\n" . '				eval("document.getElementById(\'TextInput_"+questionID+"_"+theAllValueArray[i]+"\')").style.display = \'none\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//判断刻度是否显示' . "\r\n" . '	var isHaveShow = false;' . "\r\n" . '	for(i=theFirstID;i<=theLastID;i++)' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+i+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '			break;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var theTextObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '	var theTitleObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_title"+"\')");' . "\r\n" . '	if( isHaveShow == true )' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'\';' . "\r\n" . '		if( isHaveUnitText == 1 ) //有显示文本' . "\r\n" . '		{' . "\r\n" . '			theTitleObj.style.display = \'\';' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theTitleObj.style.display = \'none\';' . "\r\n" . '		}				' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'none\';' . "\r\n" . '		theTitleObj.style.display = \'none\';' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRatingOpenNoSamePageIsNeg(baseID,theAllValue,theSelectValue,questionID)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+ theAllValueArray[i] + ",") != -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				eval("document.getElementById(\'option_"+questionID+"_"+theAllValueArray[i]+"\')").value = \'\';' . "\r\n" . '				//理由' . "\r\n" . '				eval("document.getElementById(\'TextOtherValue_"+questionID+"_"+theAllValueArray[i]+"\')").value = \'\';' . "\r\n" . '				eval("document.getElementById(\'TextInput_"+questionID+"_"+theAllValueArray[i]+"\')").style.display = \'none\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRatingSliderSamePageIsNeg(baseID,isList,questionID)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected != true && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'\';' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked != true )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						eval("document.getElementById(\'option_"+questionID+"_"+objField[i].value+"\')").value = \'0\';' . "\r\n" . '						//theSliderVar = "#option_"+questionID+"_"+objField[i].value;' . "\r\n" . '						//jQuery(theSliderVar).slider(\'value\', 0 );' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRatingSliderNoSamePageIsNeg(baseID,theAllValue,theSelectValue,questionID)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'rating_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+ theAllValueArray[i] + ",") != -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				eval("document.getElementById(\'option_"+questionID+"_"+theAllValueArray[i]+"\')").value = \'0\';' . "\r\n" . '				//theSliderVar = "#option_"+questionID+"_"+theAllValueArray[i]' . "\r\n" . '				//jQuery(theSliderVar).slider(\'value\', 0 );' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '';

?>
