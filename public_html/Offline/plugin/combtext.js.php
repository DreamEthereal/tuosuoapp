<?php
//dezend by http://www.yunlu99.com/
echo '//复合单选' . "\r\n" . 'function create_combtext_qtn(questionID)' . "\r\n" . '{' . "\r\n" . '	var theInfoQtnName = qNoScriptString(QtnListArray[questionID].questionName);' . "\r\n" . '' . "\r\n" . '	var questionName = \'\';' . "\r\n" . '	var questionNotes = \'\';' . "\r\n" . '	var questionName = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionName));' . "\r\n" . '	var questionNotes = \'[组合填空题]\';' . "\r\n" . '' . "\r\n" . '    var dataqtn = "{ ";' . "\r\n" . '    dataqtn += " questionID: "+questionID+",";' . "\r\n" . '    dataqtn += " questionName: \'"+qShowQtnName(questionName,questionID,1)+"\',";' . "\r\n" . '    dataqtn += " questionNotes: \'"+questionNotes+"\',";' . "\r\n" . '	questionTips = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionNotes));' . "\r\n" . '    dataqtn += " questionTips: \'"+qShowQtnName(questionTips,questionID,2)+"\',";' . "\r\n" . '' . "\r\n" . '	var check_survey_form_no_con_list = \'\';' . "\r\n" . '	var remove_value_list = \'\';' . "\r\n" . '' . "\r\n" . '  	if( QtnListArray[questionID].isHaveUnkown == 2 )  //不清楚' . "\r\n" . '	{' . "\r\n" . '		dataqtn += " qtns:[ ";' . "\r\n" . '		var theRowsNum=1;' . "\r\n" . '		for( var question_yesnoID in YesNoListArray[questionID] )' . "\r\n" . '		{' . "\r\n" . '			var theQuestionArray = YesNoListArray[questionID][question_yesnoID];' . "\r\n" . '			dataqtn += "{";' . "\r\n" . '			dataqtn += " optionNameID:\'"+question_yesnoID+"\', ";' . "\r\n" . '			dataqtn += " optionName:\'"+qJsonCharFilter(theQuestionArray.optionName)+"\', ";' . "\r\n" . '			dataqtn += " optionID:\'option_"+questionID+\'_\'+question_yesnoID+"\', ";' . "\r\n" . '			dataqtn += " length:\'"+theQuestionArray.optionSize+"\', ";' . "\r\n" . '			switch( theQuestionArray.isCheckType )' . "\r\n" . '			{' . "\r\n" . '				case 4:' . "\r\n" . '					if( typeof theQuestionArray.unitText == \'undefined\' )' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " unitText:\'\',";' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " unitText:\'"+qJsonCharFilter(theQuestionArray.unitText)+"\',";' . "\r\n" . '					}' . "\r\n" . '				break;' . "\r\n" . '				default:' . "\r\n" . '					dataqtn += " unitText:\'\',";' . "\r\n" . '				break;' . "\r\n" . '			}' . "\r\n" . '			if( theRowsNum % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " bgcolor: \'#ffffff\',";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " bgcolor: \'#f5f5f5\',";' . "\r\n" . '			}' . "\r\n" . '			theRowsNum++;' . "\r\n" . '			if( count(dataRow.rows) != 0 )' . "\r\n" . '			{' . "\r\n" . '				if( parseInt(dataRow.rows[0][dataIndex[\'isHaveUnkown_\'+questionID+\'_\'+question_yesnoID]]) == 1 )  //不清楚' . "\r\n" . '				{' . "\r\n" . '					dataqtn += " isHaveUnkown0:\'\',";' . "\r\n" . '					dataqtn += " isHaveUnkown1:\'checked\',";' . "\r\n" . '					dataqtn += " value:\'\',";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					dataqtn += " isHaveUnkown0:\'checked\',";' . "\r\n" . '					dataqtn += " isHaveUnkown1:\'\',";' . "\r\n" . '					dataqtn += " value:\'"+qhtmlspecialchars(dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+question_yesnoID]])+"\',";' . "\r\n" . '				}					' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " isHaveUnkown0:\'checked\',";' . "\r\n" . '				dataqtn += " isHaveUnkown1:\'\',";' . "\r\n" . '				dataqtn += " value:\'\',";' . "\r\n" . '			}' . "\r\n" . '			switch( theQuestionArray.isCheckType )' . "\r\n" . '		    {' . "\r\n" . '				case 4:  //数值' . "\r\n" . '				case 8:  //企业法人代码' . "\r\n" . '				case 9:  //邮政编码' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'number\',";' . "\r\n" . '				break;' . "\r\n" . '				case 5:  //电话' . "\r\n" . '				case 11:  //手机' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'tel\',";' . "\r\n" . '				break;' . "\r\n" . '				case 6:  //日期' . "\r\n" . '					var datePrompt = " onclick=\\"javascript:seldate(this)\\" ";' . "\r\n" . '					dataqtn += " datePrompt:\'"+datePrompt+"\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'text\',";' . "\r\n" . '				break;' . "\r\n" . '				case 13:  //时间' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'time\',";' . "\r\n" . '				break;' . "\r\n" . '				default:' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'text\',";' . "\r\n" . '				break;' . "\r\n" . '		    }' . "\r\n" . '' . "\r\n" . '			//处理页面字段' . "\r\n" . '			this_fields_list += \'option_\'+questionID+\'_\'+question_yesnoID+\'|\';' . "\r\n" . '			this_fields_type += \'3|\';' . "\r\n" . '			this_fields_list += \'isHaveUnkown_\'+questionID+\'_\'+question_yesnoID+\'|\';' . "\r\n" . '			this_fields_type += \'1|\';' . "\r\n" . '' . "\r\n" . '			//查重' . "\r\n" . '			if( theQuestionArray.isNeg == 1 )' . "\r\n" . '			{' . "\r\n" . '				this_check_list += \'23*option_\'+questionID+\'_\'+question_yesnoID+\'|\';' . "\r\n" . '			}' . "\r\n" . '			' . "\r\n" . '			//记录移除值' . "\r\n" . '			var theObjField = \'option_\'+questionID+\'_\'+question_yesnoID;' . "\r\n" . '			remove_value_list +="\\tRadioUnClick(document.Survey_Form.isHaveUnkown_"+questionID+\'_\'+question_yesnoID+");\\n";' . "\r\n" . '			remove_value_list +="\\tTextUnInput(document.Survey_Form."+theObjField+");\\n";' . "\r\n" . '' . "\r\n" . '			//处理提交检查' . "\r\n" . '			var theObjFieldName = theInfoQtnName+\' - \'+qNoScriptString(theQuestionArray.optionName);' . "\r\n" . '' . "\r\n" . '			check_survey_conditions_list += "\\tif ( typeof document.Survey_Form.isHaveUnkown_"+questionID+"_"+question_yesnoID+" != \'undefined\' && document.Survey_Form.isHaveUnkown_"+questionID+"_"+question_yesnoID+"[1].checked )\\n\\t{\\n ";' . "\r\n" . '			check_survey_conditions_list += "\\t\\tTextUnInput(document.Survey_Form."+theObjField+");\\n\\t}\\n";' . "\r\n" . '' . "\r\n" . '			check_survey_form_no_con_list += "\\tif (!CheckRadioNoClick(document.Survey_Form.isHaveUnkown_"+questionID+"_"+question_yesnoID+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '			check_survey_form_no_con_list += "\\tif (typeof document.Survey_Form.isHaveUnkown_"+questionID+"_"+question_yesnoID+" != \'undefined\' && document.Survey_Form.isHaveUnkown_"+questionID+"_"+question_yesnoID+"[0].checked )\\n\\t{\\n ";' . "\r\n" . '' . "\r\n" . '			if( theQuestionArray.isRequired == 1 )' . "\r\n" . '			{' . "\r\n" . '				check_survey_form_no_con_list += "\\tif (!CheckNotNull(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				dataqtn += " questionRequire:\'<span class=red>*</span>\' ";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " questionRequire:\'\' ";' . "\r\n" . '			}' . "\r\n" . '			dataqtn += "},";' . "\r\n" . '' . "\r\n" . '			switch( theQuestionArray.isCheckType )' . "\r\n" . '			{' . "\r\n" . '				case 1:  //Email' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckEmail(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 2:  //长度' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckStringLength(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\',"+theQuestionArray.minOption+","+theQuestionArray.maxOption+")){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 3:  //中文' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckNoChinese(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 4:  //数值' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckIsValue(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\',"+theQuestionArray.minOption+","+theQuestionArray.maxOption+")){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 5:  //电话' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckPhone(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 6:  //日期' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckDate(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 7:  //身份证' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckIDCardNo(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 8:  //企业法人代码' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckCorpCode(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 9:  //邮政编码' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckPostalCode(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 10:  //URL' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckURL(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 11:  //手机' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckMobile(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 12:  //中文' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckChinese(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 13:  //时间' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckTime(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '			}' . "\r\n" . '			check_survey_form_no_con_list += "\\t}\\n";' . "\r\n" . '			check_survey_form_no_con_list += "\\telse\\n\\t{\\n\\t\\tTextUnInput(document.Survey_Form."+theObjField+");\\n\\t}\\n";' . "\r\n" . '		}' . "\r\n" . '		dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '		var jsondata = eval(\'(\'+dataqtn+\')\');' . "\r\n" . '' . "\r\n" . '		//逻辑条件' . "\r\n" . '		var QuestionCon = _GetQuestionCond(questionID,qid);' . "\r\n" . '		if( QuestionCon != \'\' )' . "\r\n" . '		{' . "\r\n" . '			check_survey_conditions_list += "\\tif("+QuestionCon+")\\n\\t{\\n";' . "\r\n" . '			check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').show();\\n\\t} \\n";' . "\r\n" . '			check_survey_conditions_list += "\\telse { \\n";' . "\r\n" . '			check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').hide();\\n\\t} \\n";' . "\r\n" . '' . "\r\n" . '			var check_form_list = "\\tif("+QuestionCon+")\\n\\t{\\n";' . "\r\n" . '			check_form_list += check_survey_form_no_con_list;' . "\r\n" . '			check_form_list += "\\t}\\n";' . "\r\n" . '			//移除已回复的值' . "\r\n" . '			check_form_list += "\\telse{\\n";' . "\r\n" . '			check_form_list += remove_value_list;' . "\r\n" . '			check_form_list += "\\t}\\n";' . "\r\n" . '' . "\r\n" . '			check_survey_form_list += check_form_list;' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			check_survey_form_list += check_survey_form_no_con_list;' . "\r\n" . '		}' . "\r\n" . '' . "\r\n" . '		//关联关系' . "\r\n" . '		var RelSurveyCon = _GetSurveyValueRelationCond(questionID,qid,\'cn\');' . "\r\n" . '		if( RelSurveyCon != \'\' )' . "\r\n" . '		{' . "\r\n" . '			//此题存在多个数值关联关系的检查点' . "\r\n" . '			var theRelSurveyCon = RelSurveyCon.split(\'$$$$$$\');' . "\r\n" . '			for( var t in theRelSurveyCon )' . "\r\n" . '			{' . "\r\n" . '				var tRelSurveyCon = theRelSurveyCon[t].split(\'######\');' . "\r\n" . '				if( parseInt(tRelSurveyCon[0]) == 2 ) //空题' . "\r\n" . '				{' . "\r\n" . '					survey_empty_list += tRelSurveyCon[1];' . "\r\n" . '					var theEmptyList = tRelSurveyCon[1].split(\'*\');' . "\r\n" . '					var theEmptyId = parseInt(substr(theEmptyList[7],0,-3));' . "\r\n" . '					if( !IsSamePage(theEmptyId,questionID)) //不在同页' . "\r\n" . '					{' . "\r\n" . '						//空题字段' . "\r\n" . '						this_fields_list += \'option_\'+theEmptyId+\'|\';' . "\r\n" . '						this_fields_type += \'3|\';' . "\r\n" . '						//跑一遍空题的配额表达式' . "\r\n" . '						var theEmptyEndSurveyCon = _GetSurveyQuotaCond(theEmptyId,qid,\'cn\');' . "\r\n" . '						if( theEmptyEndSurveyCon != \'\' )' . "\r\n" . '						{' . "\r\n" . '							survey_quota_list += theEmptyEndSurveyCon;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					theEmptyList = null;' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					survey_quota_list += tRelSurveyCon[1];' . "\r\n" . '				}' . "\r\n" . '				tRelSurveyCon = null;' . "\r\n" . '			}' . "\r\n" . '			theRelSurveyCon = null;' . "\r\n" . '		}' . "\r\n" . '' . "\r\n" . '		//问卷结束条件' . "\r\n" . '		var EndSurveyCon = _GetSurveyQuotaCond(questionID,qid,\'cn\');' . "\r\n" . '		if( EndSurveyCon != \'\' )' . "\r\n" . '		{' . "\r\n" . '			survey_quota_list += EndSurveyCon;' . "\r\n" . '		}' . "\r\n" . '' . "\r\n" . '		var tplText = \'<table width="100%" class="pertable" id="question_{$questionID}"><tr><td class="question" valign=center>&nbsp;<span class="textEdit" id="questionName_{$questionID}">{$questionName}</span>&nbsp;<span class=notes>{$questionNotes}</span></td></tr><tr><td class="tips"><span class="textEdit" id="questionNotes_{$questionID}">{$questionTips}</span></td></tr><tr><td><table cellSpacing=0 cellPadding=0 width=100%>{foreach $qtns as $i => $qtn}<tr class=tdheight valign=center bgcolor="{$qtn.bgcolor}"><td width=8></td><td class="answer" nowrap><span class="textEdit" id="optionName_23_{$questionID}_{$qtn.optionNameID}">{$qtn.optionName}</span>&nbsp;{$qtn.questionRequire}</td><td nowrap class="answer">&nbsp;&nbsp;<input name="isHaveUnkown_{$questionID}_{$qtn.optionNameID}" id="isHaveUnkown_{$questionID}_{$qtn.optionNameID}" type=radio value=0 {$qtn.isHaveUnkown0}>&nbsp;<input type="{$qtn.inputPrompt}" name="{$qtn.optionID}" id="{$qtn.optionID}" size="{$qtn.length}" value="{$qtn.value}" {$qtn.datePrompt}>&nbsp;{$qtn.unitText}</td><td nowrap>&nbsp;&nbsp;<input onclick="jQuery.Check_Survey_Conditions()" name="isHaveUnkown_{$questionID}_{$qtn.optionNameID}" id="isHaveUnkown_{$questionID}_{$qtn.optionNameID}" value=1 type=radio {$qtn.isHaveUnkown1}>&nbsp;<span class="answer">不清楚</span></td><td width=90%></td></tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '	}' . "\r\n" . '	else  //无不清楚' . "\r\n" . '	{' . "\r\n" . '		dataqtn += " qtns:[ ";' . "\r\n" . '		var theRowsNum=1;' . "\r\n" . '		for( var question_yesnoID in YesNoListArray[questionID] )' . "\r\n" . '		{' . "\r\n" . '			var theQuestionArray = YesNoListArray[questionID][question_yesnoID];' . "\r\n" . '			dataqtn += "{";' . "\r\n" . '			dataqtn += " optionNameID:\'"+question_yesnoID+"\', ";' . "\r\n" . '			dataqtn += " optionName:\'"+qJsonCharFilter(theQuestionArray.optionName)+"\', ";' . "\r\n" . '			dataqtn += " optionID:\'option_"+questionID+\'_\'+question_yesnoID+"\', ";' . "\r\n" . '			dataqtn += " length:\'"+theQuestionArray.optionSize+"\', ";' . "\r\n" . '			switch( theQuestionArray.isCheckType )' . "\r\n" . '			{' . "\r\n" . '				case 4:' . "\r\n" . '					if( typeof theQuestionArray.unitText == \'undefined\' )' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " unitText:\'\',";' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						dataqtn += " unitText:\'"+qJsonCharFilter(theQuestionArray.unitText)+"\',";' . "\r\n" . '					}' . "\r\n" . '				break;' . "\r\n" . '				default:' . "\r\n" . '					dataqtn += " unitText:\'\',";' . "\r\n" . '				break;' . "\r\n" . '			}' . "\r\n" . '			if( theRowsNum % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " bgcolor: \'#ffffff\',";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " bgcolor: \'#f5f5f5\',";' . "\r\n" . '			}' . "\r\n" . '			theRowsNum++;' . "\r\n" . '			if( count(dataRow.rows) != 0 )' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " value:\'"+qhtmlspecialchars(dataRow.rows[0][dataIndex[\'option_\'+questionID+\'_\'+question_yesnoID]])+"\',";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " value:\'\',";' . "\r\n" . '			}' . "\r\n" . '			switch( theQuestionArray.isCheckType )' . "\r\n" . '		    {' . "\r\n" . '				case 4:  //数值' . "\r\n" . '				case 8:  //企业法人代码' . "\r\n" . '				case 9:  //邮政编码' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'number\',";' . "\r\n" . '				break;' . "\r\n" . '				case 5:  //电话' . "\r\n" . '				case 11:  //手机' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'tel\',";' . "\r\n" . '				break;' . "\r\n" . '				case 6:  //日期' . "\r\n" . '					var datePrompt = " onclick=\\"javascript:seldate(this)\\" ";' . "\r\n" . '					dataqtn += " datePrompt:\'"+datePrompt+"\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'text\',";' . "\r\n" . '				break;' . "\r\n" . '				case 13:  //时间' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'time\',";' . "\r\n" . '				break;' . "\r\n" . '				default:' . "\r\n" . '					dataqtn += " datePrompt:\'\',";' . "\r\n" . '					dataqtn += " inputPrompt:\'text\',";' . "\r\n" . '				break;' . "\r\n" . '		    }' . "\r\n" . '' . "\r\n" . '			//处理页面字段' . "\r\n" . '			this_fields_list += \'option_\'+questionID+\'_\'+question_yesnoID+\'|\';' . "\r\n" . '			this_fields_type += \'3|\';' . "\r\n" . '' . "\r\n" . '			//查重' . "\r\n" . '			if( theQuestionArray.isNeg == 1 )' . "\r\n" . '			{' . "\r\n" . '				this_check_list += \'23*option_\'+questionID+\'_\'+question_yesnoID+\'|\';' . "\r\n" . '			}' . "\r\n" . '			' . "\r\n" . '			//记录移除值' . "\r\n" . '			var theObjField = \'option_\'+questionID+\'_\'+question_yesnoID;' . "\r\n" . '			remove_value_list +="\\tTextUnInput(document.Survey_Form."+theObjField+");\\n";' . "\r\n" . '' . "\r\n" . '			//处理提交检查' . "\r\n" . '			var theObjFieldName = theInfoQtnName+\' - \'+qNoScriptString(theQuestionArray.optionName);' . "\r\n" . '			if( theQuestionArray.isRequired == 1 )' . "\r\n" . '			{' . "\r\n" . '				check_survey_form_no_con_list += "\\tif (!CheckNotNull(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				dataqtn += " questionRequire:\'<span class=red>*</span>\' ";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				dataqtn += " questionRequire:\'\' ";' . "\r\n" . '			}' . "\r\n" . '			dataqtn += "},";' . "\r\n" . '' . "\r\n" . '			switch( theQuestionArray.isCheckType )' . "\r\n" . '			{' . "\r\n" . '				case 1:  //Email' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckEmail(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 2:  //长度' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckStringLength(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\',"+theQuestionArray.minOption+","+theQuestionArray.maxOption+")){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 3:  //中文' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckNoChinese(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 4:  //数值' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckIsValue(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\',"+theQuestionArray.minOption+","+theQuestionArray.maxOption+")){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 5:  //电话' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckPhone(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 6:  //日期' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckDate(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 7:  //身份证' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckIDCardNo(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 8:  //企业法人代码' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckCorpCode(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 9:  //邮政编码' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckPostalCode(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 10:  //URL' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckURL(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 11:  //手机' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckMobile(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 12:  //中文' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckChinese(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '				case 13:  //时间' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckTime(document.Survey_Form."+theObjField+", \'"+theObjFieldName+"\')){return false;} \\n";' . "\r\n" . '				break;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '		var jsondata = eval(\'(\'+dataqtn+\')\');' . "\r\n" . '' . "\r\n" . '		//逻辑条件' . "\r\n" . '		var QuestionCon = _GetQuestionCond(questionID,qid);' . "\r\n" . '		if( QuestionCon != \'\' )' . "\r\n" . '		{' . "\r\n" . '			check_survey_conditions_list += "\\tif("+QuestionCon+")\\n\\t{\\n";' . "\r\n" . '			check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').show();\\n\\t} \\n";' . "\r\n" . '			check_survey_conditions_list += "\\telse { \\n";' . "\r\n" . '			check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').hide();\\n\\t} \\n";' . "\r\n" . '' . "\r\n" . '			var check_form_list = "\\tif("+QuestionCon+")\\n\\t{\\n";' . "\r\n" . '			check_form_list += check_survey_form_no_con_list;' . "\r\n" . '			check_form_list += "\\t}\\n";' . "\r\n" . '			//移除已回复的值' . "\r\n" . '			check_form_list += "\\telse{\\n";' . "\r\n" . '			check_form_list += remove_value_list;' . "\r\n" . '			check_form_list += "\\t}\\n";' . "\r\n" . '' . "\r\n" . '			check_survey_form_list += check_form_list;' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			check_survey_form_list += check_survey_form_no_con_list;' . "\r\n" . '		}' . "\r\n" . '' . "\r\n" . '		//关联关系' . "\r\n" . '		var RelSurveyCon = _GetSurveyValueRelationCond(questionID,qid,\'cn\');' . "\r\n" . '		if( RelSurveyCon != \'\' )' . "\r\n" . '		{' . "\r\n" . '			//此题存在多个数值关联关系的检查点' . "\r\n" . '			var theRelSurveyCon = RelSurveyCon.split(\'$$$$$$\');' . "\r\n" . '			for( var t in theRelSurveyCon )' . "\r\n" . '			{' . "\r\n" . '				var tRelSurveyCon = theRelSurveyCon[t].split(\'######\');' . "\r\n" . '				if( parseInt(tRelSurveyCon[0]) == 2 ) //空题' . "\r\n" . '				{' . "\r\n" . '					survey_empty_list += tRelSurveyCon[1];' . "\r\n" . '					var theEmptyList = tRelSurveyCon[1].split(\'*\');' . "\r\n" . '					var theEmptyId = parseInt(substr(theEmptyList[7],0,-3));' . "\r\n" . '					if( !IsSamePage(theEmptyId,questionID)) //不在同页' . "\r\n" . '					{' . "\r\n" . '						//空题字段' . "\r\n" . '						this_fields_list += \'option_\'+theEmptyId+\'|\';' . "\r\n" . '						this_fields_type += \'3|\';' . "\r\n" . '						//跑一遍空题的配额表达式' . "\r\n" . '						var theEmptyEndSurveyCon = _GetSurveyQuotaCond(theEmptyId,qid,\'cn\');' . "\r\n" . '						if( theEmptyEndSurveyCon != \'\' )' . "\r\n" . '						{' . "\r\n" . '							survey_quota_list += theEmptyEndSurveyCon;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					theEmptyList = null;' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					survey_quota_list += tRelSurveyCon[1];' . "\r\n" . '				}' . "\r\n" . '				tRelSurveyCon = null;' . "\r\n" . '			}' . "\r\n" . '			theRelSurveyCon = null;' . "\r\n" . '		}' . "\r\n" . '' . "\r\n" . '		//问卷结束条件' . "\r\n" . '		var EndSurveyCon = _GetSurveyQuotaCond(questionID,qid,\'cn\');' . "\r\n" . '		if( EndSurveyCon != \'\' )' . "\r\n" . '		{' . "\r\n" . '			survey_quota_list += EndSurveyCon;' . "\r\n" . '		}' . "\r\n" . '' . "\r\n" . '		var tplText = \'<table width="100%" class="pertable" id="question_{$questionID}"><tr><td class="question" valign=center>&nbsp;<span class="textEdit" id="questionName_{$questionID}">{$questionName}</span>&nbsp;<span class=notes>{$questionNotes}</span></td></tr><tr><td class="tips"><span class="textEdit" id="questionNotes_{$questionID}">{$questionTips}</span></td></tr><tr><td><table cellSpacing=0 cellPadding=0 width=100%>{foreach $qtns as $i => $qtn}<tr class=tdheight valign=center bgcolor="{$qtn.bgcolor}"><td width=8></td><td class="answer" nowrap width=2% nowrap><span class="textEdit" id="optionName_23_{$questionID}_{$qtn.optionNameID}">{$qtn.optionName}</span>&nbsp;{$qtn.questionRequire}</td><td width=98% class="answer"><input type="{$qtn.inputPrompt}" name="{$qtn.optionID}" id="{$qtn.optionID}" size="{$qtn.length}" value="{$qtn.value}" {$qtn.datePrompt} onblur="jQuery.Check_Survey_Conditions();">&nbsp;{$qtn.unitText}</td></tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '    var t = new jSmart(tplText);' . "\r\n" . '    //$(\'#survey_content_container\').append( t.fetch(jsondata)); ' . "\r\n" . '	survey_content_container_html += t.fetch(jsondata);' . "\r\n" . '	jsondata = null;' . "\r\n" . '	theQuestionArray = null;' . "\r\n" . '}';

?>
