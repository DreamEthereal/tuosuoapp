<?php
//dezend by http://www.yunlu99.com/
echo 'function create_automultipletext_qtn(questionID)' . "\r\n" . '{' . "\r\n" . '	var theInfoQtnName = qNoScriptString(QtnListArray[questionID].questionName);' . "\r\n" . '' . "\r\n" . '	//显示题目' . "\r\n" . '	var check_survey_form_no_con_list = \'\';' . "\r\n" . '	var questionName = \'\';' . "\r\n" . '	var questionNotes = \'\';' . "\r\n" . '	questionName = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionName));' . "\r\n" . '	questionNotes = \'[自动矩阵填空题]\';' . "\r\n" . '' . "\r\n" . '	var dataqtn = "{ ";' . "\r\n" . '    dataqtn += " questionID: "+questionID+",";' . "\r\n" . '    dataqtn += " questionName: \'"+qShowQtnName(questionName,questionID,1)+"\',";' . "\r\n" . '    dataqtn += " questionNotes: \'"+questionNotes+"\',";' . "\r\n" . '    questionTips = qQuotaChar(qJsonCharFilter(QtnListArray[questionID].questionNotes));' . "\r\n" . '    dataqtn += " questionTips: \'"+qShowQtnName(questionTips,questionID,2)+"\',";' . "\r\n" . '' . "\r\n" . '	//来源问题及选项' . "\r\n" . '	var theBaseID = QtnListArray[questionID].baseID;' . "\r\n" . '	var theBaseQtnArray = QtnListArray[theBaseID];' . "\r\n" . '	var theCheckBoxListArray = CheckBoxListArray[theBaseQtnArray.questionID];' . "\r\n" . '' . "\r\n" . '	//来源问题不存在' . "\r\n" . '	if( count(theBaseQtnArray)==0 && QtnListArray[questionID].isRequired == 1)' . "\r\n" . '	{' . "\r\n" . '		check_survey_form_no_con_list += "\\tshowMessage(\'"+theInfoQtnName+"，来源问题不存在或已被删除\');return false;\\n";' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	var optionAutoArray = [];' . "\r\n" . '	var optionMinMaxArray = [];' . "\r\n" . '	var i=0;' . "\r\n" . '	for( var question_checkboxID in theCheckBoxListArray )' . "\r\n" . '	{' . "\r\n" . '		var theQuestionArray = theCheckBoxListArray[question_checkboxID];' . "\r\n" . '		if( theBaseQtnArray.questionType == 3 )' . "\r\n" . '		{' . "\r\n" . '			optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '		}' . "\r\n" . '' . "\r\n" . '		if( theBaseQtnArray.questionType == 25 )  //组合多选' . "\r\n" . '		{' . "\r\n" . '			if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '			{' . "\r\n" . '				if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					if( count(dataRow.rows) != 0 )' . "\r\n" . '					{' . "\r\n" . '						if( typeof dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID] != \'undefined\' && dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]] != \'\' )' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID+\'_\'+question_checkboxID]])+\')\';' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				optionAutoArray[question_checkboxID] = qJsonCharFilter(theQuestionArray.optionName);' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		optionMinMaxArray[i] = question_checkboxID;' . "\r\n" . '		i++;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//来源问题的最大与最少ID值' . "\r\n" . '	var theFirstID = (optionMinMaxArray[0] != \'\') ? optionMinMaxArray[0] : 0;' . "\r\n" . '	var theLastID = (optionMinMaxArray[count(optionMinMaxArray)-1] != \'\' ) ? optionMinMaxArray[count(optionMinMaxArray)-1] :0;' . "\r\n" . '' . "\r\n" . '	//有其他项' . "\r\n" . '	if( theBaseQtnArray.isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '		optionMinMaxArray[i] = 0;' . "\r\n" . '		if( ! IsSamePage(questionID,theBaseID) ) //不同同页' . "\r\n" . '		{' . "\r\n" . '			if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '			{' . "\r\n" . '				optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				if( count(dataRow.rows) != 0 )' . "\r\n" . '				{' . "\r\n" . '					if( dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]] != \'\' )' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText)+\'(\'+qJsonCharFilter(dataRow.rows[0][dataIndex[\'TextOtherValue_\'+theBaseID]])+\')\';' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			optionAutoArray[0] = qJsonCharFilter(theBaseQtnArray.otherText);' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var isHaveOther = (theBaseQtnArray.isHaveOther != \'\' ) ? theBaseQtnArray.isHaveOther : 0;' . "\r\n" . '' . "\r\n" . '    dataqtn += " baseID: \'"+theBaseID+"\',";' . "\r\n" . '' . "\r\n" . '	//得到BaseID原值' . "\r\n" . '	var theBaseValueList = \'\';' . "\r\n" . '	var theOriValue = \'\';' . "\r\n" . '	if( count(dataRow.rows) != 0 )' . "\r\n" . '	{' . "\r\n" . '		if( dataRow.rows[0][dataIndex[\'option_\'+theBaseID]] != \'0\' && dataRow.rows[0][dataIndex[\'option_\'+theBaseID]] != \'\' )' . "\r\n" . '		{' . "\r\n" . '			theOriValue = dataRow.rows[0][dataIndex[\'option_\'+theBaseID]];' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '    theBaseValueList = theOriValue;' . "\r\n" . '' . "\r\n" . '	//展现问题选项' . "\r\n" . '	var theMinOptionID = theFirstID;' . "\r\n" . '	var theMaxOptionID = theLastID;' . "\r\n" . '' . "\r\n" . '	var Label = [];' . "\r\n" . '	var j =0;' . "\r\n" . '	dataqtn += " answers:[";' . "\r\n" . '	for( var question_range_labelID in LabelListArray[questionID] )' . "\r\n" . '	{' . "\r\n" . '		dataqtn += "{";' . "\r\n" . '		var theLabelArray = LabelListArray[questionID][question_range_labelID];' . "\r\n" . '		if( theLabelArray.isRequired == 1 )' . "\r\n" . '		{' . "\r\n" . '			dataqtn += "optionLabelName:\'"+qJsonCharFilter(theLabelArray.optionLabel)+"&nbsp;<span class=red>*</span>\',";' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			dataqtn += "optionLabelName:\'"+qJsonCharFilter(theLabelArray.optionLabel)+"\',";' . "\r\n" . '		}' . "\r\n" . '		dataqtn += "optionLabelID:\'"+question_range_labelID+"\'";' . "\r\n" . '		dataqtn += "},";' . "\r\n" . '		Label[j] = question_range_labelID;' . "\r\n" . '		j++;' . "\r\n" . '		if( theLabelArray.isRequired == 1 && QtnListArray[questionID].requiredMode == 1 )' . "\r\n" . '		{' . "\r\n" . '			var theOptionJsName = theInfoQtnName+\' - \'+qNoScriptString(theLabelArray.optionLabel);' . "\r\n" . '			//选项生成' . "\r\n" . '			if( count(theBaseQtnArray) != 0 && ! IsSamePage(questionID,theBaseID) )  //不在同页' . "\r\n" . '			{' . "\r\n" . '				if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckAutoMultipleTextNoSamePageIsNeg("+theBaseID+",\'"+theOriValue+"\',"+isHaveOther+","+questionID+","+question_range_labelID+","+theMinOptionID+","+theMaxOptionID+",\'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckAutoMultipleTextNoSamePage("+theBaseID+",\'"+theOriValue+"\',"+isHaveOther+","+questionID+","+question_range_labelID+","+theMinOptionID+","+theMaxOptionID+",\'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				var theBaseIsSelect = (count(theBaseQtnArray)==0) ? 0 : theBaseQtnArray.isSelect;' . "\r\n" . '				if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckAutoMultipleTextIsNeg("+theBaseID+","+theBaseIsSelect+","+isHaveOther+","+questionID+","+question_range_labelID+","+theMinOptionID+","+theMaxOptionID+",\'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckAutoMultipleText("+theBaseID+","+theBaseIsSelect+","+isHaveOther+","+questionID+","+question_range_labelID+","+theMinOptionID+","+theMaxOptionID+",\'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	' . "\r\n" . '	dataqtn = dataqtn.substr(0,dataqtn.length-1)+"],";' . "\r\n" . '' . "\r\n" . '	//问题选项的最大与最少ID值' . "\r\n" . '	var startScale = (Label[0] != \'\') ? Label[0] : 0;' . "\r\n" . '	var endScale = (Label[count(Label)-1] != \'\' ) ? Label[count(Label)-1] :0;' . "\r\n" . '' . "\r\n" . '	var remove_value_list = \'\';' . "\r\n" . '	var theOptionAutoIDList = \'\';' . "\r\n" . '	dataqtn += " qtns:[ ";' . "\r\n" . '	for( var tmp in optionMinMaxArray )' . "\r\n" . '	{' . "\r\n" . '		var optionAutoID = optionMinMaxArray[tmp];' . "\r\n" . '		var optionAutoName = optionAutoArray[optionAutoID];' . "\r\n" . '		theOptionAutoIDList += optionAutoID+\',\';' . "\r\n" . '		dataqtn += "{";' . "\r\n" . '		dataqtn += " optionName: \'"+optionAutoName+"\',";' . "\r\n" . '		dataqtn += " optionNameID: \'"+optionAutoID+"\',";' . "\r\n" . '' . "\r\n" . '		var sub_option_list = \'\';' . "\r\n" . '		for( var question_range_labelID in LabelListArray[questionID] )' . "\r\n" . '		{' . "\r\n" . '			var theLabelArray = LabelListArray[questionID][question_range_labelID];' . "\r\n" . '			var theOptionID = \'option_\'+questionID+\'_\'+optionAutoID+\'_\'+question_range_labelID;' . "\r\n" . '' . "\r\n" . '			sub_option_list += \'<td class="answer" align="center" nowrap id="multitextcheck_\'+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+\'_\'+question_range_labelID+\'"><input name="\'+theOptionID+\'" id="\'+theOptionID+\'" size="\'+theLabelArray.optionSize+\'"\';' . "\r\n" . '			if( count(dataRow.rows) != 0 )' . "\r\n" . '			{' . "\r\n" . '				sub_option_list += " value=\\""+qhtmlspecialchars(dataRow.rows[0][dataIndex[theOptionID]])+"\\"";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				sub_option_list += " value=\\"\\"";' . "\r\n" . '			}' . "\r\n" . '			switch( theLabelArray.isCheckType )' . "\r\n" . '			{' . "\r\n" . '				case 4:  //数值' . "\r\n" . '				case 8:  //企业法人代码' . "\r\n" . '				case 9:  //邮政编码' . "\r\n" . '					sub_option_list += " type=\\"number\\" ";' . "\r\n" . '				break;' . "\r\n" . '				case 5:  //电话' . "\r\n" . '				case 11:  //手机' . "\r\n" . '					sub_option_list += " type=\\"tel\\" ";' . "\r\n" . '				break;' . "\r\n" . '				case 6:  //日期' . "\r\n" . '					sub_option_list += " type=\\"text\\" onclick=\\"javascript:seldate(this)\\" ";' . "\r\n" . '				break;' . "\r\n" . '				default:' . "\r\n" . '					sub_option_list += " type=\\"text\\" ";' . "\r\n" . '				break;' . "\r\n" . '			}' . "\r\n" . '			sub_option_list += \'"></td><td width=10></td>\';' . "\r\n" . '' . "\r\n" . '			//处理页面字段' . "\r\n" . '			this_fields_list += theOptionID+\'|\';' . "\r\n" . '			this_fields_type += \'3|\';' . "\r\n" . '			' . "\r\n" . '			//页面检查' . "\r\n" . '			var theOptionJsName = theInfoQtnName+\' - \'+qNoScriptString(optionAutoName)+\' - \'+qNoScriptString(theLabelArray.optionLabel);' . "\r\n" . '			if( theLabelArray.isRequired == 1 && QtnListArray[questionID].requiredMode == 2 )' . "\r\n" . '			{' . "\r\n" . '				check_survey_form_no_con_list +="\\tif (document.getElementById(\'multitext_"+theBaseID+\'_\'+questionID+\'_\'+optionAutoID+"\').style.display != \'none\'){\\n";' . "\r\n" . '				check_survey_form_no_con_list += "\\t\\tif (!CheckNotNull(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				check_survey_form_no_con_list +="\\t}\\n";' . "\r\n" . '			}' . "\r\n" . '			switch( theLabelArray.isCheckType )' . "\r\n" . '			{' . "\r\n" . '				case 1:  //Email' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckEmail(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 2:  //长度' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckStringLength(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\',"+theLabelArray.minOption+","+theLabelArray.maxOption+")){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 3:  //中文' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckNoChinese(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 4:  //数值' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckIsValue(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\',"+theLabelArray.minOption+","+theLabelArray.maxOption+")){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 5:  //电话' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckPhone(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 6:  //日期' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckDate(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 7:  //身份证' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckIDCardNo(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 8:  //企业法人代码' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckCorpCode(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 9:  //邮政编码' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckPostalCode(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 10:  //URL' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckURL(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 11:  //手机' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckMobile(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '				case 12:  //中文' . "\r\n" . '					check_survey_form_no_con_list += "\\tif (!CheckChinese(document.Survey_Form."+theOptionID+", \'"+theOptionJsName+"\')){return false;}\\n";' . "\r\n" . '				break;' . "\r\n" . '			}' . "\r\n" . '			//记录移除值' . "\r\n" . '			remove_value_list +="\\tTextUnInput(document.Survey_Form."+theOptionID+");\\n";' . "\r\n" . '		}	' . "\r\n" . '		dataqtn += "sub_option_list:\'"+sub_option_list+"\' ";' . "\r\n" . '		dataqtn += "},";' . "\r\n" . '	}' . "\r\n" . '	dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '' . "\r\n" . '	//逻辑条件' . "\r\n" . '	var QuestionCon = _GetQuestionCond(questionID,qid);' . "\r\n" . '	var theBaseIsSelect = (count(theBaseQtnArray) ==0 ) ? 0 : theBaseQtnArray.isSelect;' . "\r\n" . '    var theIsSamePage = IsSamePage(questionID,theBaseID)? 1:0 ;' . "\r\n" . '	var getCheckBoxNoneofAbove = "_getCheckBoxNoneofAbove("+theBaseQtnArray.questionType+","+theBaseID+","+theBaseIsSelect+","+theIsSamePage+","+QtnListArray[questionID].isNeg+",\'"+theBaseValueList+"\')";' . "\r\n" . '	if( QuestionCon != \'\' )' . "\r\n" . '	{' . "\r\n" . '		check_survey_conditions_list += "\\tif("+QuestionCon+" && "+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').show();\\n\\t} \\n";' . "\r\n" . '		check_survey_conditions_list += "\\telse { \\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').hide();\\n\\t} \\n";' . "\r\n" . '' . "\r\n" . '		check_form_list = "\\tif("+QuestionCon+" && "+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '		check_form_list += check_survey_form_no_con_list;' . "\r\n" . '		check_form_list += "\\t}\\n";' . "\r\n" . '		//移除已回复的值' . "\r\n" . '		check_form_list += "\\telse{\\n";' . "\r\n" . '		check_form_list += remove_value_list;' . "\r\n" . '		check_form_list += "\\t}\\n";    ' . "\r\n" . '		check_survey_form_list += check_form_list;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		check_survey_conditions_list += "\\tif("+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').show();\\n\\t} \\n";' . "\r\n" . '		check_survey_conditions_list += "\\telse { \\n";' . "\r\n" . '		check_survey_conditions_list += "\\t\\t$(\'#question_"+questionID+"\').hide();\\n\\t} \\n";' . "\r\n" . '		if( check_survey_form_no_con_list != \'\' )' . "\r\n" . '		{' . "\r\n" . '			check_form_list = "\\tif("+getCheckBoxNoneofAbove+")\\n\\t{\\n";' . "\r\n" . '			check_form_list += check_survey_form_no_con_list;' . "\r\n" . '			check_form_list += "\\t}\\n";' . "\r\n" . '			check_survey_form_list += check_form_list;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	//选项生成' . "\r\n" . '	if( count(theBaseQtnArray) != 0 && ! IsSamePage(questionID,theBaseID) )  //不在同页' . "\r\n" . '	{' . "\r\n" . '		theOptionAutoIDList = substr(theOptionAutoIDList,0,-1);' . "\r\n" . '		theOriValue = \',\'+theOriValue+\',\';' . "\r\n" . '		if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '		{' . "\r\n" . '			check_survey_conditions_list += "\\tgetAutoMultiTextNoSamePageIsNeg("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+","+startScale+","+endScale+","+theFirstID+","+theLastID+","+isHaveOther+");\\n";' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			check_survey_conditions_list += "\\tgetAutoMultiTextNoSamePage("+theBaseID+",\'"+theOptionAutoIDList+"\',\'"+theOriValue+"\',"+questionID+","+startScale+","+endScale+","+theFirstID+","+theLastID+","+isHaveOther+");\\n";' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else   //同页' . "\r\n" . '	{' . "\r\n" . '		var theBaseIsSelect = (count(theBaseQtnArray)==0) ? 0 : theBaseQtnArray.isSelect;' . "\r\n" . '		if( QtnListArray[questionID].isNeg == 1 )' . "\r\n" . '		{' . "\r\n" . '			check_survey_conditions_list += "\\tgetAutoMultiTextSamePageIsNeg("+theBaseID+","+theBaseIsSelect+","+questionID+","+startScale+","+endScale+","+theFirstID+","+theLastID+","+isHaveOther+");\\n";' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			check_survey_conditions_list += "\\tgetAutoMultiTextSamePage("+theBaseID+","+theBaseIsSelect+","+questionID+","+startScale+","+endScale+","+theFirstID+","+theLastID+","+isHaveOther+");\\n";' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	check_survey_conditions_list += "\\tchangeMaskingQtnBgColor("+questionID+");\\n";' . "\r\n" . '' . "\r\n" . '	var tplText = \'<table width="100%" class="pertable" id="question_{$questionID}"><tr><td class="question" valign=center>&nbsp;<span class="textEdit" id="questionName_{$questionID}">{$questionName}</span>&nbsp;<span class=notes>{$questionNotes}</span></td></tr><tr><td class="tips"><span class="textEdit" id="questionNotes_{$questionID}">{$questionTips}</span></td></tr><tr><td><table cellSpacing=0 cellPadding=0 id="qtn_table_{$questionID}"><tr style="display:none" id="multitext_{$baseID}_{$questionID}_text" class=tdheight><td>&nbsp;</td><td width=8></td>{foreach $answers as $j => $answer}<td class="answer" align="center" nowrap><span class="textEdit" id="optionLabel_29_{$questionID}_{$answer.optionLabelID}">{$answer.optionLabelName}</span></td><td width=10></td>{/foreach}</tr>{foreach $qtns as $i => $qtn}<tr style="display:none" id="multitext_{$baseID}_{$questionID}_{$qtn.optionNameID}"><td class="answer tdheight" nowrap>&nbsp;&nbsp;{$qtn.optionName}</td><td width=8></td>{$qtn.sub_option_list}</tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '' . "\r\n" . '	var jsondata = eval(\'(\'+dataqtn+\')\');' . "\r\n" . '	var t = new jSmart(tplText);' . "\r\n" . '	//$(\'#survey_content_container\').append( t.fetch(jsondata)); ' . "\r\n" . '	survey_content_container_html += t.fetch(jsondata);' . "\r\n" . '	jsondata = null;' . "\r\n" . '	optionAutoArray = null;' . "\r\n" . '	optionMinMaxArray = null;' . "\r\n" . '	theBaseQtnArray = null;' . "\r\n" . '	theCheckBoxListArray = null;' . "\r\n" . '	theLabelArray = null;' . "\r\n" . '	Label = null;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoMultiTextSamePage(baseID,isList,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(j=endScale;j>=startScale;j--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'multitextcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+\'_\'+j+"\')");' . "\r\n" . '							if(theInputObj != null ) TextUnInput(theInputObj.getElementsByTagName("input")[0]);' . "\r\n" . '						}' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(j=endScale;j>=startScale;j--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'multitextcheck_"+baseID+"_"+questionID+"_"+objField[i].value+\'_\'+j+"\')");' . "\r\n" . '							if(theInputObj != null ) TextUnInput(theInputObj.getElementsByTagName("input")[0]);' . "\r\n" . '						}' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '		//判断刻度是否显示' . "\r\n" . '		var isHaveShow = false;' . "\r\n" . '		for(i=theFirstID;i<=theLastID;i++)' . "\r\n" . '		{' . "\r\n" . '		    theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+i+"\')");' . "\r\n" . '		    if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		    {' . "\r\n" . '			    isHaveShow = true;' . "\r\n" . '			    break;' . "\r\n" . '		    }' . "\r\n" . '	    }' . "\r\n" . '		//有其他项' . "\r\n" . '		if( isHaveOther == 1 )' . "\r\n" . '		{' . "\r\n" . '		   theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		   if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		   {' . "\r\n" . '				isHaveShow = true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '		var theTextObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '		if( isHaveShow == true )' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'\';' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'none\';' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoMultiTextNoSamePage(baseID,theAllValue,theSelectValue,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i] + ",") == -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				for(j=endScale;j>=startScale;j--)' . "\r\n" . '				{' . "\r\n" . '				   theInputObj = eval("document.getElementById(\'multitextcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+\'_\'+j+"\')");' . "\r\n" . '				   if(theInputObj != null ) TextUnInput(theInputObj.getElementsByTagName("input")[0]);' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//判断刻度是否显示' . "\r\n" . '	var isHaveShow = false;' . "\r\n" . '	for(i=theFirstID;i<=theLastID;i++)' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+i+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '			break;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var theTextObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '	if( isHaveShow == true )' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'\';' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'none\';' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '' . "\r\n" . '//检查自动矩阵填空' . "\r\n" . 'function CheckAutoMultipleText(baseID,isList,isHaveOther,qtnID,labelID,minOptionID,maxOptionID,strText)' . "\r\n" . '{' . "\r\n" . '    //计算显示的行' . "\r\n" . '	var theExistId = new Array();' . "\r\n" . '	var k=0;' . "\r\n" . '	var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '				 if( objField.options[i].selected && objField.options[i].value != \'\')' . "\r\n" . '				 {' . "\r\n" . '					theExistId[k] = objField.options[i].value ;' . "\r\n" . '					k++;' . "\r\n" . '				 }' . "\r\n" . '			}' . "\r\n" . '		 }' . "\r\n" . '		 else' . "\r\n" . '		 {' . "\r\n" . '		 	for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			     if(objField[i].checked )' . "\r\n" . '				 {' . "\r\n" . '					theExistId[k] = objField[i].value ;' . "\r\n" . '					k++;' . "\r\n" . '				 }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}			    ' . "\r\n" . '' . "\r\n" . '	for(i=minOptionID;i<=maxOptionID;i++)' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_" + i + "_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(i,theExistId) )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//拥有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_0_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(0,theExistId) )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . ' 	objField = eval("document.Survey_Form.option_" + qtnID + "_" + theExistId[0] + "_" + labelID );' . "\r\n" . '    if(objField != null) objField.focus();' . "\r\n" . '    showMessage("请填写“" + strText + "”！");' . "\r\n" . '    return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查自动矩阵填空' . "\r\n" . 'function CheckAutoMultipleTextNoSamePage(baseID,theSelectValue,isHaveOther,qtnID,labelID,minOptionID,maxOptionID,strText)' . "\r\n" . '{' . "\r\n" . '    //计算显示的行' . "\r\n" . '	var theExistId = new Array();' . "\r\n" . '	theExistId = theSelectValue.split(\',\');' . "\r\n" . '	for(i=minOptionID;i<=maxOptionID;i++)' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_" + i + "_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(i,theExistId) )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//拥有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_0_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(0,theExistId) )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '  	objField = eval("document.Survey_Form.option_" + qtnID + "_" + theExistId[0] + "_" + labelID );' . "\r\n" . '    if(objField != null) objField.focus();' . "\r\n" . '    showMessage("请填写“" + strText + "”！");' . "\r\n" . '    return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function in_array (needle, haystack, argStrict) {' . "\r\n" . '    var key = \'\',' . "\r\n" . '        strict = !! argStrict;' . "\r\n" . ' ' . "\r\n" . '    if (strict) {' . "\r\n" . '        for (key in haystack) {' . "\r\n" . '            if (haystack[key] === needle) {' . "\r\n" . '                return true;' . "\r\n" . '            }' . "\r\n" . '        }' . "\r\n" . '    } else {' . "\r\n" . '        for (key in haystack) {' . "\r\n" . '            if (haystack[key] == needle) {' . "\r\n" . '                return true;' . "\r\n" . '            }' . "\r\n" . '        }' . "\r\n" . '    } ' . "\r\n" . '    return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoMultiTextSamePageIsNeg(baseID,isList,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected != true && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(j=endScale;j>=startScale;j--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'multitextcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+\'_\'+j+"\')");' . "\r\n" . '							if(theInputObj != null ) TextUnInput(theInputObj.getElementsByTagName("input")[0]);' . "\r\n" . '						}' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked != true )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						//移除原有选择' . "\r\n" . '						for(j=endScale;j>=startScale;j--)' . "\r\n" . '						{' . "\r\n" . '							theInputObj = eval("document.getElementById(\'multitextcheck_"+baseID+"_"+questionID+"_"+objField[i].value+\'_\'+j+"\')");' . "\r\n" . '							if(theInputObj != null ) TextUnInput(theInputObj.getElementsByTagName("input")[0]);' . "\r\n" . '						}' . "\r\n" . '				   }' . "\r\n" . '			   }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '		//判断刻度是否显示' . "\r\n" . '		var isHaveShow = false;' . "\r\n" . '		for(i=theFirstID;i<=theLastID;i++)' . "\r\n" . '		{' . "\r\n" . '		    theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+i+"\')");' . "\r\n" . '		    if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		    {' . "\r\n" . '			    isHaveShow = true;' . "\r\n" . '			    break;' . "\r\n" . '		    }' . "\r\n" . '	    }' . "\r\n" . '		//有其他项' . "\r\n" . '		if( isHaveOther == 1 )' . "\r\n" . '		{' . "\r\n" . '		   theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		   if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		   {' . "\r\n" . '				isHaveShow = true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '		var theTextObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '		if( isHaveShow == true )' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'\';' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theTextObj.style.display = \'none\';' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoMultiTextNoSamePageIsNeg(baseID,theAllValue,theSelectValue,questionID,startScale,endScale,theFirstID,theLastID,isHaveOther)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i] + ",") != -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				//移除原有选择' . "\r\n" . '				for(j=endScale;j>=startScale;j--)' . "\r\n" . '				{' . "\r\n" . '				   theInputObj = eval("document.getElementById(\'multitextcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+\'_\'+j+"\')");' . "\r\n" . '				   if(theInputObj != null ) TextUnInput(theInputObj.getElementsByTagName("input")[0]);' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//判断刻度是否显示' . "\r\n" . '	var isHaveShow = false;' . "\r\n" . '	for(i=theFirstID;i<=theLastID;i++)' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+i+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '			break;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '		theQtnObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_"+0+"\')");' . "\r\n" . '		if( theQtnObj != null && theQtnObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			isHaveShow = true;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var theTextObj = eval("document.getElementById(\'multitext_"+baseID+"_"+questionID+"_text"+"\')");' . "\r\n" . '	if( isHaveShow == true )' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'\';' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		theTextObj.style.display = \'none\';' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '' . "\r\n" . '//检查自动矩阵填空' . "\r\n" . 'function CheckAutoMultipleTextIsNeg(baseID,isList,isHaveOther,qtnID,labelID,minOptionID,maxOptionID,strText)' . "\r\n" . '{' . "\r\n" . '    //计算显示的行' . "\r\n" . '	var theExistId = new Array();' . "\r\n" . '	var k=0;' . "\r\n" . '	var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '				 if( objField.options[i].selected != true && objField.options[i].value != \'\')' . "\r\n" . '				 {' . "\r\n" . '					theExistId[k] = objField.options[i].value ;' . "\r\n" . '					k++;' . "\r\n" . '				 }' . "\r\n" . '			}' . "\r\n" . '		 }' . "\r\n" . '		 else' . "\r\n" . '		 {' . "\r\n" . '		 	for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			     if(objField[i].checked != true )' . "\r\n" . '				 {' . "\r\n" . '					theExistId[k] = objField[i].value ;' . "\r\n" . '					k++;' . "\r\n" . '				 }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}			    ' . "\r\n" . '' . "\r\n" . '	for(i=minOptionID;i<=maxOptionID;i++)' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_" + i + "_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(i,theExistId) )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//拥有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_0_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(0,theExistId) )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . ' 	objField = eval("document.Survey_Form.option_" + qtnID + "_" + theExistId[0] + "_" + labelID );' . "\r\n" . '    if(objField != null) objField.focus();' . "\r\n" . '    showMessage("请填写“" + strText + "”！");' . "\r\n" . '    return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查自动矩阵填空' . "\r\n" . 'function CheckAutoMultipleTextNoSamePageIsNeg(baseID,theSelectValue,isHaveOther,qtnID,labelID,minOptionID,maxOptionID,strText)' . "\r\n" . '{' . "\r\n" . '    //计算显示的行' . "\r\n" . '	var theExistId = new Array();' . "\r\n" . '	var theOptionObj;' . "\r\n" . '	var theFirstInputNum = 0;' . "\r\n" . '	theExistId = theSelectValue.split(\',\');' . "\r\n" . '	for(i=minOptionID;i<=maxOptionID;i++)' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_" + i + "_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(i,theExistId) == false )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '' . "\r\n" . '		   //记录第一项' . "\r\n" . '		   theOptionObj = eval("document.getElementById(\'multitext_"+baseID+"_"+qtnID+"_"+i+"\')");' . "\r\n" . '		   if( theOptionObj != null && theOptionObj.style.display == \'\' && theFirstInputNum == 0 )' . "\r\n" . '		   {' . "\r\n" . '			  theFirstInputNum = i;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	//拥有其他项' . "\r\n" . '	if( isHaveOther == 1 )' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_0_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "" && in_array(0,theExistId) == false )' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	objField = eval("document.Survey_Form.option_" + qtnID + "_" + theFirstInputNum + "_" + labelID );' . "\r\n" . '    if(objField != null) objField.focus();' . "\r\n" . '    showMessage("请填写“" + strText + "”！");' . "\r\n" . '    return false;' . "\r\n" . '}';

?>
