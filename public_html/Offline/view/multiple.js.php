<?php
//dezend by http://www.yunlu99.com/
echo 'function view_multiple_data(questionID)' . "\r\n" . '{' . "\r\n" . '	var questionName = \'\';' . "\r\n" . '	questionName += qQuotaChar(QtnListArray[questionID].questionName);' . "\r\n" . '	questionName += \'&nbsp;<span class=notes>[矩阵多选题]</span>\';' . "\r\n" . '	dataqtn = "{";' . "\r\n" . '	dataqtn += " questionName:\'"+qJsonCharFilter(questionName)+"\',";' . "\r\n" . '' . "\r\n" . '	//显示题目选项' . "\r\n" . '	var optionTotalNum = count(OptionListArray[questionID]);' . "\r\n" . '	var t0 = 0 ;' . "\r\n" . '	var lastOptionId = optionTotalNum - 1;' . "\r\n" . '	dataqtn += " qtns:[ ";' . "\r\n" . '	for( var question_range_optionID in OptionListArray[questionID] )' . "\r\n" . '	{' . "\r\n" . '		var optionName = \'\';' . "\r\n" . '		if( OptionListArray[questionID][question_range_optionID].isRequired == 1 )' . "\r\n" . '		{' . "\r\n" . '			optionName += \'<span class=red>*</span>\';' . "\r\n" . '		}' . "\r\n" . '		optionName += qJsonCharFilter(OptionListArray[questionID][question_range_optionID].optionName);' . "\r\n" . '		dataqtn += "{ ";' . "\r\n" . '		if( QtnListArray[questionID].isHaveOther != 1 )' . "\r\n" . '		{' . "\r\n" . '			dataqtn += "optionName:\'"+optionName+"\',";' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			if( t0 != lastOptionId )' . "\r\n" . '			{' . "\r\n" . '				dataqtn += "optionName:\'"+optionName+"\',";' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				var theOptionValue = dataRow.rows[0][dataIndex[\'TextOtherValue_\'+questionID]];' . "\r\n" . '				if( theOptionValue != \'\' )' . "\r\n" . '				{' . "\r\n" . '					dataqtn += "optionName:\'"+optionName+"<font color=red>("+theOptionValue+")</font>\',";' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					dataqtn += "optionName:\'"+optionName+"\',";' . "\r\n" . '				}			' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		t0++;' . "\r\n" . '		var the_question_range_answerID = \'option_\'+questionID+\'_\'+question_range_optionID;' . "\r\n" . '		var the_question_range_answer_value = dataRow.rows[0][dataIndex[the_question_range_answerID]];' . "\r\n" . '		if( the_question_range_answer_value != \'\' && the_question_range_answer_value != \'false\' )' . "\r\n" . '		{' . "\r\n" . '			var option_value_array = the_question_range_answer_value.split(\',\');' . "\r\n" . '			var checkbox_value_list = \'\';' . "\r\n" . '			for( var tmp in option_value_array )' . "\r\n" . '			{	' . "\r\n" . '				var option_selected_id = option_value_array[tmp];' . "\r\n" . '				if( option_selected_id != \'\')' . "\r\n" . '				{' . "\r\n" . '					checkbox_value_list += qJsonCharFilter(AnswerListArray[questionID][option_selected_id].optionAnswer)+\'|\';' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			dataqtn += "optionAnswer:\'"+substr(checkbox_value_list,0,-1)+"\'";' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			dataqtn += "optionAnswer:\'跳过\'";' . "\r\n" . '		}' . "\r\n" . '		dataqtn += "},";' . "\r\n" . '	}' . "\r\n" . '	dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '' . "\r\n" . '	var tplText = \'<table width="100%"><tr><td class="question">{$questionName}</td></tr><tr><td><table cellSpacing=0 cellPadding=0>{foreach $qtns as $i => $qtn}<tr><td class="option">&nbsp;<span class="option">{$qtn.optionName}：</span><font color=red>{$qtn.optionAnswer}</font></td></tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '' . "\r\n" . '    var jsondata = eval(\'(\'+dataqtn+\')\');' . "\r\n" . '	var t = new jSmart(tplText);' . "\r\n" . '    survey_content_data_html += t.fetch(jsondata);' . "\r\n" . '	jsondata = null;' . "\r\n" . '	option_value_array = null;' . "\r\n" . '}';

?>
