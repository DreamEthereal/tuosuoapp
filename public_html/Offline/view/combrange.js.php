<?php
//dezend by http://www.yunlu99.com/
echo 'function view_combrange_data(questionID)' . "\r\n" . '{' . "\r\n" . '	var questionName = \'\';' . "\r\n" . '	if( QtnListArray[questionID].isRequired == 1 )' . "\r\n" . '	{' . "\r\n" . '		questionName += \'<span class=red>*</span>\';' . "\r\n" . '	}' . "\r\n" . '	questionName += qQuotaChar(QtnListArray[questionID].questionName);' . "\r\n" . '	questionName += \'&nbsp;<span class=notes>[复合矩阵单选题]</span>\';' . "\r\n" . '	dataqtn = "{";' . "\r\n" . '	dataqtn += " questionName:\'"+qJsonCharFilter(questionName)+"\',";' . "\r\n" . '' . "\r\n" . '	var Label = [];' . "\r\n" . '	dataqtn += " answers:[";' . "\r\n" . '	for( var question_range_labelID in LabelListArray[questionID] )' . "\r\n" . '	{' . "\r\n" . '		var theLabelArray = LabelListArray[questionID][question_range_labelID];' . "\r\n" . '		Label[question_range_labelID] = theLabelArray.optionLabel;' . "\r\n" . '' . "\r\n" . '		dataqtn += "{";' . "\r\n" . '		dataqtn += " optionLabelName:\'"+qJsonCharFilter(theLabelArray.optionLabel)+"\'";' . "\r\n" . '		dataqtn += "},";' . "\r\n" . '	}' . "\r\n" . '	dataqtn = dataqtn.substr(0,dataqtn.length-1)+"],";' . "\r\n" . '' . "\r\n" . '	dataqtn += " qtns:[ ";' . "\r\n" . '	for( var question_range_optionID in OptionListArray[questionID] )' . "\r\n" . '	{' . "\r\n" . '		dataqtn += "{ ";' . "\r\n" . '		dataqtn += "optionName:\'"+qJsonCharFilter(OptionListArray[questionID][question_range_optionID].optionName)+"\',";' . "\r\n" . '		var sub_option_list = \'\';' . "\r\n" . '		for( var question_range_labelID in Label )' . "\r\n" . '		{' . "\r\n" . '			var the_question_range_answerID = \'option_\'+questionID+\'_\'+question_range_optionID+\'_\'+question_range_labelID;' . "\r\n" . '			var the_question_range_answer_value = dataRow.rows[0][dataIndex[the_question_range_answerID]];' . "\r\n" . '			if( the_question_range_answer_value != \'0\' && the_question_range_answer_value != \'\')' . "\r\n" . '			{' . "\r\n" . '				sub_option_list += \'<td align="center" class="option"><font color=red>\'+qJsonCharFilter(AnswerListArray[questionID][the_question_range_answer_value].optionAnswer)+\'</font></td>\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				sub_option_list += \'<td align="center" class="option"><font color=red>跳过</font></td>\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		dataqtn += "sub_option_list:\'"+sub_option_list+"\'";' . "\r\n" . '		dataqtn += "},";' . "\r\n" . '	}' . "\r\n" . '	dataqtn = dataqtn.substr(0,dataqtn.length-1)+"] }";' . "\r\n" . '' . "\r\n" . '	var tplText = \'<table width="100%"><tr><td class="question">{$questionName}</td></tr><tr><td><table style="LINE-HEIGHT: 150%;border-collapse:collapse;" cellSpacing=0 cellPadding=0 borderColor=#ffffff border=1><tr><td>&nbsp;</td>{foreach $answers as $j => $answer}<td class="option" align="center">{$answer.optionLabelName}</td>	{/foreach}</tr>{foreach $qtns as $i => $qtn}<tr><td class="option">{$qtn.optionName}</td>{$qtn.sub_option_list}</tr>{/foreach}</table></td></tr></table>\';' . "\r\n" . '' . "\r\n" . '    var jsondata = eval(\'(\'+dataqtn+\')\');' . "\r\n" . '	var t = new jSmart(tplText);' . "\r\n" . '    survey_content_data_html += t.fetch(jsondata);' . "\r\n" . '	jsondata = null;' . "\r\n" . '	Label = null;' . "\r\n" . '	theLabelArray = null;' . "\r\n" . '}';

?>
