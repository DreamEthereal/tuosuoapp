<?php
//dezend by http://www.yunlu99.com/
echo 'var cal;' . "\r\n" . 'var isFocus=false; //是否为焦点' . "\r\n" . 'var pickMode ={' . "\r\n" . '    "second":1,' . "\r\n" . '    "minute":2,' . "\r\n" . '    "hour":3,' . "\r\n" . '    "day":4,' . "\r\n" . '    "month":5,' . "\r\n" . '    "year":6  };' . "\r\n" . '    ' . "\r\n" . 'var topY=0,leftX=0;  ' . "\r\n" . 'function SelectDateById(id,strFormat,x,y)' . "\r\n" . '{' . "\r\n" . '	var obj = document.getElementById(id);' . "\r\n" . '	if(obj == null){return false;}' . "\r\n" . '	obj.focus();' . "\r\n" . '	if(obj.onclick != null){obj.onclick();}' . "\r\n" . '	else if(obj.click != null){obj.click();}' . "\r\n" . '	else{SelectDate(obj,strFormat,x,y)}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function SelectDate(obj,strFormat,x,y)' . "\r\n" . '{' . "\r\n" . '' . "\r\n" . '	leftX =(x == null) ? leftX : x;' . "\r\n" . '	topY  =(y == null) ? topY : y;' . "\r\n" . '	if(document.getElementById("ContainerPanel")==null){InitContainerPanel();}' . "\r\n" . '    var date = new Date();' . "\r\n" . '    var by = date.getFullYear()-120;  //最小值 → 50 年前' . "\r\n" . '    var ey = date.getFullYear()+50;  //最大值 → 50 年后' . "\r\n" . '    //cal = new Calendar(by, ey,1,strFormat);    //初始化英文版，0 为中文版' . "\r\n" . '    cal = (cal==null) ? new Calendar(by, ey, 1) : cal; ' . "\r\n" . '    cal.DateMode =pickMode["second"]; //复位' . "\r\n" . '      if(strFormat.indexOf(\'s\')< 0) {cal.DateMode =pickMode["minute"];}//精度为分' . "\r\n" . '      if(strFormat.indexOf(\'m\')< 0) {cal.DateMode =pickMode["hour"];}//精度为时' . "\r\n" . '      if(strFormat.indexOf(\'h\')< 0) {cal.DateMode =pickMode["day"];}//精度为日' . "\r\n" . '      if(strFormat.indexOf(\'d\')< 0) {cal.DateMode =pickMode["month"];}//精度为月' . "\r\n" . '      if(strFormat.indexOf(\'M\')< 0) {cal.DateMode =pickMode["year"];}//精度为年' . "\r\n" . '      if(strFormat.indexOf(\'y\')< 0) {cal.DateMode =pickMode["second"];}//默认精度为秒' . "\r\n" . '    cal.dateFormatStyleOld = cal.dateFormatStyle;' . "\r\n" . '    cal.dateFormatStyle = strFormat;' . "\r\n" . '    cal.show(obj);' . "\r\n" . '}' . "\r\n" . 'String.prototype.toDate = function(style) {' . "\r\n" . '  var y = this.substring(style.indexOf(\'y\'),style.lastIndexOf(\'y\')+1);//年' . "\r\n" . '  var M = this.substring(style.indexOf(\'M\'),style.lastIndexOf(\'M\')+1);//月' . "\r\n" . '  var d = this.substring(style.indexOf(\'d\'),style.lastIndexOf(\'d\')+1);//日' . "\r\n" . '  var h = this.substring(style.indexOf(\'h\'),style.lastIndexOf(\'h\')+1);//时' . "\r\n" . '  var m = this.substring(style.indexOf(\'m\'),style.lastIndexOf(\'m\')+1);//分' . "\r\n" . '  var s = this.substring(style.indexOf(\'s\'),style.lastIndexOf(\'s\')+1);//秒' . "\r\n" . '' . "\r\n" . '  if(s == null ||s == "" || isNaN(s)) {s = new Date().getSeconds();}' . "\r\n" . '  if(m == null ||m == "" || isNaN(m)) {m = new Date().getMinutes();}' . "\r\n" . '  if(h == null ||h == "" || isNaN(h)) {h = new Date().getHours();}' . "\r\n" . '  if(d == null ||d == "" || isNaN(d)) {d = new Date().getDate();}' . "\r\n" . '  if(M == null ||M == "" || isNaN(M)) {M = new Date().getMonth()+1;}' . "\r\n" . '  if(y == null ||y == "" || isNaN(y)) {y = new Date().getFullYear();}' . "\r\n" . '  var dt ;' . "\r\n" . '  eval ("dt = new Date(\'"+ y+"\', \'"+(M-1)+"\',\'"+ d+"\',\'"+ h+"\',\'"+ m+"\',\'"+ s +"\')");' . "\r\n" . '  return dt;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Date.prototype.format = function(style) {' . "\r\n" . '  var o = {' . "\r\n" . '    "M+" : this.getMonth() + 1, //month' . "\r\n" . '    "d+" : this.getDate(),      //day' . "\r\n" . '    "h+" : this.getHours(),     //hour' . "\r\n" . '    "m+" : this.getMinutes(),   //minute' . "\r\n" . '    "s+" : this.getSeconds(),   //second' . "\r\n" . '    "w+" : "天一二三四五六".charAt(this.getDay()),   //week' . "\r\n" . '    "q+" : Math.floor((this.getMonth() + 3) / 3),  //quarter' . "\r\n" . '    "S"  : this.getMilliseconds() //millisecond' . "\r\n" . '  }' . "\r\n" . '  if(/(y+)/.test(style)) {' . "\r\n" . '    style = style.replace(RegExp.$1,' . "\r\n" . '    (this.getFullYear() + "").substr(4 - RegExp.$1.length));' . "\r\n" . '  }' . "\r\n" . '  for(var k in o){' . "\r\n" . '    if(new RegExp("("+ k +")").test(style)){' . "\r\n" . '      style = style.replace(RegExp.$1,' . "\r\n" . '        RegExp.$1.length == 1 ? o[k] :' . "\r\n" . '        ("00" + o[k]).substr(("" + o[k]).length));' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '  return style;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Calendar.prototype.ReturnDate = function(dt) {' . "\r\n" . '    if (this.dateControl != null){this.dateControl.value = dt;}' . "\r\n" . '    calendar.hide();' . "\r\n" . '	if(this.dateControl.onchange == null){return;}	' . "\r\n" . '    var ev = this.dateControl.onchange.toString();' . "\r\n" . '    ev = ev.substring(' . "\r\n" . '			((ev.indexOf("ValidatorOnChange();")> 0) ? ev.indexOf("ValidatorOnChange();") + 20 : ev.indexOf("{") + 1)' . "\r\n" . '				, ev.lastIndexOf("}"));' . "\r\n" . '	var fun = new Function(ev);' . "\r\n" . '	this.dateControl.changeEvent = fun;	' . "\r\n" . '    this.dateControl.changeEvent();' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function Calendar(beginYear, endYear, lang, dateFormatStyle) {' . "\r\n" . '  this.beginYear = 1950;' . "\r\n" . '  this.endYear = 2050;' . "\r\n" . '  this.lang = 0;            //0(中文) | 1(英文)' . "\r\n" . '  this.dateFormatStyle = "yyyy-MM-dd hh:mm:ss";' . "\r\n" . '' . "\r\n" . '  if (beginYear != null && endYear != null){' . "\r\n" . '    this.beginYear = beginYear;' . "\r\n" . '    this.endYear = endYear;' . "\r\n" . '  }' . "\r\n" . '  if (lang != null){' . "\r\n" . '    this.lang = lang' . "\r\n" . '  }' . "\r\n" . '' . "\r\n" . '  if (dateFormatStyle != null){' . "\r\n" . '    this.dateFormatStyle = dateFormatStyle' . "\r\n" . '  }' . "\r\n" . '' . "\r\n" . '  this.dateControl = null;' . "\r\n" . '  this.panel = this.getElementById("calendarPanel");' . "\r\n" . '  this.container = this.getElementById("ContainerPanel");' . "\r\n" . '  this.form  = null;' . "\r\n" . '' . "\r\n" . '  this.date = new Date();' . "\r\n" . '  this.year = this.date.getFullYear();' . "\r\n" . '  this.month = this.date.getMonth();' . "\r\n" . '  ' . "\r\n" . '  this.day = this.date.getDate();' . "\r\n" . '  this.hour = this.date.getHours();' . "\r\n" . '  this.minute = this.date.getMinutes();' . "\r\n" . '  this.second = this.date.getSeconds();' . "\r\n" . '' . "\r\n" . '  this.colors = {' . "\r\n" . '  "cur_word"      : "#FFFFFF",  //当日日期文字颜色' . "\r\n" . '  "cur_bg"        : "#00FF00",  //当日日期单元格背影色' . "\r\n" . '  "sel_bg"        : "#FFCCCC",  //已被选择的日期单元格背影色' . "\r\n" . '  "sun_word"      : "#FF0000",  //星期天文字颜色  ' . "\r\n" . '  "sat_word"      : "#0000FF",  //星期六文字颜色  ' . "\r\n" . '  "td_word_light" : "#333333",  //单元格文字颜色  ' . "\r\n" . '  "td_word_dark"  : "#CCCCCC",  //单元格文字暗色  ' . "\r\n" . '  "td_bg_out"     : "#EFEFEF",  //单元格背影色' . "\r\n" . '  "td_bg_over"    : "#FFCC00",  //单元格背影色' . "\r\n" . '  "tr_word"       : "#FFFFFF",  //日历头文字颜色  ' . "\r\n" . '  "tr_bg"         : "#666666",  //日历头背影色' . "\r\n" . '  "input_border"  : "#CCCCCC",  //input控件的边框颜色  ' . "\r\n" . '  "input_bg"      : "#EFEFEF"   //input控件的背影色' . "\r\n" . '  }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Calendar.language = {' . "\r\n" . '  "year"   : [[""], [""]],' . "\r\n" . '  "months" : [["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],' . "\r\n" . '        ["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"]' . "\r\n" . '         ],' . "\r\n" . '  "weeks"  : [["日","一","二","三","四","五","六"],' . "\r\n" . '        ["S","M","T","W","T","F","S"]' . "\r\n" . '         ],' . "\r\n" . '  "hour"  : [["时"], ["H"]],' . "\r\n" . '  "minute"  : [["分"], ["M"]],' . "\r\n" . '  "second"  : [["秒"], ["S"]],' . "\r\n" . '  "clear"  : [["清空"], ["CLS"]],' . "\r\n" . '  "today"  : [["今天"], ["TODAY"]],' . "\r\n" . '  "pickTxt"  : [["确定"], ["OK"]],' . "\r\n" . '  "close"  : [["关闭"], ["CLOSE"]]' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Calendar.prototype.draw = function() {' . "\r\n" . '  calendar = this;' . "\r\n" . '' . "\r\n" . '  var mvAry = [];' . "\r\n" . '  mvAry[mvAry.length]  = \'  <div name="calendarForm" style="margin: 0px;">\';' . "\r\n" . '  mvAry[mvAry.length]  = \'    <table width="100%" border="0" cellpadding="0" cellspacing="1" style="font-size:12px;">\';' . "\r\n" . '  mvAry[mvAry.length]  = \'      <tr>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'        <th align="left" width="1%"><input style="border: 1px solid \' + calendar.colors["input_border"] + \';background-color:\' + calendar.colors["input_bg"] + \';width:16px;height:20px;\';' . "\r\n" . '  if(calendar.DateMode > pickMode["month"]){mvAry[mvAry.length]  = \'display:none;\';}//pickMode 精确到年时隐藏“月”' . "\r\n" . '  mvAry[mvAry.length]  =\'" name="prevMonth" type="button" id="prevMonth" value="&lt;" /></th>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'        <th align="center" width="98%" nowrap="nowrap"><select name="calendarYear" id="calendarYear" style="font-size:12px;"></select><select name="calendarMonth" id="calendarMonth" style="font-size:12px;\';' . "\r\n" . '  if(calendar.DateMode > pickMode["month"]){mvAry[mvAry.length]  = \'display:none;\';}//pickMode 精确到年时隐藏“月”' . "\r\n" . '  mvAry[mvAry.length]  = \'"></select></th>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'        <th align="right" width="1%"><input style="border: 1px solid \' + calendar.colors["input_border"] + \';background-color:\' + calendar.colors["input_bg"] + \';width:16px;height:20px;\';' . "\r\n" . '  if(calendar.DateMode > pickMode["month"]){mvAry[mvAry.length]  = \'display:none;\';}//pickMode 精确到年时隐藏“月”' . "\r\n" . '  mvAry[mvAry.length]  =\'" name="nextMonth" type="button" id="nextMonth" value="&gt;" /></th>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'      </tr>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'    </table>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'    <table id="calendarTable" width="100%" style="border:0px solid #CCCCCC;background-color:#FFFFFF;font-size:12px;\';' . "\r\n" . '  if(calendar.DateMode >= pickMode["month"]){mvAry[mvAry.length]  = \'display:none;\';}//pickMode 精确到年、月时隐藏“天”' . "\r\n" . '  mvAry[mvAry.length]  = \'" border="0" cellpadding="3" cellspacing="1">\';' . "\r\n" . '  mvAry[mvAry.length]  = \'      <tr>\';' . "\r\n" . '  for(var i = 0; i < 7; i++) {' . "\r\n" . '    mvAry[mvAry.length]  = \'      <th style="font-weight:normal;background-color:\' + calendar.colors["tr_bg"] + \';color:\' + calendar.colors["tr_word"] + \';">\' + Calendar.language["weeks"][this.lang][i] + \'</th>\';' . "\r\n" . '  }' . "\r\n" . '  mvAry[mvAry.length]  = \'      </tr>\';' . "\r\n" . '  for(var i = 0; i < 6;i++){' . "\r\n" . '    mvAry[mvAry.length]  = \'    <tr align="center">\';' . "\r\n" . '    for(var j = 0; j < 7; j++) {' . "\r\n" . '      if (j == 0){' . "\r\n" . '        mvAry[mvAry.length]  = \'  <td style="cursor:default;color:\' + calendar.colors["sun_word"] + \';"></td>\';' . "\r\n" . '      } else if(j == 6) {' . "\r\n" . '        mvAry[mvAry.length]  = \'  <td style="cursor:default;color:\' + calendar.colors["sat_word"] + \';"></td>\';' . "\r\n" . '      } else {' . "\r\n" . '        mvAry[mvAry.length]  = \'  <td style="cursor:default;"></td>\';' . "\r\n" . '      }' . "\r\n" . '    }' . "\r\n" . '    mvAry[mvAry.length]  = \'    </tr>\';' . "\r\n" . '  }' . "\r\n" . '' . "\r\n" . '  mvAry[mvAry.length]  = \'      <tr style="\';' . "\r\n" . '    if(calendar.DateMode >= pickMode["day"]){mvAry[mvAry.length]  = \'display:none;\';}//pickMode 精确到时日隐藏“时间”' . "\r\n" . '    mvAry[mvAry.length]  = \'"><td align="center" colspan="7">\';' . "\r\n" . '  mvAry[mvAry.length]  = \'      <select name="calendarHour" id="calendarHour" style="font-size:12px;"></select>\' + Calendar.language["hour"][this.lang];' . "\r\n" . '  mvAry[mvAry.length]  = \'<span style="\'' . "\r\n" . '    if(calendar.DateMode >= pickMode["hour"]){mvAry[mvAry.length]  = \'display:none;\';}//pickMode 精确到小时时隐藏“分”' . "\r\n" . '  mvAry[mvAry.length]  = \'"><select name="calendarMinute" id="calendarMinute" style="font-size:12px;"></select>\' + Calendar.language["minute"][this.lang]+\'</span>\';' . "\r\n" . '    mvAry[mvAry.length]  = \'<span style="\'' . "\r\n" . '    if(calendar.DateMode >= pickMode["minute"]){mvAry[mvAry.length]  = \'display:none;\';}//pickMode 精确到小时、分时隐藏“秒”' . "\r\n" . '   mvAry[mvAry.length]  = \'"><select name="calendarSecond" id="calendarSecond" style="font-size:12px;"></select>\'+ Calendar.language["second"][this.lang]+\'</span>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'      </td></tr>\';' . "\r\n" . '  ' . "\r\n" . '  mvAry[mvAry.length]  = \'    </table>\';' . "\r\n" . '  //mvAry[mvAry.length]  = \'  </from>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'      <div align="center" style="padding:4px 4px 4px 4px;background-color:\' + calendar.colors["input_bg"] + \';">\';' . "\r\n" . '  mvAry[mvAry.length]  = \'        <input name="calendarClear" type="button" id="calendarClear" value="\' + Calendar.language["clear"][this.lang] + \'" style="border: 1px solid \' + calendar.colors["input_border"] + \';background-color:\' + calendar.colors["input_bg"] + \';width:40px;height:20px;font-size:12px;cursor:pointer;"/>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'        <input name="calendarToday" type="button" id="calendarToday" value="\' ' . "\r\n" . '  mvAry[mvAry.length]  = (calendar.DateMode == pickMode["day"]) ? Calendar.language["today"][this.lang] : Calendar.language["pickTxt"][this.lang];' . "\r\n" . '  mvAry[mvAry.length]  = \'" style="border: 1px solid \' + calendar.colors["input_border"] + \';background-color:\' + calendar.colors["input_bg"] + \';width:60px;height:20px;font-size:12px;cursor:pointer"/>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'        <input name="calendarClose" type="button" id="calendarClose" value="\' + Calendar.language["close"][this.lang] + \'" style="border: 1px solid \' + calendar.colors["input_border"] + \';background-color:\' + calendar.colors["input_bg"] + \';width:40px;height:20px;font-size:12px;cursor:pointer"/>\';' . "\r\n" . '  mvAry[mvAry.length]  = \'      </div>\';' . "\r\n" . '  ' . "\r\n" . '  mvAry[mvAry.length]  = \'  </div>\';' . "\r\n" . '  this.panel.innerHTML = mvAry.join("");' . "\r\n" . '  ' . "\r\n" . '  var obj = this.getElementById("prevMonth");' . "\r\n" . '  obj.onclick = function () {calendar.goPrevMonth(calendar);}' . "\r\n" . '  obj.onblur = function () {calendar.onblur();}' . "\r\n" . '  this.prevMonth= obj;' . "\r\n" . '  ' . "\r\n" . '  obj = this.getElementById("nextMonth");' . "\r\n" . '  obj.onclick = function () {calendar.goNextMonth(calendar);}' . "\r\n" . '  obj.onblur = function () {calendar.onblur();}' . "\r\n" . '  this.nextMonth= obj;  ' . "\r\n" . '' . "\r\n" . '  obj = this.getElementById("calendarClear");' . "\r\n" . '  obj.onclick = function () ' . "\r\n" . '  { calendar.ReturnDate("");' . "\r\n" . '  }' . "\r\n" . '  this.calendarClear = obj;' . "\r\n" . '  ' . "\r\n" . '  obj = this.getElementById("calendarClose");' . "\r\n" . '  obj.onclick = function () {calendar.hide();}' . "\r\n" . '  this.calendarClose = obj;' . "\r\n" . '  ' . "\r\n" . '  obj = this.getElementById("calendarYear");' . "\r\n" . '  obj.onchange = function () {calendar.update(calendar);}' . "\r\n" . '  obj.onblur = function () {calendar.onblur();}' . "\r\n" . '  this.calendarYear = obj;' . "\r\n" . '  ' . "\r\n" . '  obj = this.getElementById("calendarMonth");' . "\r\n" . '  with(obj)' . "\r\n" . '  {' . "\r\n" . '    onchange = function () {calendar.update(calendar);}' . "\r\n" . '    onblur = function () {calendar.onblur();}' . "\r\n" . '  }this.calendarMonth = obj;' . "\r\n" . '  ' . "\r\n" . '  obj = this.getElementById("calendarHour");' . "\r\n" . '  obj.onchange = function () {calendar.hour = this.options[this.selectedIndex].value;}' . "\r\n" . '  obj.onblur = function () {calendar.onblur();}' . "\r\n" . '  this.calendarHour = obj;' . "\r\n" . '   ' . "\r\n" . '  obj = this.getElementById("calendarMinute");' . "\r\n" . '  obj.onchange = function () {calendar.minute = this.options[this.selectedIndex].value;}' . "\r\n" . '  obj.onblur = function () {calendar.onblur();}' . "\r\n" . '  this.calendarMinute = obj;' . "\r\n" . '  ' . "\r\n" . '  obj = this.getElementById("calendarSecond");' . "\r\n" . '  obj.onchange = function () {calendar.second = this.options[this.selectedIndex].value;}' . "\r\n" . '  obj.onblur = function () {calendar.onblur();}' . "\r\n" . '  this.calendarSecond = obj;' . "\r\n" . '' . "\r\n" . '  obj = this.getElementById("calendarToday");' . "\r\n" . '  obj.onclick = function () {' . "\r\n" . '  var today = (calendar.DateMode != pickMode["day"]) ?' . "\r\n" . '                    new Date(calendar.year,calendar.month,calendar.day,calendar.hour,calendar.minute,calendar.second)' . "\r\n" . '                    : new Date();' . "\r\n" . '    calendar.ReturnDate(today.format(calendar.dateFormatStyle));' . "\r\n" . '  }' . "\r\n" . '  this.calendarToday = obj;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//年份下拉框绑定数据' . "\r\n" . 'Calendar.prototype.bindYear = function() {' . "\r\n" . '  var cy = this.calendarYear;' . "\r\n" . '  cy.length = 0;' . "\r\n" . '  for (var i = this.beginYear; i <= this.endYear; i++){' . "\r\n" . '    cy.options[cy.length] = new Option(i + Calendar.language["year"][this.lang], i);' . "\r\n" . '  }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//月份下拉框绑定数据' . "\r\n" . 'Calendar.prototype.bindMonth = function() {' . "\r\n" . '  var cm = this.calendarMonth;' . "\r\n" . '  cm.length = 0;' . "\r\n" . '  for (var i = 0; i < 12; i++){' . "\r\n" . '    cm.options[cm.length] = new Option(Calendar.language["months"][this.lang][i], i);' . "\r\n" . '  }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//小时下拉框绑定数据' . "\r\n" . 'Calendar.prototype.bindHour = function() {' . "\r\n" . '  var ch = this.calendarHour;' . "\r\n" . '  if(ch.length > 0){return;}' . "\r\n" . '  //ch.length = 0;' . "\r\n" . '  var h;' . "\r\n" . '  for (var i = 0; i < 24; i++){' . "\r\n" . '    h = ("00" + i +"").substr(("" + i).length);' . "\r\n" . '    ch.options[ch.length] = new Option(h, h);' . "\r\n" . '  }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//分钟下拉框绑定数据' . "\r\n" . 'Calendar.prototype.bindMinute = function() {' . "\r\n" . '  var cM = this.calendarMinute;' . "\r\n" . '  if(cM.length > 0){return;}' . "\r\n" . '  //cM.length = 0;' . "\r\n" . '  var M;' . "\r\n" . '  for (var i = 0; i < 60; i++){' . "\r\n" . '    M = ("00" + i +"").substr(("" + i).length);' . "\r\n" . '    cM.options[cM.length] = new Option(M, M);' . "\r\n" . '  }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//秒钟下拉框绑定数据' . "\r\n" . 'Calendar.prototype.bindSecond = function() {' . "\r\n" . '  var cs = this.calendarSecond;' . "\r\n" . '  if(cs.length > 0){return;}' . "\r\n" . '  //cs.length = 0;' . "\r\n" . '  var s;' . "\r\n" . '  for (var i = 0; i < 60; i++){' . "\r\n" . '    s = ("00" + i +"").substr(("" + i).length);' . "\r\n" . '    cs.options[cs.length] = new Option(s, s);' . "\r\n" . '  }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//向前一月' . "\r\n" . 'Calendar.prototype.goPrevMonth = function(e){' . "\r\n" . '  if (this.year == this.beginYear && this.month == 0){return;}' . "\r\n" . '  this.month--;' . "\r\n" . '  if (this.month == -1) {' . "\r\n" . '    this.year--;' . "\r\n" . '    this.month = 11;' . "\r\n" . '  }' . "\r\n" . '  this.date = new Date(this.year, this.month, 1);' . "\r\n" . '  this.changeSelect();' . "\r\n" . '  this.bindData();' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//向后一月' . "\r\n" . 'Calendar.prototype.goNextMonth = function(e){' . "\r\n" . '  if (this.year == this.endYear && this.month == 11){return;}' . "\r\n" . '  this.month++;' . "\r\n" . '  if (this.month == 12) {' . "\r\n" . '    this.year++;' . "\r\n" . '    this.month = 0;' . "\r\n" . '  }' . "\r\n" . '  this.date = new Date(this.year, this.month, 1);' . "\r\n" . '  this.changeSelect();' . "\r\n" . '  this.bindData();' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//改变SELECT选中状态' . "\r\n" . 'Calendar.prototype.changeSelect = function() {' . "\r\n" . '  var cy = this.calendarYear;' . "\r\n" . '  var cm = this.calendarMonth;' . "\r\n" . '  var ch = this.calendarHour;' . "\r\n" . '  var cM = this.calendarMinute;' . "\r\n" . '  var cs = this.calendarSecond;' . "\r\n" . '  cy[this.date.getFullYear()-this.beginYear].selected = true;' . "\r\n" . '  cm[this.date.getMonth()].selected =true;' . "\r\n" . '  ' . "\r\n" . '  ch[this.hour].selected =true;' . "\r\n" . '  cM[this.minute].selected =true;' . "\r\n" . '  cs[this.second].selected =true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//更新年、月' . "\r\n" . 'Calendar.prototype.update = function (e){' . "\r\n" . '  this.year  = e.calendarYear.options[e.calendarYear.selectedIndex].value;' . "\r\n" . '  this.month = e.calendarMonth.options[e.calendarMonth.selectedIndex].value;' . "\r\n" . '  this.date = new Date(this.year, this.month, 1);' . "\r\n" . '  //this.changeSelect();' . "\r\n" . '  this.bindData();' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//绑定数据到月视图' . "\r\n" . 'Calendar.prototype.bindData = function () {' . "\r\n" . '  var calendar = this;' . "\r\n" . '	if(calendar.DateMode >= pickMode["month"]){return;}' . "\r\n" . '  var dateArray = this.getMonthViewArray(this.date.getFullYear(), this.date.getMonth());' . "\r\n" . '  var tds = this.getElementById("calendarTable").getElementsByTagName("td");' . "\r\n" . '  for(var i = 0; i < tds.length; i++) {' . "\r\n" . '  tds[i].style.backgroundColor = calendar.colors["td_bg_out"];' . "\r\n" . '    tds[i].onclick = function () {return;}' . "\r\n" . '    tds[i].onmouseover = function () {return;}' . "\r\n" . '    tds[i].onmouseout = function () {return;}' . "\r\n" . '    if (i > dateArray.length - 1) break;' . "\r\n" . '    tds[i].innerHTML = dateArray[i];' . "\r\n" . '    if (dateArray[i] != "&nbsp;"){' . "\r\n" . '      tds[i].bgColorTxt = "td_bg_out";' . "\r\n" . '        var cur = new Date();' . "\r\n" . '        tds[i].isToday = false;' . "\r\n" . '      if (cur.getFullYear() == calendar.date.getFullYear() && cur.getMonth() == calendar.date.getMonth() && cur.getDate() == dateArray[i]) {' . "\r\n" . '      //是今天的单元格' . "\r\n" . '        tds[i].style.backgroundColor = calendar.colors["cur_bg"];' . "\r\n" . '        tds[i].bgColorTxt = "cur_bg";' . "\r\n" . '        tds[i].isToday = true;' . "\r\n" . '        }' . "\r\n" . '    if(calendar.dateControl != null )' . "\r\n" . '    {' . "\r\n" . '      cur = calendar.dateControl.value.toDate(calendar.dateFormatStyle);' . "\r\n" . '      if (cur.getFullYear() == calendar.date.getFullYear() && cur.getMonth() == calendar.date.getMonth()&& cur.getDate() == dateArray[i]) {' . "\r\n" . '      //是已被选中的单元格' . "\r\n" . '        calendar.selectedDayTD = tds[i];' . "\r\n" . '        tds[i].style.backgroundColor = calendar.colors["sel_bg"];' . "\r\n" . '        tds[i].bgColorTxt = "sel_bg";' . "\r\n" . '      }' . "\r\n" . '    }' . "\r\n" . '      tds[i].onclick = function () {' . "\r\n" . '            if(calendar.DateMode == pickMode["day"])' . "\r\n" . '            {' . "\r\n" . '                calendar.ReturnDate(new Date(calendar.date.getFullYear(),' . "\r\n" . '                                                    calendar.date.getMonth(),' . "\r\n" . '                                                    this.innerHTML).format(calendar.dateFormatStyle));' . "\r\n" . '            }' . "\r\n" . '            else' . "\r\n" . '            {' . "\r\n" . '                if(calendar.selectedDayTD != null)' . "\r\n" . '                {' . "\r\n" . '                    calendar.selectedDayTD.style.backgroundColor =(calendar.selectedDayTD.isToday)? calendar.colors["cur_bg"] : calendar.colors["td_bg_out"];' . "\r\n" . '                }' . "\r\n" . '                this.style.backgroundColor = calendar.colors["sel_bg"];' . "\r\n" . '                calendar.day = this.innerHTML;' . "\r\n" . '                calendar.selectedDayTD = this; ' . "\r\n" . '            }' . "\r\n" . '          }' . "\r\n" . '      tds[i].style.cursor ="pointer";' . "\r\n" . '      tds[i].onmouseover = function () {' . "\r\n" . '        this.style.backgroundColor = calendar.colors["td_bg_over"];' . "\r\n" . '      }' . "\r\n" . '      tds[i].onmouseout = function () {' . "\r\n" . '        if(calendar.selectedDayTD != this) {' . "\r\n" . '        this.style.backgroundColor = calendar.colors[this.bgColorTxt];}' . "\r\n" . '      }' . "\r\n" . '      tds[i].onblur = function () {calendar.onblur();}' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//根据年、月得到月视图数据(数组形式)' . "\r\n" . 'Calendar.prototype.getMonthViewArray = function (y, m) {' . "\r\n" . '  var mvArray = [];' . "\r\n" . '  var dayOfFirstDay = new Date(y, m, 1).getDay();' . "\r\n" . '  var daysOfMonth = new Date(y, m + 1, 0).getDate();' . "\r\n" . '  for (var i = 0; i < 42; i++) {' . "\r\n" . '    mvArray[i] = "&nbsp;";' . "\r\n" . '  }' . "\r\n" . '  for (var i = 0; i < daysOfMonth; i++){' . "\r\n" . '    mvArray[i + dayOfFirstDay] = i + 1;' . "\r\n" . '  }' . "\r\n" . '  return mvArray;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Calendar.prototype.getElementById = function(id){' . "\r\n" . '  if (typeof(id) != "string" || id == "") return null;' . "\r\n" . '  if (document.getElementById) return document.getElementById(id);' . "\r\n" . '  if (document.all) return document.all(id);' . "\r\n" . '  try {return eval(id);} catch(e){ return null;}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Calendar.prototype.getElementsByTagName = function(object, tagName){' . "\r\n" . '  if (document.getElementsByTagName) return document.getElementsByTagName(tagName);' . "\r\n" . '  if (document.all) return document.all.tags(tagName);' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Calendar.prototype.getAbsPoint = function (e){' . "\r\n" . '  var x = e.offsetLeft;' . "\r\n" . '  var y = e.offsetTop;' . "\r\n" . '  while(e = e.offsetParent){' . "\r\n" . '    x += e.offsetLeft;' . "\r\n" . '    y += e.offsetTop;' . "\r\n" . '  }' . "\r\n" . '  return {"x": x, "y": y};' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//显示日历' . "\r\n" . 'Calendar.prototype.show = function (dateObj, popControl) {' . "\r\n" . '  if (dateObj == null){' . "\r\n" . '    throw new Error("arguments[0] is necessary")' . "\r\n" . '  }' . "\r\n" . '  this.dateControl = dateObj;' . "\r\n" . '  var now =  new Date();' . "\r\n" . '  this.date = (dateObj.value.length > 0) ? new Date(dateObj.value.toDate(this.dateFormatStyle)) : now.format(this.dateFormatStyle).toDate(this.dateFormatStyle) ;' . "\r\n" . '' . "\r\n" . '  if(this.panel.innerHTML==""||cal.dateFormatStyleOld != cal.dateFormatStyle)' . "\r\n" . '  {' . "\r\n" . '	this.draw();' . "\r\n" . '	this.bindYear();' . "\r\n" . '	this.bindMonth();' . "\r\n" . '	this.bindHour();' . "\r\n" . '	this.bindMinute();' . "\r\n" . '	this.bindSecond();' . "\r\n" . '  }' . "\r\n" . '  this.year = this.date.getFullYear();' . "\r\n" . '  this.month = this.date.getMonth();' . "\r\n" . '  this.day = this.date.getDate();' . "\r\n" . '  this.hour = this.date.getHours();' . "\r\n" . '  this.minute = this.date.getMinutes();' . "\r\n" . '  this.second = this.date.getSeconds();' . "\r\n" . '  this.changeSelect();' . "\r\n" . '  this.bindData();' . "\r\n" . '' . "\r\n" . '  if (popControl == null){' . "\r\n" . '    popControl = dateObj;' . "\r\n" . '  }' . "\r\n" . '  var xy = this.getAbsPoint(popControl);' . "\r\n" . '  this.panel.style.left = (xy.x + leftX)+ "px";' . "\r\n" . '  this.panel.style.top = (xy.y + topY + dateObj.offsetHeight) + "px";' . "\r\n" . '  ' . "\r\n" . '  this.panel.style.display = "";' . "\r\n" . '  this.container.style.display = "";' . "\r\n" . '  ' . "\r\n" . '  if( !this.dateControl.isTransEvent)' . "\r\n" . '  {' . "\r\n" . '	this.dateControl.isTransEvent = true;' . "\r\n" . '	if(this.dateControl.onblur != null){' . "\r\n" . '	this.dateControl.blurEvent = this.dateControl.onblur;}' . "\r\n" . '	this.dateControl.onblur = function()' . "\r\n" . '	{calendar.onblur();if(typeof(this.blurEvent) ==\'function\'){this.blurEvent();}' . "\r\n" . '	}' . "\r\n" . '  }' . "\r\n" . '  ' . "\r\n" . '  this.container.onmouseover = function(){isFocus=true;}' . "\r\n" . '  this.container.onmouseout = function(){isFocus=false;}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//隐藏日历' . "\r\n" . 'Calendar.prototype.hide = function() {' . "\r\n" . '  this.panel.style.display = "none";' . "\r\n" . '  this.container.style.display = "none";' . "\r\n" . '  isFocus=false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'Calendar.prototype.onblur = function() {' . "\r\n" . '    if(!isFocus){this.hide();}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function InitContainerPanel() //初始化容器' . "\r\n" . '{' . "\r\n" . '	var str = \'<div id="calendarPanel" style="position: absolute;display: none;z-index:9999; background-color: #FFFFFF;border: 1px solid #CCCCCC;width:175px;font-size:12px;"></div>\';' . "\r\n" . '	if(document.all)' . "\r\n" . '	{' . "\r\n" . '		str += \'<iframe style="position:absolute;z-index:2000;width:expression(this.previousSibling.offsetWidth);\';' . "\r\n" . '		str += \'height:expression(this.previousSibling.offsetHeight);\';' . "\r\n" . '		str += \'left:expression(this.previousSibling.offsetLeft);top:expression(this.previousSibling.offsetTop);\';' . "\r\n" . '		str += \'display:expression(this.previousSibling.style.display);" scrolling="no" frameborder="no"></iframe>\';' . "\r\n" . '	}' . "\r\n" . '	var div = document.createElement("div");' . "\r\n" . '	div.innerHTML = str;' . "\r\n" . '	div.id = "ContainerPanel";' . "\r\n" . '	div.style.display ="none";' . "\r\n" . '	document.body.appendChild(div);' . "\r\n" . '}';

?>
