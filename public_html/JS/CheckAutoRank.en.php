<?php
//dezend by http://www.yunlu99.com/
if ((ob_get_length() === false) && !ini_get('zlib.output_compression') && (ini_get('output_handler') != 'ob_gzhandler') && (ini_get('output_handler') != 'mb_output_handler')) {
	ob_start('ob_gzhandler');
}

header('Cache-Control: public');
header('Pragma: cache');
$offset = 2592000;
$ExpStr = 'Expires: ' . gmdate('D, d M Y H:i:s', time() + $offset) . ' GMT';
$LmStr = 'Last-Modified: ' . gmdate('D, d M Y H:i:s', filemtime(__FILE__)) . ' GMT';
header($ExpStr);
header($LmStr);
header('Content-Type: text/javascrīpt; charset: UTF-8');
echo '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRankSamePage(baseID,isList,questionID,theFirstID,theLastID)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rank_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						var theObj = $(\'#rankcheck_\'+baseID+\'_\'+questionID+\'_\'+objField.options[i].value);' . "\r\n" . '						if(theObj != null ){' . "\r\n" . '							//原值' . "\r\n" . '							var u = theObj.find("span.sortnum").html();' . "\r\n" . '							if( u != \'\' ){' . "\r\n" . '								//回显' . "\r\n" . '								theObj.find("span.sortnum").html("").removeClass("sortnum-chk");' . "\r\n" . '								//赋值' . "\r\n" . '								theObj.find("input.sortinput").val(\'\');' . "\r\n" . '								theObj.attr("check","");' . "\r\n" . '' . "\r\n" . '								//重新计算' . "\r\n" . '								$("#qtn_table_"+questionID).find("td[check=\'1\']").each(function(){' . "\r\n" . '									var w = $(this).find("span.sortnum").html();' . "\r\n" . '									if( w-u > 0){' . "\r\n" . '										//回显' . "\r\n" . '										$(this).find("span.sortnum").html(w-1);' . "\r\n" . '										//赋值' . "\r\n" . '										$(this).find("input.sortinput").val(w-1);' . "\r\n" . '									}' . "\r\n" . '								});' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '				    }' . "\r\n" . '			    }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   var theOptionObj = eval("document.getElementById(\'rank_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked ){theOptionObj.style.display = \'\';}' . "\r\n" . '				   else{' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						var theObj = $(\'#rankcheck_\'+baseID+\'_\'+questionID+\'_\'+objField[i].value);' . "\r\n" . '						if(theObj != null ){' . "\r\n" . '							//原值' . "\r\n" . '							var u = theObj.find("span.sortnum").html();' . "\r\n" . '							if( u != \'\' ){' . "\r\n" . '								//回显' . "\r\n" . '								theObj.find("span.sortnum").html("").removeClass("sortnum-chk");' . "\r\n" . '								//赋值' . "\r\n" . '								theObj.find("input.sortinput").val(\'\');' . "\r\n" . '								theObj.attr("check","");' . "\r\n" . '' . "\r\n" . '								//重新计算' . "\r\n" . '								$("#qtn_table_"+questionID).find("td[check=\'1\']").each(function(){' . "\r\n" . '									var w = $(this).find("span.sortnum").html();' . "\r\n" . '									if( w-u > 0){' . "\r\n" . '										//回显' . "\r\n" . '										$(this).find("span.sortnum").html(w-1);' . "\r\n" . '										//赋值' . "\r\n" . '										$(this).find("input.sortinput").val(w-1);' . "\r\n" . '									}' . "\r\n" . '								});' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '				    }' . "\r\n" . '			    }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRankNoSamePage(baseID,theAllValue,theSelectValue,questionID,theFirstID,theLastID)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    var theOptionObj = eval("document.getElementById(\'rank_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null ){' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i]+",") == -1 ){' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				var theObj = $(\'#rankcheck_\'+baseID+\'_\'+questionID+\'_\'+theAllValueArray[i]);' . "\r\n" . '				if(theObj != null ){' . "\r\n" . '					//原值' . "\r\n" . '					var u = theObj.find("span.sortnum").html();' . "\r\n" . '					if( u != \'\' ){' . "\r\n" . '						//回显' . "\r\n" . '						theObj.find("span.sortnum").html("").removeClass("sortnum-chk");' . "\r\n" . '						//赋值' . "\r\n" . '						theObj.find("input.sortinput").val(\'\');' . "\r\n" . '						theObj.attr("check","");' . "\r\n" . '' . "\r\n" . '						//重新计算' . "\r\n" . '						$("#qtn_table_"+questionID).find("td[check=\'1\']").each(function(){' . "\r\n" . '							var w = $(this).find("span.sortnum").html();' . "\r\n" . '							if( w-u > 0){' . "\r\n" . '								//回显' . "\r\n" . '								$(this).find("span.sortnum").html(w-1);' . "\r\n" . '								//赋值' . "\r\n" . '								$(this).find("input.sortinput").val(w-1);' . "\r\n" . '							}' . "\r\n" . '						});' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoRankSamePageIsNeg(baseID,isList,questionID,theFirstID,theLastID)' . "\r\n" . '{' . "\r\n" . '	 var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			 for( i=0;i<objField.options.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rank_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if( objField.options[i].selected != true && objField.options[i].value != \'\')' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						var theObj = $(\'#rankcheck_\'+baseID+\'_\'+questionID+\'_\'+objField.options[i].value);' . "\r\n" . '						if(theObj != null ){' . "\r\n" . '							//原值' . "\r\n" . '							var u = theObj.find("span.sortnum").html();' . "\r\n" . '							if( u != \'\' ){' . "\r\n" . '								//回显' . "\r\n" . '								theObj.find("span.sortnum").html("").removeClass("sortnum-chk");' . "\r\n" . '								//赋值' . "\r\n" . '								theObj.find("input.sortinput").val(\'\');' . "\r\n" . '								theObj.attr("check","");' . "\r\n" . '' . "\r\n" . '								//重新计算' . "\r\n" . '								$("#qtn_table_"+questionID).find("td[check=\'1\']").each(function(){' . "\r\n" . '									var w = $(this).find("span.sortnum").html();' . "\r\n" . '									if( w-u > 0){' . "\r\n" . '										//回显' . "\r\n" . '										$(this).find("span.sortnum").html(w-1);' . "\r\n" . '										//赋值' . "\r\n" . '										$(this).find("input.sortinput").val(w-1);' . "\r\n" . '									}' . "\r\n" . '								});' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '				    }' . "\r\n" . '			    }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			 for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			   theOptionObj = eval("document.getElementById(\'rank_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '			   if( theOptionObj != null ){' . "\r\n" . '				   if(objField[i].checked != true )' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '				   }' . "\r\n" . '				   else' . "\r\n" . '				   {' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						var theObj = $(\'#rankcheck_\'+baseID+\'_\'+questionID+\'_\'+objField[i].value);' . "\r\n" . '						if(theObj != null ){' . "\r\n" . '							//原值' . "\r\n" . '							var u = theObj.find("span.sortnum").html();' . "\r\n" . '							if( u != \'\' ){' . "\r\n" . '								//回显' . "\r\n" . '								theObj.find("span.sortnum").html("").removeClass("sortnum-chk");' . "\r\n" . '								//赋值' . "\r\n" . '								theObj.find("input.sortinput").val(\'\');' . "\r\n" . '								theObj.attr("check","");' . "\r\n" . '' . "\r\n" . '								//重新计算' . "\r\n" . '								$("#qtn_table_"+questionID).find("td[check=\'1\']").each(function(){' . "\r\n" . '									var w = $(this).find("span.sortnum").html();' . "\r\n" . '									if( w-u > 0){' . "\r\n" . '										//回显' . "\r\n" . '										$(this).find("span.sortnum").html(w-1);' . "\r\n" . '										//赋值' . "\r\n" . '										$(this).find("input.sortinput").val(w-1);' . "\r\n" . '									}' . "\r\n" . '								});' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '				    }' . "\r\n" . '			    }' . "\r\n" . '			}' . "\r\n" . '		} //End for if' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoRankNoSamePageIsNeg(baseID,theAllValue,theSelectValue,questionID,theFirstID,theLastID)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'rank_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null ){' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i] + ",") != -1 ){' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				var theObj = $(\'#rankcheck_\'+baseID+\'_\'+questionID+\'_\'+theAllValueArray[i]);' . "\r\n" . '				if(theObj != null ){' . "\r\n" . '					//原值' . "\r\n" . '					var u = theObj.find("span.sortnum").html();' . "\r\n" . '					if( u != \'\' ){' . "\r\n" . '						//回显' . "\r\n" . '						theObj.find("span.sortnum").html("").removeClass("sortnum-chk");' . "\r\n" . '						//赋值' . "\r\n" . '						theObj.find("input.sortinput").val(\'\');' . "\r\n" . '						theObj.attr("check","");' . "\r\n" . '' . "\r\n" . '						//重新计算' . "\r\n" . '						$("#qtn_table_"+questionID).find("td[check=\'1\']").each(function(){' . "\r\n" . '							var w = $(this).find("span.sortnum").html();' . "\r\n" . '							if( w-u > 0){' . "\r\n" . '								//回显' . "\r\n" . '								$(this).find("span.sortnum").html(w-1);' . "\r\n" . '								//赋值' . "\r\n" . '								$(this).find("input.sortinput").val(w-1);' . "\r\n" . '							}' . "\r\n" . '						});' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//移除排序题的值' . "\r\n" . 'function AutoRankUnInput(questionID)' . "\r\n" . '{' . "\r\n" . '	$("#qtn_table_"+questionID).find("td.optcont").each(function(){' . "\r\n" . '		var v = $(this).find("input.sortinput").val(\'\');' . "\r\n" . '	});' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//判断排序' . "\r\n" . 'function CheckAutoRank(questionID,strText,isRequired,minOption,maxOption)' . "\r\n" . '{' . "\r\n" . '	if( isRequired == 1 )' . "\r\n" . '	{' . "\r\n" . '		var isOrder = 0;' . "\r\n" . '		$("#qtn_table_"+questionID).find("td.optcont").each(function(){' . "\r\n" . '			var v = $(this).find("input.sortinput").val();' . "\r\n" . '			if(	v != \'\' ){' . "\r\n" . '				isOrder++;' . "\r\n" . '			}' . "\r\n" . '		});' . "\r\n" . '        if( minOption != 0 )' . "\r\n" . '		{		' . "\r\n" . '			if( isOrder < minOption)' . "\r\n" . '			{' . "\r\n" . '				$.notification( strText + ":the answer is less than " + minOption + " items!");' . "\r\n" . '				return false;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '		    if( isOrder < 1 )' . "\r\n" . '		    {' . "\r\n" . '				$.notification( strText + ":the answer is less than 1 item!");' . "\r\n" . '				return false;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '        if( maxOption != 0 )' . "\r\n" . '		{		' . "\r\n" . '			if( isOrder > maxOption)' . "\r\n" . '			{' . "\r\n" . '				$.notification( strText + ":the answer is more than " + maxOption + " items!");' . "\r\n" . '				return false;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}';

?>
