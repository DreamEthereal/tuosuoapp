<?php
//dezend by http://www.yunlu99.com/
if ((ob_get_length() === false) && !ini_get('zlib.output_compression') && (ini_get('output_handler') != 'ob_gzhandler') && (ini_get('output_handler') != 'mb_output_handler')) {
	ob_start('ob_gzhandler');
}

header('Cache-Control: public');
header('Pragma: cache');
$offset = 2592000;
$ExpStr = 'Expires: ' . gmdate('D, d M Y H:i:s', time() + $offset) . ' GMT';
$LmStr = 'Last-Modified: ' . gmdate('D, d M Y H:i:s', filemtime(__FILE__)) . ' GMT';
header($ExpStr);
header($LmStr);
header('Content-Type: text/javascrīpt; charset: UTF-8');
echo '' . "\r\n" . '//检查必填项' . "\r\n" . 'function CheckNotNull(objField, strText) {' . "\r\n" . '  if (Trim(objField.value) == "") {' . "\r\n" . '    objField.focus();' . "\r\n" . '    $.notification("" + strText + ":cannot null!");' . "\r\n" . '    return false;' . "\r\n" . '  }' . "\r\n" . '  return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//去除字符串左端空格' . "\r\n" . 'function LTrim(str) {' . "\r\n" . '  return str.replace(/^\\s*/, \'\');' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//去除字符串右端空格' . "\r\n" . 'function RTrim(str) {' . "\r\n" . '  return str.replace(/\\s*$/, \'\');' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//去除字符串两端空格' . "\r\n" . 'function Trim(str) {' . "\r\n" . '  return LTrim(RTrim(str));' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查字符串是否出现中文' . "\r\n" . 'function CheckNoChinese(objField, strText) {' . "\r\n" . '  if(objField.value == "") return true;' . "\r\n" . '  var RE = new RegExp("[^\\x01-\\x7F]");' . "\r\n" . '  if (objField.value.search(RE) != -1) {' . "\r\n" . '    objField.focus();' . "\r\n" . '    $.notification("" + strText + ":cannot be Chinese!");' . "\r\n" . '    return false;		' . "\r\n" . '  }' . "\r\n" . '  return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function CheckChinese(objField, strText) {' . "\r\n" . '   if(objField.value == "") return true;' . "\r\n" . '   var reg = /^[\\u4e00-\\u9fa5]+$/i;' . "\r\n" . '   if (reg.test(objField.value))' . "\r\n" . '   {' . "\r\n" . '	   return true;' . "\r\n" . '   }' . "\r\n" . '   else' . "\r\n" . '   {' . "\r\n" . '	   objField.focus();' . "\r\n" . '	   $.notification("" + strText + ":only for Chinese!");' . "\r\n" . '	   return false;' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查是否为数值' . "\r\n" . 'function CheckNumber(objField, strText, numMinValue, numMaxValue) {' . "\r\n" . '  if(objField.value == "") return true;' . "\r\n" . '  if(isNaN(objField.value)){' . "\r\n" . '    objField.focus();' . "\r\n" . '    $.notification("" + strText + ":only number is vaild!");' . "\r\n" . '    return false;' . "\r\n" . '  }' . "\r\n" . '  var numValue = parseFloat(objField.value);' . "\r\n" . '  if(numMinValue != null){' . "\r\n" . '    if(numValue < numMinValue){' . "\r\n" . '      objField.focus();' . "\r\n" . '      $.notification("" + strText + ":cannot less than " + numMinValue.toString() + "!");' . "\r\n" . '      return false;' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '  if(numMaxValue != null){' . "\r\n" . '    if(numValue > numMaxValue){' . "\r\n" . '      objField.focus();' . "\r\n" . '      $.notification("" + strText + ":cannot more than " + numMaxValue.toString() + "!");' . "\r\n" . '      return false;' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '  return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查为数值' . "\r\n" . 'function CheckIsValue(objField, strText, numMinValue, numMaxValue) {' . "\r\n" . '  if(objField.value == "") return true;' . "\r\n" . '  var reg=/^-?\\d+\\.?\\d*$/;' . "\r\n" . '  if (!reg.test(objField.value)) {' . "\r\n" . '    objField.focus();' . "\r\n" . '    $.notification("" + strText + ":only number is vaild!");' . "\r\n" . '    return false;' . "\r\n" . '  }' . "\r\n" . '  var numValue = parseFloat(objField.value);' . "\r\n" . '  if(numMinValue != null){' . "\r\n" . '    if(numValue < numMinValue){' . "\r\n" . '      objField.focus();' . "\r\n" . '      $.notification("" + strText + ":cannot less than " + numMinValue.toString() + "!");' . "\r\n" . '      return false;' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '  if(numMaxValue != null){' . "\r\n" . '    if(numValue > numMaxValue){' . "\r\n" . '      objField.focus();' . "\r\n" . '      $.notification("" + strText + ":cannot more than " + numMaxValue.toString() + "!");' . "\r\n" . '      return false;' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '  return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查字符串长度' . "\r\n" . 'function CheckStringLength(objField, strText, numMinLen, numMaxLen){' . "\r\n" . '  if(objField.value == "") return true;' . "\r\n" . '  if(numMinLen != null){' . "\r\n" . '    if(objField.value.length < numMinLen){' . "\r\n" . '      objField.focus();' . "\r\n" . '      $.notification("" + strText + ":cannot less than " + numMinLen.toString() + "!");' . "\r\n" . '      return false;' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '  if(numMaxLen != null){' . "\r\n" . '    if(objField.value.length > numMaxLen){' . "\r\n" . '      objField.focus();' . "\r\n" . '      $.notification("" + strText + ":cannot more than " + numMaxLen.toString() + "!");' . "\r\n" . '      return false;' . "\r\n" . '    }' . "\r\n" . '  }' . "\r\n" . '  return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查为Email' . "\r\n" . 'function CheckEmail(objField, strText)' . "\r\n" . '{' . "\r\n" . '  var objValue = Trim(objField.value);' . "\r\n" . '  if (objValue=="") return true;' . "\r\n" . '  var strErr = "" + strText + ":only email is vaild!";' . "\r\n" . '' . "\r\n" . '  var regex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;' . "\r\n" . '  var regy = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*/;' . "\r\n" . '  if (regex.test(objValue) || regy.test(objValue) ) ' . "\r\n" . '  {' . "\r\n" . '     var str = " !#$%^&*()+=|\\{[]}:;\'<,>?/" ;' . "\r\n" . '     var str2 = \'"\';' . "\r\n" . '     var result = true;' . "\r\n" . '     for (var j = 0; j < objValue.length; j++) {' . "\r\n" . '        if (str.indexOf(objValue.charAt(j)) != -1 || str2.indexOf(objValue.charAt(j)) != -1) {' . "\r\n" . '          result = false;' . "\r\n" . '          break; ' . "\r\n" . '        }' . "\r\n" . '     }' . "\r\n" . '     if (result == true) {' . "\r\n" . '        return true;' . "\r\n" . '     }' . "\r\n" . '     else {' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '        return false;		' . "\r\n" . '     }' . "\r\n" . '   } ' . "\r\n" . '   else {' . "\r\n" . '     objField.focus();' . "\r\n" . '	 $.notification(strErr);' . "\r\n" . '     return false;		' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测为电话号码' . "\r\n" . 'function CheckPhone(objField, strText) ' . "\r\n" . '{' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var strErr = "" + strText + ":only phone number is vaild!";' . "\r\n" . '	var reg=/(^[0-9]{3,4}\\-[0-9]{3,8}$)|(^[0-9]{7,11}$)|(^\\([0-9]{3,4}\\)[0-9]{3,8}$)|(^0{0,1}1(3|4|5|7|8)[0-9]{9}$)|(^(400|800)[0-9]{7}$)/;' . "\r\n" . '	if (!reg.exec(objValue)) {' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测为手机号码' . "\r\n" . 'function CheckMobile(objField, strText) ' . "\r\n" . '{' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var strErr = "" + strText + ":only cellphone number is vaild!";' . "\r\n" . '	var reg=/(^0{0,1}1(3|4|5|7|8)[0-9]{9}$)/;' . "\r\n" . '	if (!reg.exec(objValue)) {' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检验企业法人代码' . "\r\n" . 'function CheckCorpCode(objField, strText){' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var strErr = "" + strText + ":only enterprise code is vaild!";' . "\r\n" . '	var patrn=/^(\\d){15}$/;' . "\r\n" . '	if (!patrn.exec(objValue)) {' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//校验邮政编码' . "\r\n" . 'function CheckPostalCode(objField, strText)' . "\r\n" . '{' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var strErr = "" + strText + ":only postcode is invalid!";' . "\r\n" . '    var patrn=/^[0-9]{1}(\\d){5}$/;' . "\r\n" . '	if (!patrn.exec(objValue)) {' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//判断单选/复选必选' . "\r\n" . 'function CheckRadioNoClick(objField, strText)' . "\r\n" . '{' . "\r\n" . '	var strErr = "" + strText + ":you must give one choice at least!";' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if (objField.checked) return true;' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			objField.focus();' . "\r\n" . '			$.notification(strErr);' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		for (i=0;i<objField.length;i++){' . "\r\n" . '			if (objField[i].checked) return true;' . "\r\n" . '		}' . "\r\n" . '		objField[0].focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//移除单选/复选的选择值' . "\r\n" . 'function RadioUnClick(objField)' . "\r\n" . '{' . "\r\n" . '	var i;' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		objField.checked = false;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		for (i=0;i<objField.length;i++)' . "\r\n" . '		{' . "\r\n" . '			objField[i].checked = false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	objField.value=\'\';' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//移除输入框的值' . "\r\n" . 'function TextUnInput(objField)' . "\r\n" . '{' . "\r\n" . '	objField.value=\'\';' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//移除下拉框的值' . "\r\n" . 'function ListUnSelect(objField)' . "\r\n" . '{' . "\r\n" . '	var j=0;' . "\r\n" . '	for( i=0;i<objField.options.length;i++ ) ' . "\r\n" . '	{   ' . "\r\n" . '		objField.options[i].selected = false;' . "\r\n" . '	}' . "\r\n" . '	objField.value=\'\';' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测下拉必选' . "\r\n" . 'function CheckListNoSelect(objField, strText)' . "\r\n" . '{' . "\r\n" . '	for( i=0;i<objField.options.length;i++ ) {   ' . "\r\n" . '		if(objField.options[i].selected && objField.value != \'\') {   ' . "\r\n" . '		   return true;   ' . "\r\n" . '		}   ' . "\r\n" . '	} ' . "\r\n" . '	objField.focus();' . "\r\n" . '    $.notification( "" + strText + ":you must give one choice at least!");' . "\r\n" . '	return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测下拉最多几项' . "\r\n" . 'function CheckListMaxSelect(objField, strText,maxNum )' . "\r\n" . '{' . "\r\n" . '	var j=0;   ' . "\r\n" . '	for( i=0;i<objField.options.length;i++ ) {   ' . "\r\n" . '		if(objField.options[i].selected) {   ' . "\r\n" . '		   j=j+1;   ' . "\r\n" . '		}   ' . "\r\n" . '	} ' . "\r\n" . '	if( j > maxNum ){' . "\r\n" . '		objField[0].focus();' . "\r\n" . '		$.notification("" + strText + ":the answer you have selected is more than "+ maxNum + "!");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	else {' . "\r\n" . '		if( j==0 )	{' . "\r\n" . '			objField[0].focus();' . "\r\n" . '			$.notification("" + strText + ":you must give one choice at least!" );   ' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '		else return true;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测下拉最少几项' . "\r\n" . 'function CheckListMinSelect(objField, strText,minNum )' . "\r\n" . '{' . "\r\n" . '	var j=0;   ' . "\r\n" . '	for( i=0;i<objField.options.length;i++ ){   ' . "\r\n" . '		if(objField.options[i].selected){   ' . "\r\n" . '		   j=j+1;   ' . "\r\n" . '		}   ' . "\r\n" . '	} ' . "\r\n" . '	if( j < minNum ){' . "\r\n" . '		objField[0].focus();' . "\r\n" . '		$.notification("" + strText + ":the answer you have selected is less than "+ minNum + "!");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	else{' . "\r\n" . '		if( j==0 ){' . "\r\n" . '			objField[0].focus();' . "\r\n" . '			$.notification("" + strText + ":you must give one choice at least!" );   ' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '		else return true;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测值在复选下拉选中' . "\r\n" . 'function IsInSelectedList(objField,optionValue )' . "\r\n" . '{' . "\r\n" . '   for( i=0;i<objField.options.length;i++ )' . "\r\n" . '   {' . "\r\n" . '	  if( objField.item(i).selected && objField.item(i).value == optionValue )' . "\r\n" . '	  {' . "\r\n" . '	     return true;' . "\r\n" . '	  }' . "\r\n" . '	}' . "\r\n" . '	return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function IsInCheckBox(objField,optionValue )' . "\r\n" . '{' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if(objField.checked && objField.value == optionValue ) return true; ' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		for( i=0;i<objField.length;i++ ) {' . "\r\n" . '			if(objField[i].checked && objField[i].value == optionValue) {   ' . "\r\n" . '			   return true;   ' . "\r\n" . '			}   ' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测为短日期' . "\r\n" . 'function CheckDate(objField, strText)' . "\r\n" . '{' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var strErr = "" + strText + ":only date is invalid, valid format is 2007-10-1 !";' . "\r\n" . '    var r = objValue.match(/^(\\d{1,4})(-|\\/)(\\d{1,2})\\2(\\d{1,2})$/); ' . "\r\n" . '    if( r==null) {' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '	    return false; ' . "\r\n" . '	}' . "\r\n" . '	var d= new Date(r[1], r[3]-1, r[4]); ' . "\r\n" . '	var B = d.getFullYear()==r[1]&&(d.getMonth()+1)==r[3]&&d.getDate()==r[4];' . "\r\n" . '    if( !B )' . "\r\n" . '	{' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '	    return false; ' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测为时间' . "\r\n" . 'function CheckTime(objField, strText)' . "\r\n" . '{' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var strErr = "" + strText + ":only time is invalid, valid format is 23:13 !";' . "\r\n" . '	if( !isValidTime(objValue) ) { ' . "\r\n" . '	    objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '	    return false; ' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function isValidTime(value) {' . "\r\n" . '   var colonCount = 0;' . "\r\n" . '   var hasMeridian = false;' . "\r\n" . '   for (var i=0; i<value.length; i++) {' . "\r\n" . '      var ch = value.substring(i, i+1);' . "\r\n" . '      if ( (ch < \'0\') || (ch > \'9\') ) {' . "\r\n" . '         if ( (ch != \':\') && (ch != \' \') && (ch != \'a\') && (ch != \'A\') && (ch != \'p\') && (ch != \'P\') && (ch != \'m\') && (ch != \'M\')) {' . "\r\n" . '            return false;' . "\r\n" . '         }' . "\r\n" . '      }' . "\r\n" . '      if (ch == \':\') { colonCount++; }' . "\r\n" . '      if ( (ch == \'p\') || (ch == \'P\') || (ch == \'a\') || (ch == \'A\') ) { hasMeridian = true; }' . "\r\n" . '   }' . "\r\n" . '   if ( (colonCount < 1) || (colonCount > 2) ) { return false; }' . "\r\n" . '   var hh = value.substring(0, value.indexOf(":"));' . "\r\n" . '   if ( (parseFloat(hh) < 0) || (parseFloat(hh) > 23) ) { return false; }' . "\r\n" . '   if (hasMeridian) {' . "\r\n" . '      if ( (parseFloat(hh) < 1) || (parseFloat(hh) > 12) ) { return false; }' . "\r\n" . '   }' . "\r\n" . '   if (colonCount == 2) {' . "\r\n" . '      var mm = value.substring(value.indexOf(":")+1, value.lastIndexOf(":"));' . "\r\n" . '   } else {' . "\r\n" . '      var mm = value.substring(value.indexOf(":")+1, value.length);' . "\r\n" . '   }' . "\r\n" . '   if ( (parseFloat(mm) < 0) || (parseFloat(mm) > 59) ) { return false; }' . "\r\n" . '   if (colonCount == 2) {' . "\r\n" . '      var ss = value.substring(value.lastIndexOf(":")+1, value.length);' . "\r\n" . '   } else {' . "\r\n" . '      var ss = "00";' . "\r\n" . '   }' . "\r\n" . '   if ( (parseFloat(ss) < 0) || (parseFloat(ss) > 59) ) { return false; }' . "\r\n" . '   return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测为身份证号' . "\r\n" . 'function CheckIDCardNo(objField, strText)' . "\r\n" . '{' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var len = objValue.length, re; ' . "\r\n" . '	if (len == 15)' . "\r\n" . '		re = new RegExp(/^(\\d{6})()?(\\d{2})(\\d{2})(\\d{2})(\\d{3})$/);' . "\r\n" . '	else if (len == 18)' . "\r\n" . '	{' . "\r\n" . '	    re = new RegExp(/^(\\d{6})()?(\\d{4})(\\d{2})(\\d{2})(\\d{3})[x|X|(\\d{1})]$/);' . "\r\n" . '	}' . "\r\n" . '	else {' . "\r\n" . '       objField.focus();' . "\r\n" . '	   $.notification("" + strText + ":the length of your input is invalid!"); ' . "\r\n" . '       return false;' . "\r\n" . '	}' . "\r\n" . '	var a = objValue.match(re);' . "\r\n" . '	if (a != null)' . "\r\n" . '	{' . "\r\n" . '		if (len==15)' . "\r\n" . '		{' . "\r\n" . '			var D = new Date("19"+a[3]+"/"+a[4]+"/"+a[5]);' . "\r\n" . '			var B = D.getYear()==a[3]&&(D.getMonth()+1)==a[4]&&D.getDate()==a[5];' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			var D = new Date(a[3]+"/"+a[4]+"/"+a[5]);' . "\r\n" . '			var B = D.getFullYear()==a[3]&&(D.getMonth()+1)==a[4]&&D.getDate()==a[5];' . "\r\n" . '		}' . "\r\n" . '		if (!B) {' . "\r\n" . '			objField.focus();' . "\r\n" . '			$.notification("" + strText + ":"+ a[0] +" the date information of your input is invalid!"); ' . "\r\n" . '            return false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '       objField.focus();' . "\r\n" . '	   $.notification("" + strText + ":the idcard number is invalid!");' . "\r\n" . '       return false;' . "\r\n" . '	}' . "\r\n" . '' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测文件上传类型与大小' . "\r\n" . 'function CheckFileTypeSize(objField,strText,allowExt,maxSize)' . "\r\n" . '{' . "\r\n" . '	FileExt = objField.value.substr(objField.value.lastIndexOf(".")).toLowerCase();' . "\r\n" . '	if( allowExt.indexOf(FileExt + "|") == -1) ' . "\r\n" . '	{' . "\r\n" . '		objField.focus();' . "\r\n" . '	    $.notification( "" + strText + ":only extension name with " + allowExt + " is accecpted!");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//清除文件选择框的值' . "\r\n" . 'function FileUnSelect(objField)' . "\r\n" . '{' . "\r\n" . '	objField.outerHTML = objField.outerHTML;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getID(_sId){' . "\r\n" . '	return document.getElementById(_sId);' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查某值在某字符串中' . "\r\n" . 'function isInValueList(theValue,valueList)' . "\r\n" . '{' . "\r\n" . '    if( Trim(valueList) == "" )  return false;' . "\r\n" . '	var valueArray = valueList.split(\',\');' . "\r\n" . '	for( i=0;i<valueArray.length;i++ ){   ' . "\r\n" . '		if( valueArray[i]== theValue ){   ' . "\r\n" . '		   return true;   ' . "\r\n" . '		}   ' . "\r\n" . '	}' . "\r\n" . '	return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//得到单选复选的值' . "\r\n" . 'function getRadioCheckBoxValue(objField)' . "\r\n" . '{' . "\r\n" . '	var theSelectedValue = \'\';' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if( objField.tagName.toLowerCase() == \'input\')' . "\r\n" . '		{' . "\r\n" . '			if (objField.checked)  theSelectedValue = objField.value + \',\';' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ){' . "\r\n" . '			  if( objField.item(i).selected )  theSelectedValue +=  objField.item(i).value + \',\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		if( objField[0].tagName.toLowerCase() == \'input\')' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.length;i++){' . "\r\n" . '				if (objField[i].checked)  theSelectedValue += objField[i].value + \',\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ){' . "\r\n" . '			  if( objField.item(i).selected )  theSelectedValue +=  objField.item(i).value + \',\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	return theSelectedValue.substr(0,theSelectedValue.length-1);' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//得到复选选项数量' . "\r\n" . 'function getCheckBoxSelNum(objField)' . "\r\n" . '{' . "\r\n" . '	var theSelectedNum = 0;' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if( objField.tagName.toLowerCase() == \'input\')' . "\r\n" . '		{' . "\r\n" . '			if (objField.checked)  theSelectedNum++;' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ){' . "\r\n" . '			  if( objField.item(i).selected )  theSelectedNum++;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		if( objField[0].tagName.toLowerCase() == \'input\')' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.length;i++){' . "\r\n" . '				if (objField[i].checked)  theSelectedNum++;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ){' . "\r\n" . '			  if( objField.item(i).selected )  theSelectedNum++;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	return theSelectedNum;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//得到评分题的选中值' . "\r\n" . 'function getRatingValue(objField)' . "\r\n" . '{' . "\r\n" . '	var theSelectedValue = 0;' . "\r\n" . '	for( i=0;i<objField.length;i++){' . "\r\n" . '		if (objField[i].checked)  theSelectedValue = objField[i].value;' . "\r\n" . '    }' . "\r\n" . '	return theSelectedValue;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//排除性选项' . "\r\n" . 'function theExcludeItem(objField,theOptionOrderID,isSelect)' . "\r\n" . '{' . "\r\n" . '	if( isSelect == 1 )  //列表框' . "\r\n" . '	{' . "\r\n" . '	   var theSelectID = theOptionOrderID+1;' . "\r\n" . '	   if(objField.item(theSelectID).selected)' . "\r\n" . '	   {' . "\r\n" . '	   	   for( i=0;i<theSelectID;i++ )' . "\r\n" . '		   {' . "\r\n" . '			  objField.options[i].selected = false;' . "\r\n" . '		   }	   ' . "\r\n" . '	   }' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '	   if(objField[theOptionOrderID].checked == true)' . "\r\n" . '	   {' . "\r\n" . '		   for (i=0;i<theOptionOrderID;i++)' . "\r\n" . '		   {' . "\r\n" . '				objField[i].checked = false;' . "\r\n" . '				objField[i].disabled = true;' . "\r\n" . '		   }' . "\r\n" . '	   }' . "\r\n" . '	   else' . "\r\n" . '	   {' . "\r\n" . '		   for (i=0;i<theOptionOrderID;i++)' . "\r\n" . '		   {' . "\r\n" . '				objField[i].disabled = false;' . "\r\n" . '		   }' . "\r\n" . '	   }' . "\r\n" . '	 }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//互斥' . "\r\n" . 'function isExcludeItem(objField,theOptionOrderID,maxOptionNum)' . "\r\n" . '{' . "\r\n" . '	 if(objField[theOptionOrderID].checked == true)' . "\r\n" . '	 {' . "\r\n" . '		 for (i=0;i<maxOptionNum;i++)' . "\r\n" . '		 {' . "\r\n" . '			if( i != theOptionOrderID)' . "\r\n" . '			{' . "\r\n" . '				objField[i].checked = false;' . "\r\n" . '				objField[i].disabled = true;' . "\r\n" . '		    }' . "\r\n" . '		 }' . "\r\n" . '	 }' . "\r\n" . '	 else' . "\r\n" . '	 {' . "\r\n" . '	     if( objField[theOptionOrderID].disabled != true )' . "\r\n" . '		 {' . "\r\n" . '			 for (i=0;i<maxOptionNum;i++)' . "\r\n" . '			 {' . "\r\n" . '				objField[i].disabled = false;' . "\r\n" . '			 }' . "\r\n" . '		 }' . "\r\n" . '	 }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function isExcludeGroupItem(objField,theOptionOrderID,optionOrderList)' . "\r\n" . '{' . "\r\n" . '	 if(optionOrderList != \'\' )' . "\r\n" . '	 {' . "\r\n" . '		 var theOptionOrderList = optionOrderList.split(\',\');' . "\r\n" . '		 if(objField[theOptionOrderID].checked == true)' . "\r\n" . '		 {' . "\r\n" . '			 for (var o in theOptionOrderList)' . "\r\n" . '			 {' . "\r\n" . '				 var tmp = theOptionOrderList[o];' . "\r\n" . '				 if( tmp != theOptionOrderID )' . "\r\n" . '				 {' . "\r\n" . '					 objField[tmp].checked = false;' . "\r\n" . '					 objField[tmp].disabled = true;' . "\r\n" . '				 }' . "\r\n" . '			 }' . "\r\n" . '		 }' . "\r\n" . '		 else' . "\r\n" . '		 {' . "\r\n" . '			 if( objField[theOptionOrderID].disabled != true )' . "\r\n" . '			 {' . "\r\n" . '				 for (var o in theOptionOrderList)' . "\r\n" . '				 {' . "\r\n" . '					 var tmp = theOptionOrderList[o];' . "\r\n" . '					 objField[tmp].disabled = false;' . "\r\n" . '				 }' . "\r\n" . '			 }' . "\r\n" . '		 }' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检查矩阵填空' . "\r\n" . 'function CheckMultipleText(qtnID,labelID,minOptionID,maxOptionID,strText)' . "\r\n" . '{' . "\r\n" . '    for(i=minOptionID;i<=maxOptionID;i++)' . "\r\n" . '	{' . "\r\n" . '	    objField = eval("document.Survey_Form.option_" + qtnID + "_" + i + "_" + labelID );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '		   if (Trim(objField.value) != "")' . "\r\n" . '		   {' . "\r\n" . '			  return true;' . "\r\n" . '		   }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var theObjIn = eval("document.getElementById(\'question_"+qtnID+"\')");' . "\r\n" . '	theObjIn.scrollIntoView(true);' . "\r\n" . '	theObjIn.focus();' . "\r\n" . '    $.notification("" + strText + ":cannot null!");' . "\r\n" . '    return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//以下函数处理答案带入问题' . "\r\n" . 'function getRadioOptionText(objField,theBaseID,theQtnID,theBaseType,inType)' . "\r\n" . '{' . "\r\n" . '   var theObjField = eval("document.Survey_Form." + objField);' . "\r\n" . '   if( theObjField != null )' . "\r\n" . '   {' . "\r\n" . '	   var theBaseValue = getRadioCheckBoxValue(theObjField);' . "\r\n" . '	   var theBaseOptionID = eval("document.getElementById(\'optionName_" + theBaseType + "_" + theBaseID + "_" + theBaseValue +"\')");' . "\r\n" . '	   if( inType == 1 )  var nodeName = \'node_\';' . "\r\n" . '	   else  var nodeName = \'tips_\';' . "\r\n" . '	   if( theBaseOptionID != null )' . "\r\n" . '	   {' . "\r\n" . '		  var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID+"\']");' . "\r\n" . '		  var length = obj.length;' . "\r\n" . '		  for(var i = 0;i <length;i++){' . "\r\n" . '			  obj[i].innerHTML = theBaseOptionID.innerText;' . "\r\n" . '		  }' . "\r\n" . '	   }' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getSelectOptionText(objField,theBaseID,theQtnID,inType)' . "\r\n" . '{' . "\r\n" . '   var theObjField = eval("document.Survey_Form." + objField);' . "\r\n" . '   if( theObjField != null )' . "\r\n" . '   {' . "\r\n" . '	   var theQtnText = \'\';' . "\r\n" . '	   for( i=0;i<theObjField.options.length;i++ ){' . "\r\n" . '		  if( theObjField.item(i).selected && theObjField.value != \'\' ){' . "\r\n" . '		      theQtnText =  theObjField.item(i).text;' . "\r\n" . '			  break;' . "\r\n" . '		  }' . "\r\n" . '	   }' . "\r\n" . '	   if( inType == 1 )  var nodeName = \'node_\';' . "\r\n" . '	   else  var nodeName = \'tips_\';' . "\r\n" . '	   var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID+"\']");' . "\r\n" . '	   var length = obj.length;' . "\r\n" . '	   for(var i = 0;i <length;i++){' . "\r\n" . '		   obj[i].innerHTML = theQtnText;' . "\r\n" . '	   }' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoOptionText(objField,theBaseID,theQtnID,inType)' . "\r\n" . '{' . "\r\n" . '   var theObjField = eval("document.Survey_Form." + objField);' . "\r\n" . '   if( theObjField != null )' . "\r\n" . '   {' . "\r\n" . '	   var theBaseValue = getRadioCheckBoxValue(theObjField);' . "\r\n" . '	   var theBaseOptionID = eval("document.getElementById(\'textNode_" + theBaseID + "_" + theBaseValue +"\')");' . "\r\n" . '	   if( inType == 1 )  var nodeName = \'node_\';' . "\r\n" . '	   else  var nodeName = \'tips_\';' . "\r\n" . '	   if( theBaseOptionID != null )' . "\r\n" . '	   {' . "\r\n" . '		  var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID+"\']");' . "\r\n" . '		  var length = obj.length;' . "\r\n" . '		  for(var i = 0;i <length;i++){' . "\r\n" . '			  obj[i].innerHTML = theBaseOptionID.innerText;' . "\r\n" . '		  }' . "\r\n" . '	   }' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getInputTextValue(objField,theBaseID,theQtnID,inType)' . "\r\n" . '{' . "\r\n" . '   var theObjField = eval("document.Survey_Form." + objField);' . "\r\n" . '   if( theObjField != null )' . "\r\n" . '   {' . "\r\n" . '	   if( inType == 1 )  var nodeName = \'node_\';' . "\r\n" . '	   else  var nodeName = \'tips_\';' . "\r\n" . '	   var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID+"\']");' . "\r\n" . '	   var length = obj.length;' . "\r\n" . '	   for(var i = 0;i <length;i++){' . "\r\n" . '		   obj[i].innerHTML = theObjField.value;' . "\r\n" . '	   }' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getRangeInputTextValue(objField,theBaseID,theQtnID,theOptionID,inType)' . "\r\n" . '{' . "\r\n" . '   var theObjField = eval("document.Survey_Form." + objField);' . "\r\n" . '   if( theObjField != null )' . "\r\n" . '   {' . "\r\n" . '	   if( inType == 1 )  var nodeName = \'node_\';' . "\r\n" . '	   else  var nodeName = \'tips_\';' . "\r\n" . '	   var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID+ "_" + theOptionID+"\']");' . "\r\n" . '	   var length = obj.length;' . "\r\n" . '	   for(var i = 0;i <length;i++){' . "\r\n" . '		   obj[i].innerHTML = theObjField.value;' . "\r\n" . '	   }' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getRangeInputTextValue(objField,theBaseID,theQtnID,theOptionID,inType)' . "\r\n" . '{' . "\r\n" . '   var theObjField = eval("document.Survey_Form." + objField);' . "\r\n" . '   if( theObjField != null )' . "\r\n" . '   {' . "\r\n" . '	   if( inType == 1 )  var nodeName = \'node_\';' . "\r\n" . '	   else  var nodeName = \'tips_\';' . "\r\n" . '	   var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID+ "_" + theOptionID+"\']");' . "\r\n" . '	   var length = obj.length;' . "\r\n" . '	   for(var i = 0;i <length;i++){' . "\r\n" . '		   obj[i].innerHTML = theObjField.value;' . "\r\n" . '	   }' . "\r\n" . '   }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getCombTextRandText(objField,theBaseID,theQtnID,inType)' . "\r\n" . '{' . "\r\n" . '	var theObjArray = objField.split(\',\');' . "\r\n" . '	var theExistValueArray = [];' . "\r\n" . '	for(var i=0;i<theObjArray.length;i++)' . "\r\n" . '	{' . "\r\n" . '		var theObjField = eval("document.Survey_Form.option_" + theBaseID + "_" +theObjArray[i]);' . "\r\n" . '		if( theObjField != null )' . "\r\n" . '		{' . "\r\n" . '			if( Trim(theObjField.value) != \'\' )' . "\r\n" . '			{' . "\r\n" . '				theExistValueArray.push(Trim(theObjField.value));' . "\r\n" . '			}' . "\r\n" . '		}	' . "\r\n" . '	}' . "\r\n" . '	if( theExistValueArray.length != 0 )' . "\r\n" . '	{' . "\r\n" . '		var theAfterRandKey = array_data_rand(theExistValueArray,1);' . "\r\n" . '		if( inType == 1 )  var nodeName = \'knode_\';' . "\r\n" . '		else  var nodeName = \'ktips_\';' . "\r\n" . '		var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID+"\']");' . "\r\n" . '		var length = obj.length;' . "\r\n" . '		for(var i = 0;i <length;i++){' . "\r\n" . '		   obj[i].innerHTML = theExistValueArray[theAfterRandKey];' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getMultipleTextRandText(objField,theBaseID,theQtnID,theOptionID,inType)' . "\r\n" . '{' . "\r\n" . '	var theObjArray = objField.split(\',\');' . "\r\n" . '	var theExistValueArray = [];' . "\r\n" . '	for(var i=0;i<theObjArray.length;i++)' . "\r\n" . '	{' . "\r\n" . '		var theObjField = eval("document.Survey_Form.option_" + theBaseID + "_" +theObjArray[i] + "_" +theOptionID);' . "\r\n" . '		if( theObjField != null )' . "\r\n" . '		{' . "\r\n" . '			if( Trim(theObjField.value) != \'\' )' . "\r\n" . '			{' . "\r\n" . '				theExistValueArray.push(Trim(theObjField.value));' . "\r\n" . '			}' . "\r\n" . '		}	' . "\r\n" . '	}' . "\r\n" . '	if( theExistValueArray.length != 0 )' . "\r\n" . '	{' . "\r\n" . '		var theAfterRandKey = array_data_rand(theExistValueArray,1);' . "\r\n" . '		if( inType == 1 )  var nodeName = \'knode_\';' . "\r\n" . '		else  var nodeName = \'ktips_\';' . "\r\n" . '		var obj = $("span[class=\'"+nodeName+theQtnID + \'_\' + theBaseID + \'_\' + theOptionID+"\']");' . "\r\n" . '		var length = obj.length;' . "\r\n" . '		for(var i = 0;i <length;i++){' . "\r\n" . '		   obj[i].innerHTML = theExistValueArray[theAfterRandKey];' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function array_data_rand (input, num_req) {' . "\r\n" . '    var indexes = [];' . "\r\n" . '    var ticks = num_req || 1;' . "\r\n" . '    var checkDuplicate = function (input, value) {' . "\r\n" . '        var exist = false,' . "\r\n" . '            index = 0,' . "\r\n" . '            il = input.length;' . "\r\n" . '        while (index < il) {' . "\r\n" . '            if (input[index] === value) {' . "\r\n" . '                exist = true;' . "\r\n" . '                break;' . "\r\n" . '            }' . "\r\n" . '            index++;' . "\r\n" . '        }' . "\r\n" . '        return exist;' . "\r\n" . '    };' . "\r\n" . ' ' . "\r\n" . '    if (Object.prototype.toString.call(input) === \'[object Array]\' && ticks <= input.length) {' . "\r\n" . '        while (true) {' . "\r\n" . '            var rand = Math.floor((Math.random() * input.length));' . "\r\n" . '            if (indexes.length === ticks) {' . "\r\n" . '                break;' . "\r\n" . '            }' . "\r\n" . '            if (!checkDuplicate(indexes, rand)) {' . "\r\n" . '                indexes.push(rand);' . "\r\n" . '            }' . "\r\n" . '        }' . "\r\n" . '    } else {' . "\r\n" . '        indexes = null;' . "\r\n" . '    }' . "\r\n" . ' ' . "\r\n" . '    return ((ticks == 1) ? indexes.join() : indexes);' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function checkIsAlphabetValid()' . "\r\n" . '{' . "\r\n" . '	if (event.keyCode<48 || event.keyCode>126)' . "\r\n" . '	{' . "\r\n" . '		event.keyCode=0;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测为网址' . "\r\n" . 'function CheckURL(objField, strText) ' . "\r\n" . '{' . "\r\n" . '    var objValue = Trim(objField.value);' . "\r\n" . '    if (objValue=="") return true;' . "\r\n" . '	var strErr = "" + strText + ":the URL is invalid!";' . "\r\n" . '	//var reg=/^([hH][tT]{2}[pP]:\\/\\/|[hH][tT]{2}[pP][sS]:\\/\\/)*[A-Za-z0-9]+\\.[A-Za-z0-9]+[\\/=\\?%\\-&_~`@[\\]\\\':+!]*([^<>\\"\\"])*$/;' . "\r\n" . '	var reg = /^((http|https):\\/\\/)*(([a-zA-Z0-9$\\-_.+!*\'(),;:&=]|%[0-9a-fA-F]{2})+@)?(((25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])(\\.(25[0-5]|2[0-4][0-9]|[0-1][0-9][0-9]|[1-9][0-9]|[0-9])){3})|localhost|([a-zA-Z0-9\\-\\u00C0-\\u017F]+\\.)+([a-zA-Z]{2,}))(:[0-9]+)?(\\/(([a-zA-Z0-9$\\-_.+!*\'(),;:@&=]|%[0-9a-fA-F]{2})*(\\/([a-zA-Z0-9$\\-_.+!*\'(),;:@&=]|%[0-9a-fA-F]{2})*)*)?(\\?([a-zA-Z0-9$\\-_.+!*\'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?(\\#([a-zA-Z0-9$\\-_.+!*\'(),;:@&=\\/?]|%[0-9a-fA-F]{2})*)?)?$/;' . "\r\n" . '	if (!reg.test(objValue)) {' . "\r\n" . '        objField.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//计算可分配的比重值' . "\r\n" . 'function ReCalcSum(questionID,minOptionNum,maxOptionNum,maxNum)' . "\r\n" . '{' . "\r\n" . '    var obj,optionTotalNum = 0;' . "\r\n" . '	for(i=minOptionNum;i<=maxOptionNum;i++)' . "\r\n" . '	{' . "\r\n" . '	    obj = eval("document.Survey_Form.option_" + questionID + "_" + i );' . "\r\n" . '		var objValue = Trim(obj.value);' . "\r\n" . '		if( obj != null && objValue != \'\' )' . "\r\n" . '		{' . "\r\n" . '			if( !isNaN(parseFloat(objValue)) )' . "\r\n" . '			{' . "\r\n" . '				optionTotalNum = accAdd(optionTotalNum,parseFloat(objValue));' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '    var rtnValue = accSub(maxNum,optionTotalNum);' . "\r\n" . '	var tarObj = eval("document.Survey_Form.option_" + questionID + "_total");' . "\r\n" . '	tarObj.value = rtnValue.toString();' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//加法函数，用来得到精确的加法结果' . "\r\n" . 'function accAdd(arg1, arg2) {' . "\r\n" . '    var r1, r2, m, c;' . "\r\n" . '    try {' . "\r\n" . '        r1 = arg1.toString().split(".")[1].length;' . "\r\n" . '    }' . "\r\n" . '    catch (e) {' . "\r\n" . '        r1 = 0;' . "\r\n" . '    }' . "\r\n" . '    try {' . "\r\n" . '        r2 = arg2.toString().split(".")[1].length;' . "\r\n" . '    }' . "\r\n" . '    catch (e) {' . "\r\n" . '        r2 = 0;' . "\r\n" . '    }' . "\r\n" . '    c = Math.abs(r1 - r2);' . "\r\n" . '    m = Math.pow(10, Math.max(r1, r2));' . "\r\n" . '    if (c > 0) {' . "\r\n" . '        var cm = Math.pow(10, c);' . "\r\n" . '        if (r1 > r2) {' . "\r\n" . '            arg1 = Number(arg1.toString().replace(".", ""));' . "\r\n" . '            arg2 = Number(arg2.toString().replace(".", "")) * cm;' . "\r\n" . '        } else {' . "\r\n" . '            arg1 = Number(arg1.toString().replace(".", "")) * cm;' . "\r\n" . '            arg2 = Number(arg2.toString().replace(".", ""));' . "\r\n" . '        }' . "\r\n" . '    } else {' . "\r\n" . '        arg1 = Number(arg1.toString().replace(".", ""));' . "\r\n" . '        arg2 = Number(arg2.toString().replace(".", ""));' . "\r\n" . '    }' . "\r\n" . '    return (arg1 + arg2) / m;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//减法函数，用来得到精确的减法结果' . "\r\n" . 'function accSub(arg1, arg2) {' . "\r\n" . '    var r1, r2, m, n;' . "\r\n" . '    try {' . "\r\n" . '        r1 = arg1.toString().split(".")[1].length;' . "\r\n" . '    }' . "\r\n" . '    catch (e) {' . "\r\n" . '        r1 = 0;' . "\r\n" . '    }' . "\r\n" . '    try {' . "\r\n" . '        r2 = arg2.toString().split(".")[1].length;' . "\r\n" . '    }' . "\r\n" . '    catch (e) {' . "\r\n" . '        r2 = 0;' . "\r\n" . '    }' . "\r\n" . '    m = Math.pow(10, Math.max(r1, r2)); //last modify by deeka //动态控制精度长度' . "\r\n" . '    n = (r1 >= r2) ? r1 : r2;' . "\r\n" . '    return ((arg1 * m - arg2 * m) / m).toFixed(n);' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//计算矩阵单选的回复是互斥的' . "\r\n" . 'function unique(dataarr){ ' . "\r\n" . '	dataarr = dataarr || []; ' . "\r\n" . '	var a = {}; ' . "\r\n" . '	var len = dataarr.length; ' . "\r\n" . '	for (var i=0; i<len;i++){ ' . "\r\n" . '	   var v = dataarr[i]; ' . "\r\n" . '	   if (typeof(a[v]) == \'undefined\'){ ' . "\r\n" . '	     a[v] = 1; ' . "\r\n" . '	   }' . "\r\n" . '	}; ' . "\r\n" . '	dataarr.length=0; ' . "\r\n" . '	for (var i in a){ ' . "\r\n" . '	   dataarr[dataarr.length] = i; ' . "\r\n" . '	} ' . "\r\n" . '	return dataarr; ' . "\r\n" . '} ' . "\r\n" . '	' . "\r\n" . 'function CheckRangeExclusive(questionID,minOptionId,maxOptionId,questionName)' . "\r\n" . '{' . "\r\n" . '    var obj,kj = 0;' . "\r\n" . '	var oriValueArray = new Array();' . "\r\n" . '' . "\r\n" . '	//得到原值数组' . "\r\n" . '	for( var ki=minOptionId;ki<=maxOptionId;ki++)' . "\r\n" . '	{' . "\r\n" . '		obj = eval("document.Survey_Form.option_" + questionID + "_" + ki );' . "\r\n" . '		if( obj != null )' . "\r\n" . '		{' . "\r\n" . '			if( getRadioCheckBoxValue(obj) != \'\' )' . "\r\n" . '			{' . "\r\n" . '				oriValueArray[kj] = getRadioCheckBoxValue(obj);' . "\r\n" . '				kj++;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var oriValueArrayLength = oriValueArray.length;' . "\r\n" . '	var delValueArrayLength = unique(oriValueArray).length;' . "\r\n" . '' . "\r\n" . '	if( oriValueArrayLength != delValueArrayLength )' . "\r\n" . '	{' . "\r\n" . '		var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '		theObjIn.scrollIntoView(true);' . "\r\n" . '		theObjIn.focus();' . "\r\n" . '		var strErr = "" + questionName + ":each matrix question requires a different reply!";' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function CheckRangeIsContInvalid(questionID,minOptionId,maxOptionId,questionName,contInvalidValue)' . "\r\n" . '{' . "\r\n" . '    var obj,kj = 0;' . "\r\n" . '	var oriValueArray = new Array();' . "\r\n" . '' . "\r\n" . '	//得到原值数组' . "\r\n" . '	for( var ki=minOptionId;ki<=maxOptionId;ki++)' . "\r\n" . '	{' . "\r\n" . '		obj = eval("document.Survey_Form.option_" + questionID + "_" + ki );' . "\r\n" . '		if( obj != null )' . "\r\n" . '		{' . "\r\n" . '			if( getRadioCheckBoxValue(obj) != \'\' )' . "\r\n" . '			{' . "\r\n" . '				oriValueArray[kj] = getRadioCheckBoxValue(obj);' . "\r\n" . '				kj++;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	var isCheckInvalid = false;' . "\r\n" . '	for(var tmp=0; tmp<oriValueArray.length;tmp++)' . "\r\n" . '	{' . "\r\n" . '		var contInvalidValueCount = 1;' . "\r\n" . '		for( var j=tmp+1;j<oriValueArray.length;j++ )' . "\r\n" . '		{' . "\r\n" . '			if( oriValueArray[tmp] == oriValueArray[j] )' . "\r\n" . '			{' . "\r\n" . '				contInvalidValueCount++;' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				break;' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		if( contInvalidValueCount >= contInvalidValue )' . "\r\n" . '		{' . "\r\n" . '			isCheckInvalid = true;' . "\r\n" . '			break;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	if( isCheckInvalid == true )' . "\r\n" . '	{' . "\r\n" . '		var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '		theObjIn.scrollIntoView(true);' . "\r\n" . '		theObjIn.focus();' . "\r\n" . '		var strErr = "" + questionName + ":have "+contInvalidValue+" consecutive identical reply!";' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}		' . "\r\n" . '	return true;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//矩阵多选题的掩蔽' . "\r\n" . 'function theMaskingItem(questionID,theOptionIdList,answerNum,rangeType)' . "\r\n" . '{' . "\r\n" . '	var theOptionIdArray = theOptionIdList.split(\',\');' . "\r\n" . '	var theNewOptionIdList = new Array();' . "\r\n" . '	var temp=0;' . "\r\n" . '	for(var k=0;k<theOptionIdArray.length;k++)' . "\r\n" . '	{' . "\r\n" . '		if( rangeType == 1 )  //正常矩阵' . "\r\n" . '		{' . "\r\n" . '			var theFatherObj = eval("document.getElementById(\'range_range_"+theOptionIdArray[k]+"_container\')");' . "\r\n" . '		}' . "\r\n" . '		else //反向矩阵' . "\r\n" . '		{' . "\r\n" . '			var theFatherObj = eval("document.getElementById(\'range_option_"+theOptionIdArray[k]+"_container\')");' . "\r\n" . '		}' . "\r\n" . '		if( theFatherObj != null && theFatherObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			theNewOptionIdList[temp] = theOptionIdArray[k];' . "\r\n" . '			var objField = eval("document.Survey_Form.option_" + questionID + "_" + theOptionIdArray[k] );' . "\r\n" . '			if( temp == 0 && objField != null ) changeOptionDisable(objField);' . "\r\n" . '			temp++;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	for(var p=0;p<theNewOptionIdList.length;p++)' . "\r\n" . '	{' . "\r\n" . '		var objField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p] );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '			if( objField.length == null ) //只有一个选项' . "\r\n" . '			{' . "\r\n" . '				if( objField.checked)' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.disabled = false;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.checked = false;' . "\r\n" . '						theNextField.disabled = true;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				for(var r=0;r<=answerNum;r++)' . "\r\n" . '				{' . "\r\n" . '					if(objField[r].checked )' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].disabled = false;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].checked = false;' . "\r\n" . '							theNextField[r].disabled = true;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function theMaskingItemIsNeg(questionID,theOptionIdList,answerNum,rangeType)' . "\r\n" . '{' . "\r\n" . '	var theOptionIdArray = theOptionIdList.split(\',\');' . "\r\n" . '	var theNewOptionIdList = new Array();' . "\r\n" . '	var temp=0;' . "\r\n" . '	for(var k=0;k<theOptionIdArray.length;k++)' . "\r\n" . '	{' . "\r\n" . '		if( rangeType == 1 )  //正常矩阵' . "\r\n" . '		{' . "\r\n" . '			var theFatherObj = eval("document.getElementById(\'range_range_"+theOptionIdArray[k]+"_container\')");' . "\r\n" . '		}' . "\r\n" . '		else //反向矩阵' . "\r\n" . '		{' . "\r\n" . '			var theFatherObj = eval("document.getElementById(\'range_option_"+theOptionIdArray[k]+"_container\')");' . "\r\n" . '		}' . "\r\n" . '			' . "\r\n" . '		if( theFatherObj != null && theFatherObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			theNewOptionIdList[temp] = theOptionIdArray[k];' . "\r\n" . '			var objField = eval("document.Survey_Form.option_" + questionID + "_" + theOptionIdArray[k] );' . "\r\n" . '			if( temp == 0 && objField != null ) changeOptionDisable(objField);' . "\r\n" . '			temp++;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	for(var p=0;p<theNewOptionIdList.length;p++)' . "\r\n" . '	{' . "\r\n" . '		var objField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p] );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '			if( objField.length == null ) //只有一个选项' . "\r\n" . '			{' . "\r\n" . '				if( !objField.checked && objField.disabled != true)' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.disabled = false;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.checked = false;' . "\r\n" . '						theNextField.disabled = true;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				for(var r=0;r<=answerNum;r++)' . "\r\n" . '				{' . "\r\n" . '					if( !objField[r].checked && objField[r].disabled != true)' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].disabled = false;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].checked = false;' . "\r\n" . '							theNextField[r].disabled = true;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动矩阵多选题的掩蔽' . "\r\n" . 'function theMaskingAutoItem(questionID,theOptionIdList,answerNum,baseID)' . "\r\n" . '{' . "\r\n" . '	var theAutoIdArray = theOptionIdList.split(\',\');' . "\r\n" . '	var theNewOptionIdList = new Array();' . "\r\n" . '	var temp=0;' . "\r\n" . '	for(var k=0;k<theAutoIdArray.length;k++)' . "\r\n" . '	{' . "\r\n" . '		var theFatherObj = eval("document.getElementById(\'multi_"+baseID+"_" + questionID + "_" + theAutoIdArray[k]+"\')");' . "\r\n" . '		if( theFatherObj != null && theFatherObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			theNewOptionIdList[temp] = theAutoIdArray[k];' . "\r\n" . '			var objField = eval("document.Survey_Form.option_" + questionID + "_" + theAutoIdArray[k] );' . "\r\n" . '			if( temp == 0 && objField != null ) changeOptionDisable(objField);' . "\r\n" . '			temp++;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	for(var p=0;p<theNewOptionIdList.length;p++)' . "\r\n" . '	{' . "\r\n" . '		var objField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p] );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '			if( objField.length == null ) //只有一个选项' . "\r\n" . '			{' . "\r\n" . '				if( objField.checked)' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.disabled = false;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.checked = false;' . "\r\n" . '						theNextField.disabled = true;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				for(var r=0;r<=answerNum;r++)' . "\r\n" . '				{' . "\r\n" . '					if(objField[r].checked )' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].disabled = false;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].checked = false;' . "\r\n" . '							theNextField[r].disabled = true;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}			' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function theMaskingAutoItemIsNeg(questionID,theOptionIdList,answerNum,baseID)' . "\r\n" . '{' . "\r\n" . '	var theAutoIdArray = theOptionIdList.split(\',\');' . "\r\n" . '	var theNewOptionIdList = new Array();' . "\r\n" . '	var temp=0;' . "\r\n" . '	for(var k=0;k<theAutoIdArray.length;k++)' . "\r\n" . '	{' . "\r\n" . '		var theFatherObj = eval("document.getElementById(\'multi_"+baseID+"_" + questionID + "_" + theAutoIdArray[k]+"\')");' . "\r\n" . '		if( theFatherObj != null && theFatherObj.style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			theNewOptionIdList[temp] = theAutoIdArray[k];' . "\r\n" . '			var objField = eval("document.Survey_Form.option_" + questionID + "_" + theAutoIdArray[k] );' . "\r\n" . '			if( temp == 0 && objField != null ) changeOptionDisable(objField);' . "\r\n" . '			temp++;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	for(var p=0;p<theNewOptionIdList.length;p++)' . "\r\n" . '	{' . "\r\n" . '		var objField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p] );' . "\r\n" . '		if( objField != null )' . "\r\n" . '		{' . "\r\n" . '			if( objField.length == null ) //只有一个选项' . "\r\n" . '			{' . "\r\n" . '				if( !objField.checked && objField.disabled != true)' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.disabled = false;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '					if( theNextField != null )' . "\r\n" . '					{' . "\r\n" . '						theNextField.checked = false;' . "\r\n" . '						theNextField.disabled = true;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				for(var r=0;r<=answerNum;r++)' . "\r\n" . '				{' . "\r\n" . '					if( !objField[r].checked && objField[r].disabled != true)' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].disabled = false;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '					else' . "\r\n" . '					{' . "\r\n" . '						var theNextField = eval("document.Survey_Form.option_" + questionID + "_" + theNewOptionIdList[p+1] );' . "\r\n" . '						if( theNextField != null )' . "\r\n" . '						{' . "\r\n" . '							theNextField[r].checked = false;' . "\r\n" . '							theNextField[r].disabled = true;' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '			}			' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function changeOptionDisable(objField)' . "\r\n" . '{' . "\r\n" . '	if( objField.length == null ) //只有一个选项' . "\r\n" . '	{' . "\r\n" . '		objField.disabled = false;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		for(var i=0;i<objField.length;i++)' . "\r\n" . '		{' . "\r\n" . '			objField[i].disabled = false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function changeMaskingQtnBgColor( questionID )' . "\r\n" . '{' . "\r\n" . '	var obj = eval("document.getElementById(\'qtn_table_"+questionID+"\')");' . "\r\n" . '	var theRowsNum = obj.rows;' . "\r\n" . '	var showRows = 1;' . "\r\n" . '	for ( var i=1; i<theRowsNum.length; i++)' . "\r\n" . '	{' . "\r\n" . '		if( obj.rows[i].style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			showRows++;' . "\r\n" . '			if( showRows % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#f5f5f5\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#ffffff\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function changeMaskingRatingBgColor( questionID )' . "\r\n" . '{' . "\r\n" . '	var obj = eval("document.getElementById(\'qtn_table_"+questionID+"\')");' . "\r\n" . '	var theRowsNum = obj.rows;' . "\r\n" . '	var showRows = 1;' . "\r\n" . '	for ( var i=2; i<theRowsNum.length; i++)' . "\r\n" . '	{' . "\r\n" . '		if( obj.rows[i].style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			showRows++;' . "\r\n" . '			if( showRows % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#f5f5f5\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#ffffff\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getTextValue(obj,defaultValue)' . "\r\n" . '{' . "\r\n" . '	var rtnValue;' . "\r\n" . '	if( Trim(obj.value) == \'\' )' . "\r\n" . '	{' . "\r\n" . '		rtnValue = defaultValue;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		if( isNaN(obj.value) )' . "\r\n" . '		{' . "\r\n" . '			rtnValue = defaultValue;' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			rtnValue = parseInt(obj.value);' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	return rtnValue;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//判断掩蔽题型来自多选并且未选择互斥项' . "\r\n" . 'function _getCheckBoxNoneofAbove(questionType,baseID,baseIsSelect,isSamePage,isNeg,theBaseValueList)' . "\r\n" . '{' . "\r\n" . '	if( questionType.toString() != \'3\' ) return true;' . "\r\n" . '	if( isNeg.toString() == \'1\' ) return true;' . "\r\n" . '	if( isSamePage == 1 ) //同页' . "\r\n" . '	{' . "\r\n" . '		var obj = eval("document.Survey_Form.option_"+baseID);' . "\r\n" . '		if( baseIsSelect == 1 )  //列表框' . "\r\n" . '		{' . "\r\n" . '			if( !IsInSelectedList(obj,99999) )  return true;' . "\r\n" . '			else return false;' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			if( !IsInCheckBox(obj,99999) )  return true;' . "\r\n" . '			else return false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		if( !isInValueList(99999,theBaseValueList) )' . "\r\n" . '		{' . "\r\n" . '			return true;' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//FirFox下innerText补丁' . "\r\n" . '(function (bool) {' . "\r\n" . '    function setInnerText(o, s) {' . "\r\n" . '        while (o.childNodes.length != 0) {' . "\r\n" . '            o.removeChild(o.childNodes[0]);' . "\r\n" . '        }' . "\r\n" . '' . "\r\n" . '        o.appendChild(document.createTextNode(s));' . "\r\n" . '    }' . "\r\n" . '' . "\r\n" . '    function getInnerText(o) {' . "\r\n" . '        var sRet = "";' . "\r\n" . '' . "\r\n" . '        for (var i = 0; i < o.childNodes.length; i ++) {' . "\r\n" . '            if (o.childNodes[i].childNodes.length != 0) {' . "\r\n" . '                sRet += getInnerText(o.childNodes[i]);' . "\r\n" . '            }' . "\r\n" . '' . "\r\n" . '            if (o.childNodes[i].nodeValue) {' . "\r\n" . '                if (o.currentStyle.display == "block") {' . "\r\n" . '                    sRet += o.childNodes[i].nodeValue + "\\n";' . "\r\n" . '                } else {' . "\r\n" . '                    sRet += o.childNodes[i].nodeValue;' . "\r\n" . '                }' . "\r\n" . '            }' . "\r\n" . '        }' . "\r\n" . '' . "\r\n" . '        return sRet;' . "\r\n" . '    }' . "\r\n" . '' . "\r\n" . '    if (bool) {' . "\r\n" . '        HTMLElement.prototype.__defineGetter__("currentStyle", function () {' . "\r\n" . '            return this.ownerDocument.defaultView.getComputedStyle(this, null);' . "\r\n" . '        });' . "\r\n" . '' . "\r\n" . '        HTMLElement.prototype.__defineGetter__("innerText", function () {' . "\r\n" . '            return getInnerText(this);' . "\r\n" . '        })' . "\r\n" . '' . "\r\n" . '        HTMLElement.prototype.__defineSetter__("innerText", function(s) {' . "\r\n" . '            setInnerText(this, s);' . "\r\n" . '        })' . "\r\n" . '    }' . "\r\n" . '})(/Firefox/.test(window.navigator.userAgent));' . "\r\n" . '' . "\r\n" . '//新增函数2013-04' . "\r\n" . '' . "\r\n" . '//判断单选/复选必选' . "\r\n" . 'function CheckRadioNoClickInAssMode(questionID,objField, strText)' . "\r\n" . '{' . "\r\n" . '	var strErr = "" + strText + ":you must give one choice at least!";' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if (objField.checked) return true;' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '			theObjIn.scrollIntoView(true);' . "\r\n" . '			theObjIn.focus();' . "\r\n" . '			$.notification(strErr);' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		for (i=0;i<objField.length;i++){' . "\r\n" . '			if (objField[i].checked) return true;' . "\r\n" . '		}' . "\r\n" . '		var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '		theObjIn.scrollIntoView(true);' . "\r\n" . '		theObjIn.focus();' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测复选题最多几项' . "\r\n" . 'function CheckCheckMaxClickInAssMode(questionID,objField, strText,maxNum )' . "\r\n" . '{' . "\r\n" . '	var j=0;' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if (objField.checked) j=1;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		for (t=0;t<objField.length;t++){' . "\r\n" . '			if (objField[t].checked) j=j+1; ' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	if( j > maxNum ){' . "\r\n" . '		var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '		theObjIn.scrollIntoView(true);' . "\r\n" . '		theObjIn.focus();' . "\r\n" . '		$.notification("" + strText + ":the answer you have selected is more than "+ maxNum + "!");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	else {' . "\r\n" . '		if( j==0 )	{' . "\r\n" . '			var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '			theObjIn.scrollIntoView(true);' . "\r\n" . '			theObjIn.focus();' . "\r\n" . '			$.notification("" + strText + ":you must give one choice at least!" );   ' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '		else return true;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测复选题最少几项' . "\r\n" . 'function CheckCheckMinClickInAssMode(questionID,objField, strText,minNum )' . "\r\n" . '{' . "\r\n" . '	var j=0; ' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if (objField.checked) j=1;' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		for (t=0;t<objField.length;t++){' . "\r\n" . '			if (objField[t].checked)  j=j+1; ' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	if( j < minNum){' . "\r\n" . '		var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '		theObjIn.scrollIntoView(true);' . "\r\n" . '		theObjIn.focus();' . "\r\n" . '		$.notification("" + strText + ":the answer you have selected is less than "+ minNum + "!");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	else {' . "\r\n" . '		if( j==0 )	{' . "\r\n" . '			var theObjIn = eval("document.getElementById(\'question_"+questionID+"\')");' . "\r\n" . '			theObjIn.scrollIntoView(true);' . "\r\n" . '			theObjIn.focus();' . "\r\n" . '			$.notification("" + strText + ":you must give one choice at least!" );   ' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '		else return true;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function selectIsExitItem(objSelect,objItemValue)   ' . "\r\n" . '{   ' . "\r\n" . '     var isExit = false ;   ' . "\r\n" . '     for ( var i=0;i<objSelect.length;i++)   ' . "\r\n" . '     {   ' . "\r\n" . '         if (objSelect.options[i].value == objItemValue)   ' . "\r\n" . '         {   ' . "\r\n" . '             isExit = true ;   ' . "\r\n" . '             break ;   ' . "\r\n" . '         }   ' . "\r\n" . '     }        ' . "\r\n" . '     return isExit;   ' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//排除性选项' . "\r\n" . 'function theExcludeItemInAssMode(objField,isSelect,negValue)' . "\r\n" . '{' . "\r\n" . '	if( isSelect == 1 )  //列表框' . "\r\n" . '	{' . "\r\n" . '	   if( IsInSelectedList(objField,negValue) )' . "\r\n" . '	   {' . "\r\n" . '		   for(var t=0;t<objField.length;t++)' . "\r\n" . '		   {' . "\r\n" . '			   if( objField.options[t].value != negValue )' . "\r\n" . '			   {' . "\r\n" . '					objField.options[t].selected = false;' . "\r\n" . '			   }' . "\r\n" . '		   }' . "\r\n" . '	   }	' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '	   if( IsInCheckBox(objField,negValue) )' . "\r\n" . '	   {' . "\r\n" . '		   for(var t=0;t<objField.length;t++)' . "\r\n" . '		   {' . "\r\n" . '			   if( objField[t].value != negValue )' . "\r\n" . '			   {' . "\r\n" . '					objField[t].checked = false;' . "\r\n" . '					objField[t].disabled = true;' . "\r\n" . '			   }' . "\r\n" . '		   }' . "\r\n" . '	    }' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '		   for(var t=0;t<objField.length;t++)' . "\r\n" . '		   {' . "\r\n" . '			   if( objField[t].value != negValue )' . "\r\n" . '			   {' . "\r\n" . '					objField[t].disabled = false;' . "\r\n" . '			   }' . "\r\n" . '		   }' . "\r\n" . '	    }			' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//撤销单选单一选项选中' . "\r\n" . 'function RadioItemUnClick(objField,value)' . "\r\n" . '{' . "\r\n" . '	if( getRadioCheckBoxValue(objField) == value )' . "\r\n" . '	{' . "\r\n" . '		RadioUnClick(objField);' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//改变掩蔽列颜色' . "\r\n" . 'function changeMaskingOptBgColor( questionID )' . "\r\n" . '{' . "\r\n" . '	var obj = eval("document.getElementById(\'qtn_table_"+questionID+"\')");' . "\r\n" . '	var theRowsNum = obj.rows;' . "\r\n" . '	for ( var i=0; i<theRowsNum.length; i++)' . "\r\n" . '	{' . "\r\n" . '		var theColsNum = obj.rows[i].cells;' . "\r\n" . '		var showCols = 2;' . "\r\n" . '		var tmp = 2;' . "\r\n" . '		for( var j=2;j<theColsNum.length;j++)' . "\r\n" . '		{' . "\r\n" . '			if( obj.rows[i].cells[j].style.display != \'none\' && tmp % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				if( showCols % 2 == 0 )' . "\r\n" . '				{' . "\r\n" . '					obj.rows[i].cells[j].style.backgroundColor = \'#f5f5f5\';' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					obj.rows[i].cells[j].style.backgroundColor = \'#ffffff\';' . "\r\n" . '				}' . "\r\n" . '				showCols++;				' . "\r\n" . '			}' . "\r\n" . '			tmp++;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//移动平台' . "\r\n" . 'function selRadioCheckRows(objIdStr,objOrder)' . "\r\n" . '{' . "\r\n" . '	var objId = eval("document.Survey_Form."+objIdStr);' . "\r\n" . '	if( objId.length == null ) ' . "\r\n" . '	{' . "\r\n" . '		if( objId.disabled != true )' . "\r\n" . '		{' . "\r\n" . '			objId.checked = true;' . "\r\n" . '			Check_Survey_Conditions();' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		if( objId[objOrder].disabled != true )' . "\r\n" . '		{' . "\r\n" . '			objId[objOrder].checked = true;' . "\r\n" . '			Check_Survey_Conditions();' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function selCheckBoxCheckRows(objIdStr,objOrder)' . "\r\n" . '{' . "\r\n" . '	var objId = eval("document.Survey_Form."+objIdStr);' . "\r\n" . '	if( objId.length == null ) ' . "\r\n" . '	{' . "\r\n" . '		if( objId.disabled != true )' . "\r\n" . '		{' . "\r\n" . '			objId.checked = ! objId.checked;' . "\r\n" . '			Check_Survey_Conditions();' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		if( objId[objOrder].disabled != true )' . "\r\n" . '		{' . "\r\n" . '			objId[objOrder].checked = ! objId[objOrder].checked;' . "\r\n" . '			Check_Survey_Conditions();' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function changeMaskingSingleBgColor( questionID )' . "\r\n" . '{' . "\r\n" . '	var obj = eval("document.getElementById(\'qtn_table_"+questionID+"\')");' . "\r\n" . '	var theRowsNum = obj.rows;' . "\r\n" . '	var showRows = 1;' . "\r\n" . '	for ( var i=0; i<theRowsNum.length; i++)' . "\r\n" . '	{' . "\r\n" . '		if( obj.rows[i].style.display != \'none\' && obj.rows[i].className != "no_color_tr" )' . "\r\n" . '		{' . "\r\n" . '			showRows++;' . "\r\n" . '			if( showRows % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#f5f5f5\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#ffffff\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function changeMaskingSingleQtnBgColor( questionID )' . "\r\n" . '{' . "\r\n" . '	var obj = eval("document.getElementById(\'qtn_table_"+questionID+"\')");' . "\r\n" . '	var theRowsNum = obj.rows;' . "\r\n" . '	var showRows = 1;' . "\r\n" . '	for ( var i=0; i<theRowsNum.length; i++)' . "\r\n" . '	{' . "\r\n" . '		if( obj.rows[i].style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			showRows++;' . "\r\n" . '			if( showRows % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#f5f5f5\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#ffffff\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function changeMaskingAutoBgColor( questionID )' . "\r\n" . '{' . "\r\n" . '	var obj = eval("document.getElementById(\'auto_focus_"+questionID+"\')");' . "\r\n" . '	var theRowsNum = obj.rows;' . "\r\n" . '	var showRows = 1;' . "\r\n" . '	for ( var i=0; i<theRowsNum.length; i++)' . "\r\n" . '	{' . "\r\n" . '		if( obj.rows[i].style.display != \'none\' )' . "\r\n" . '		{' . "\r\n" . '			showRows++;' . "\r\n" . '			if( showRows % 2 == 0 )' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#f5f5f5\';' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				obj.rows[i].style.backgroundColor = \'#ffffff\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '';

?>
