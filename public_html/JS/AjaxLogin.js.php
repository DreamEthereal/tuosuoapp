<?php
//dezend by http://www.yunlu99.com/
echo 'var http_request = false;' . "\r\n" . 'function CreateXMLHttpRequest()' . "\r\n" . '{' . "\r\n" . '    http_request = false;' . "\r\n" . '    if(window.ActiveXObject)' . "\r\n" . '    {' . "\r\n" . '       try  // IE' . "\r\n" . '       {' . "\r\n" . '	   http_request = new ActiveXObject("Msxml2.XMLHTTP");' . "\r\n" . '       }' . "\r\n" . '       catch (e)' . "\r\n" . '       {' . "\r\n" . '	   try' . "\r\n" . '	   {' . "\r\n" . '		http_request = new ActiveXObject("Microsoft.XMLHTTP");' . "\r\n" . '	   }' . "\r\n" . '	   catch (e) {}' . "\r\n" . '       }' . "\r\n" . '    }' . "\r\n" . '    else if(window.XMLHttpRequest)' . "\r\n" . '    {' . "\r\n" . '	   // Mozilla, Safari,...' . "\r\n" . '	   http_request = new XMLHttpRequest();' . "\r\n" . '	   if (http_request.overrideMimeType)' . "\r\n" . '	   {' . "\r\n" . ' 	       http_request.overrideMimeType(\'text/xml\');' . "\r\n" . '	   }' . "\r\n" . '    }' . "\r\n" . '    if (!http_request)' . "\r\n" . '    {' . "\r\n" . ' 	   alert("Cannot create an XMLHTTP instance");' . "\r\n" . '	   return false;' . "\r\n" . '    }' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function AjaxLoginSubmitRequest(url)' . "\r\n" . '{' . "\r\n" . '    CreateXMLHttpRequest();' . "\r\n" . '    http_request.onreadystatechange = AlertLoginSubmitContents;' . "\r\n" . '    http_request.open(\'GET\', url, true);' . "\r\n" . '    http_request.send(null);' . "\r\n" . '}' . "\r\n" . 'function AjaxLoginSubmitPostRequest(url,postStr) {' . "\r\n" . '	var ajax=false; ' . "\r\n" . '	try { ajax = new ActiveXObject("Msxml2.XMLHTTP"); }' . "\r\n" . '	catch (e) { try { ajax = new ActiveXObject("Microsoft.XMLHTTP"); } catch (E) { ajax = false; } }' . "\r\n" . '	if (!ajax && typeof XMLHttpRequest!=\'undefined\') ajax = new XMLHttpRequest(); ' . "\r\n" . '' . "\r\n" . '	ajax.open("POST", url, true); ' . "\r\n" . '	ajax.setRequestHeader("Content-Type","application/x-www-form-urlencoded"); ' . "\r\n" . '	ajax.send(postStr);' . "\r\n" . '	ajax.onreadystatechange = function(){' . "\r\n" . '		if (ajax.readyState == 4)' . "\r\n" . '		{' . "\r\n" . '		   if(ajax.status == 200)' . "\r\n" . '		   {' . "\r\n" . '			  results = ajax.responseText.split(\'|\');' . "\r\n" . '			  if (results[0] == \'true\')' . "\r\n" . '			  {			 ' . "\r\n" . '				 document.AJAXLoginForm.submit();' . "\r\n" . '			  }' . "\r\n" . '			  else' . "\r\n" . '			  {' . "\r\n" . '				 if( results[1] == null ) $.notification(ajax.responseText);' . "\r\n" . '				 else $.notification(results[1]);' . "\r\n" . '			  }' . "\r\n" . '		   }' . "\r\n" . '		   else' . "\r\n" . '		   {' . "\r\n" . '			  alert(\'The Nerwork has error\');' . "\r\n" . '		   }' . "\r\n" . '	   }' . "\r\n" . '	};' . "\r\n" . '}' . "\r\n" . 'function AlertLoginSubmitContents()' . "\r\n" . '{' . "\r\n" . '	if (http_request.readyState == 4)' . "\r\n" . '    {' . "\r\n" . '	   if(http_request.status == 200)' . "\r\n" . '	   {' . "\r\n" . '		  results = http_request.responseText.split(\'|\');' . "\r\n" . '		  if (results[0] == \'true\')' . "\r\n" . '	      {	' . "\r\n" . '		     document.getElementById("ajaxRtnValue").value = results[1];' . "\r\n" . '			 //为Web Services登录其他系统而设' . "\r\n" . '			 //results[2]为自动登录的URL' . "\r\n" . '			 if( results[2] != \'\' )' . "\r\n" . '			 {' . "\r\n" . '				 var jsclear = document.createElement( \'iframe\' );' . "\r\n" . '				 jsclear.id = \'cleariframe\';' . "\r\n" . '				 jsclear.width = 0;' . "\r\n" . '				 jsclear.height = 0;' . "\r\n" . '				 jsclear.frameborder = 0;' . "\r\n" . '				 jsclear.src = results[2];' . "\r\n" . '				 jsclear.name = \'cleariframe\';' . "\r\n" . '				 document.body.appendChild(jsclear);' . "\r\n" . '				 window.frames.cleariframe.name = \'cleariframe\';' . "\r\n" . '			 }' . "\r\n" . '			 document.AJAXLoginForm.submit();' . "\r\n" . '	      }' . "\r\n" . '	      else' . "\r\n" . '	      {' . "\r\n" . '			 if( results[1] == null ) $.notification(http_request.responseText);' . "\r\n" . '			 else $.notification(results[1]);' . "\r\n" . '	      }' . "\r\n" . '	   }' . "\r\n" . '       else' . "\r\n" . '	   {' . "\r\n" . '	      alert(\'The Nerwork has error\');' . "\r\n" . '	   }' . "\r\n" . '   }' . "\r\n" . '}';

?>
