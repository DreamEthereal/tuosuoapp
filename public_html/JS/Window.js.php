<?php
//dezend by http://www.yunlu99.com/
error_reporting(0);
if ((ob_get_length() === false) && !ini_get('zlib.output_compression') && (ini_get('output_handler') != 'ob_gzhandler') && (ini_get('output_handler') != 'mb_output_handler')) {
	ob_start('ob_gzhandler');
}

header('Cache-Control: public');
header('Pragma: cache');
$offset = 2592000;
$ExpStr = 'Expires: ' . gmdate('D, d M Y H:i:s', time() + $offset) . ' GMT';
$LmStr = 'Last-Modified: ' . gmdate('D, d M Y H:i:s', filemtime(__FILE__)) . ' GMT';
header($ExpStr);
header($LmStr);
header('Content-Type: text/javascrīpt; charset: UTF-8');
echo '' . "\n" . '/**' . "\n" . ' * SUBMODAL v1.6' . "\n" . ' * Used for displaying DHTML only popups instead of using buggy modal windows.' . "\n" . ' *' . "\n" . ' * By Subimage LLC' . "\n" . ' * http://www.subimage.com' . "\n" . ' *' . "\n" . ' * Contributions by:' . "\n" . ' * 	Eric Angel - tab index code' . "\n" . ' * 	Scott - hiding/showing selects for IE users' . "\n" . ' *	Todd Huss - inserting modal dynamically and anchor classes' . "\n" . ' *' . "\n" . ' * Up to date code can be found at http://submodal.googlecode.com' . "\n" . ' */' . "\n" . '' . "\n" . '// Popup code' . "\n" . 'var gPopupMask = null;' . "\n" . 'var gPopupContainer = null;' . "\n" . 'var gPopFrame = null;' . "\n" . 'var gReturnFunc;' . "\n" . 'var gPopupIsShown = false;' . "\n" . 'var gDefaultPage = "about:blank";' . "\n" . 'var gHideSelects = false;' . "\n" . 'var gReturnVal = null;' . "\n" . '' . "\n" . 'var gTabIndexes = new Array();' . "\n" . '// Pre-defined list of tags we want to disable/enable tabbing into' . "\n" . 'var gTabbableTags = new Array("A","BUTTON","TEXTAREA","INPUT","IFRAME");	' . "\n" . '' . "\n" . '// If using Mozilla or Firefox, use Tab-key trap.' . "\n" . 'if (!document.all) {' . "\n" . '	document.onkeypress = keyDownHandler;' . "\n" . '}' . "\n" . '' . "\n" . '/**' . "\n" . ' * Initializes popup code on load.	' . "\n" . ' */' . "\n" . 'function initPopUp() {' . "\n" . '	// Add the HTML to the body' . "\n" . '	theBody = document.getElementsByTagName(\'BODY\')[0];' . "\n" . '	popmask = document.createElement(\'div\');' . "\n" . '	popmask.id = \'popupMask\';' . "\n" . '	popcont = document.createElement(\'div\');' . "\n" . '	popcont.id = \'popupContainer\';' . "\n" . '	popcont.innerHTML = \'\' +' . "\n" . '		\'<div id="popupInner">\' +' . "\n" . '			\'<div id="popupTitleBar">\' +' . "\n" . '				\'<div id="popupTitle"></div>\' +' . "\n" . '				\'<div id="popupControls">\' +' . "\n" . '				';

switch ($_GET['style']) {
case 1:
case 3:
	echo '		' . "\n" . '					\'<img src="./Images/closewindow.gif" onclick="hidePopWin(false);" id="popCloseBox" />\' +' . "\n" . '				  ';
	break;

case 10:
	$All_Path = 'http://' . $_SERVER['HTTP_HOST'] . substr($_SERVER['SCRIPT_NAME'], 0, -16);
	echo '					\'<img src="';
	echo $All_Path;
	echo '/Images/closewindow.gif" onclick="hidePopWin(false);" id="popCloseBox" />\' +' . "\n" . '				  ';
	break;

default:
	echo '					\'<img src="../Images/closewindow.gif" onclick="hidePopWin(false);" id="popCloseBox" />\' +' . "\n" . '                  ';
	break;
}

echo '				\'</div>\' +' . "\n" . '			\'</div>\' +' . "\n" . '			\'<iframe src="" style="width:100%;height:100%;background-color:transparent;" scrolling="auto" frameborder="0" allowtransparency="true" id="popupFrame" name="popupFrame" width="100%" height="100%"></iframe>\' +' . "\n" . '		\'</div>\';' . "\n" . '	theBody.appendChild(popmask);' . "\n" . '	theBody.appendChild(popcont);' . "\n" . '	' . "\n" . '	gPopupMask = document.getElementById("popupMask");' . "\n" . '	gPopupContainer = document.getElementById("popupContainer");' . "\n" . '	gPopFrame = document.getElementById("popupFrame");	' . "\n" . '	' . "\n" . '	// check to see if this is IE version 6 or lower. hide select boxes if so' . "\n" . '	// maybe they\'ll fix this in version 7?' . "\n" . '	var brsVersion = parseInt(window.navigator.appVersion.charAt(0), 10);' . "\n" . '	if (brsVersion <= 6 && window.navigator.userAgent.indexOf("MSIE") > -1) {' . "\n" . '		gHideSelects = true;' . "\n" . '	}' . "\n" . '	' . "\n" . '	// Add onclick handlers to \'a\' elements of class submodal or submodal-width-height' . "\n" . '	var elms = document.getElementsByTagName(\'a\');' . "\n" . '	for (i = 0; i < elms.length; i++) {' . "\n" . '		if (elms[i].className.indexOf("window") == 0) { ' . "\n" . '			// var onclick = \'function (){showPopWin(\\\'\'+elms[i].href+\'\\\',\'+width+\', \'+height+\', null);return false;};\';' . "\n" . '			// elms[i].onclick = eval(onclick);' . "\n" . '			elms[i].onclick = function(){' . "\n" . '				// default width and height' . "\n" . '				var width = 400;' . "\n" . '				var height = 200;' . "\n" . '				// Parse out optional width and height from className' . "\n" . '				params = this.className.split(\'-\');' . "\n" . '				if (params.length == 3) {' . "\n" . '					width = parseInt(params[1]);' . "\n" . '					height = parseInt(params[2]);' . "\n" . '				}' . "\n" . '				showPopWin(this.href,width,height,null,null,this.title); return false;' . "\n" . '			}' . "\n" . '		}' . "\n" . '	}' . "\n" . '}' . "\n" . 'addEvent(window, "load", initPopUp);' . "\n" . '' . "\n" . ' /**' . "\n" . '	* @argument width - int in pixels' . "\n" . '	* @argument height - int in pixels' . "\n" . '	* @argument url - url to display' . "\n" . '	* @argument returnFunc - function to call when returning true from the window.' . "\n" . '	* @argument showCloseBox - show the close box - default true' . "\n" . '	*/' . "\n" . 'function showPopWin(url, width, height, returnFunc, showCloseBox,thePopupTitle) {' . "\n" . '	' . "\n" . '	// show or hide the window close widget' . "\n" . '	if (showCloseBox == null || showCloseBox == true) {' . "\n" . '		document.getElementById("popCloseBox").style.display = "block";' . "\n" . '	} else {' . "\n" . '		document.getElementById("popCloseBox").style.display = "none";' . "\n" . '	}' . "\n" . '' . "\n" . '	document.getElementById(\'popupTitle\').innerHTML	 = thePopupTitle;' . "\n" . '	gPopupIsShown = true;' . "\n" . '	disableTabIndexes();' . "\n" . '' . "\n" . '	// calculate where to place the window on screen' . "\n" . '	// V6.10版本调整下面三条语句的顺序,原顺序为' . "\n" . '	//gPopupMask.style.display = "block";' . "\n" . '	//gPopupContainer.style.display = "block";' . "\n" . '	//centerPopWin(width, height);' . "\n" . '' . "\n" . '	centerPopWin(width, height);' . "\n" . '' . "\n" . '	gPopupMask.style.display = "block";' . "\n" . '	gPopupContainer.style.display = "block";	' . "\n" . '	' . "\n" . '	var titleBarHeight = parseInt(document.getElementById("popupTitleBar").offsetHeight, 10);' . "\n" . '' . "\n" . '	gPopupContainer.style.width = width + "px";' . "\n" . '	gPopupContainer.style.height = (height+titleBarHeight) + "px";' . "\n" . '' . "\n" . '	setMaskSize();' . "\n" . '' . "\n" . '	// need to set the width of the iframe to the title bar width because of the dropshadow' . "\n" . '	// some oddness was occuring and causing the frame to poke outside the border in IE6' . "\n" . '    var the_ori_width = parseInt(document.getElementById("popupTitleBar").offsetWidth, 10);' . "\n" . '	gPopFrame.style.width = the_ori_width + "px";' . "\n" . '	gPopFrame.style.height = (height) + "px";' . "\n" . '' . "\n" . '	// set the url' . "\n" . '	gPopFrame.src = url;' . "\n" . '' . "\n" . '	gReturnFunc = returnFunc;' . "\n" . '	// for IE' . "\n" . '	if (gHideSelects == true) {' . "\n" . '		hideSelectBoxes();' . "\n" . '	}' . "\n" . '	' . "\n" . '}' . "\n" . '' . "\n" . '//' . "\n" . 'var gi = 0;' . "\n" . 'function centerPopWin(width, height) {' . "\n" . '	if (gPopupIsShown == true) {' . "\n" . '		if (width == null || isNaN(width)) {' . "\n" . '			width = gPopupContainer.offsetWidth;' . "\n" . '		}' . "\n" . '		if (height == null) {' . "\n" . '			height = gPopupContainer.offsetHeight;' . "\n" . '		}' . "\n" . '		' . "\n" . '		//var theBody = document.documentElement;' . "\n" . '		var theBody = document.getElementsByTagName("BODY")[0];' . "\n" . '		//theBody.style.overflow = "hidden";' . "\n" . '		var scTop = parseInt(getScrollTop(),10);' . "\n" . '		var scLeft = parseInt(theBody.scrollLeft,10);' . "\n" . '	' . "\n" . '		setMaskSize();' . "\n" . '		' . "\n" . '		//window.status = gPopupMask.style.top + " " + gPopupMask.style.left + " " + gi++;' . "\n" . '		' . "\n" . '		var titleBarHeight = parseInt(document.getElementById("popupTitleBar").offsetHeight, 10);' . "\n" . '		' . "\n" . '		var fullHeight = getViewportHeight();' . "\n" . '		var fullWidth = getViewportWidth();' . "\n" . '		' . "\n" . '		gPopupContainer.style.top = (scTop + ((fullHeight - (height+titleBarHeight)) / 2)) + "px";' . "\n" . '		gPopupContainer.style.left =  (scLeft + ((fullWidth - width) / 2)) + "px";' . "\n" . '		//alert(fullWidth + " " + width + " " + gPopupContainer.style.left);' . "\n" . '	}' . "\n" . '}' . "\n" . '//2014-04-01注释' . "\n" . '//addEvent(window, "resize", centerPopWin);' . "\n" . 'addEvent(window, "scroll", centerPopWin);' . "\n" . 'window.onscroll = centerPopWin;' . "\n" . '' . "\n" . '' . "\n" . '/**' . "\n" . ' * Sets the size of the popup mask.' . "\n" . ' *' . "\n" . ' */' . "\n" . 'function setMaskSize() {' . "\n" . '	var theBody = document.getElementsByTagName("BODY")[0];' . "\n" . '			' . "\n" . '	var fullHeight = getViewportHeight();' . "\n" . '	var fullWidth = getViewportWidth();' . "\n" . '	' . "\n" . '	// Determine what\'s bigger, scrollHeight or fullHeight / width' . "\n" . '	if (fullHeight > theBody.scrollHeight) {' . "\n" . '		popHeight = fullHeight;' . "\n" . '	} else {' . "\n" . '		popHeight = theBody.scrollHeight;' . "\n" . '	}' . "\n" . '	' . "\n" . '	if (fullWidth > theBody.scrollWidth) {' . "\n" . '		popWidth = fullWidth;' . "\n" . '	} else {' . "\n" . '		popWidth = theBody.scrollWidth;' . "\n" . '	}' . "\n" . '	' . "\n" . '	gPopupMask.style.height = popHeight + "px";' . "\n" . '	gPopupMask.style.width = popWidth + "px";' . "\n" . '}' . "\n" . '' . "\n" . '/**' . "\n" . ' * @argument callReturnFunc - bool - determines if we call the return function specified' . "\n" . ' * @argument returnVal - anything - return value ' . "\n" . ' */' . "\n" . 'function hidePopWin(callReturnFunc) {' . "\n" . '	gPopupIsShown = false;' . "\n" . '	var theBody = document.getElementsByTagName("BODY")[0];' . "\n" . '	theBody.style.overflow = "";' . "\n" . '	restoreTabIndexes();' . "\n" . '	if (gPopupMask == null) {' . "\n" . '		return;' . "\n" . '	}' . "\n" . '	gPopupMask.style.display = "none";' . "\n" . '	gPopupContainer.style.display = "none";' . "\n" . '	gPopupContainer.style.top = \'0px\';' . "\n" . '    gPopupContainer.style.left = \'0px\';' . "\n" . '' . "\n" . '	if (callReturnFunc == true && gReturnFunc != null) {' . "\n" . '		// Set the return code to run in a timeout.' . "\n" . '		// Was having issues using with an Ajax.Request();' . "\n" . '        gReturnVal = window.frames["popupFrame"].returnVal;' . "\n" . '		window.setTimeout(\'gReturnFunc(gReturnVal);\', 1);' . "\n" . '	}' . "\n" . '	gPopFrame.src = gDefaultPage;' . "\n" . '	// display all select boxes' . "\n" . '	if (gHideSelects == true) {' . "\n" . '		displaySelectBoxes();' . "\n" . '	}' . "\n" . '}' . "\n" . '' . "\n" . '// Tab key trap. iff popup is shown and key was [TAB], suppress it.' . "\n" . '// @argument e - event - keyboard event that caused this function to be called.' . "\n" . 'function keyDownHandler(e) {' . "\n" . '    if (gPopupIsShown && e.keyCode == 9)  return false;' . "\n" . '}' . "\n" . '' . "\n" . '// For IE.  Go through predefined tags and disable tabbing into them.' . "\n" . 'function disableTabIndexes() {' . "\n" . '	if (document.all) {' . "\n" . '		var i = 0;' . "\n" . '		for (var j = 0; j < gTabbableTags.length; j++) {' . "\n" . '			var tagElements = document.getElementsByTagName(gTabbableTags[j]);' . "\n" . '			for (var k = 0 ; k < tagElements.length; k++) {' . "\n" . '				gTabIndexes[i] = tagElements[k].tabIndex;' . "\n" . '				tagElements[k].tabIndex="-1";' . "\n" . '				i++;' . "\n" . '			}' . "\n" . '		}' . "\n" . '	}' . "\n" . '}' . "\n" . '' . "\n" . '// For IE. Restore tab-indexes.' . "\n" . 'function restoreTabIndexes() {' . "\n" . '	if (document.all) {' . "\n" . '		var i = 0;' . "\n" . '		for (var j = 0; j < gTabbableTags.length; j++) {' . "\n" . '			var tagElements = document.getElementsByTagName(gTabbableTags[j]);' . "\n" . '			for (var k = 0 ; k < tagElements.length; k++) {' . "\n" . '				tagElements[k].tabIndex = gTabIndexes[i];' . "\n" . '				tagElements[k].tabEnabled = true;' . "\n" . '				i++;' . "\n" . '			}' . "\n" . '		}' . "\n" . '	}' . "\n" . '}' . "\n" . '' . "\n" . '' . "\n" . '/**' . "\n" . ' * Hides all drop down form select boxes on the screen so they do not appear above the mask layer.' . "\n" . ' * IE has a problem with wanted select form tags to always be the topmost z-index or layer' . "\n" . ' *' . "\n" . ' * Thanks for the code Scott!' . "\n" . ' */' . "\n" . 'function hideSelectBoxes() {' . "\n" . '  var x = document.getElementsByTagName("SELECT");' . "\n" . '' . "\n" . '  for (i=0;x && i < x.length; i++) {' . "\n" . '    x[i].style.visibility = "hidden";' . "\n" . '  }' . "\n" . '' . "\n" . '  ';

if ($_GET['style'] == 1) {
	echo '  var y =  document.getElementById("the_content_iframe").contentWindow.document.getElementsByTagName("SELECT");' . "\n" . '  for (j=0;y && j < y.length; j++) {' . "\n" . '    y[j].style.visibility = "hidden";' . "\n" . '  }' . "\n" . '  ';
}

echo '}' . "\n" . '' . "\n" . '/**' . "\n" . ' * Makes all drop down form select boxes on the screen visible so they do not ' . "\n" . ' * reappear after the dialog is closed.' . "\n" . ' * ' . "\n" . ' * IE has a problem with wanting select form tags to always be the ' . "\n" . ' * topmost z-index or layer.' . "\n" . ' */' . "\n" . 'function displaySelectBoxes() {' . "\n" . '  var x = document.getElementsByTagName("SELECT");' . "\n" . '' . "\n" . '  for (i=0;x && i < x.length; i++){' . "\n" . '    x[i].style.visibility = "visible";' . "\n" . '  }' . "\n" . '  ' . "\n" . '  ';

if ($_GET['style'] == 1) {
	echo '  var y =  document.getElementById("the_content_iframe").contentWindow.document.getElementsByTagName("SELECT");' . "\n" . '  for (j=0;y && j < y.length; j++) {' . "\n" . '    y[j].style.visibility = "visible";' . "\n" . '  }' . "\n" . '  ';
}

echo '}' . "\n" . '' . "\n" . 'function _(_sId){' . "\n" . '	return document.getElementById(_sId);' . "\n" . '}' . "\n" . '';

?>
