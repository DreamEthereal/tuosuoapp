<?php
//dezend by http://www.yunlu99.com/
if ((ob_get_length() === false) && !ini_get('zlib.output_compression') && (ini_get('output_handler') != 'ob_gzhandler') && (ini_get('output_handler') != 'mb_output_handler')) {
	ob_start('ob_gzhandler');
}

header('Cache-Control: public');
header('Pragma: cache');
$offset = 2592000;
$ExpStr = 'Expires: ' . gmdate('D, d M Y H:i:s', time() + $offset) . ' GMT';
$LmStr = 'Last-Modified: ' . gmdate('D, d M Y H:i:s', filemtime(__FILE__)) . ' GMT';
header($ExpStr);
header($LmStr);
header('Content-Type: text/javascrīpt; charset: UTF-8');
echo '' . "\r\n" . '//检查自动选项' . "\r\n" . 'function CheckAutoNoClick(objField,questionID, strText)' . "\r\n" . '{' . "\r\n" . '	var strErr = "" + strText + ":you must give one choice at least!";' . "\r\n" . '	var theShowObj;' . "\r\n" . '	if(objField == null ){' . "\r\n" . '		$.notification(strErr);' . "\r\n" . '		return false;	' . "\r\n" . '	}' . "\r\n" . '	for (i=0;i<objField.length;i++){' . "\r\n" . '		if (objField[i].checked) return true;' . "\r\n" . '	}' . "\r\n" . '	var theObjIn = eval("document.getElementById(\'auto_focus_"+questionID+"\')");' . "\r\n" . '	theObjIn.scrollIntoView(true);' . "\r\n" . '	theObjIn.focus();' . "\r\n" . '	$.notification(strErr);' . "\r\n" . '	return false;' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测自动选项最多几项' . "\r\n" . 'function CheckAutoMaxClick(objField,questionID, strText,maxNum )' . "\r\n" . '{' . "\r\n" . '	var j=0,theShowObj;   ' . "\r\n" . '	for( i=0;i<objField.length;i++ ) {   ' . "\r\n" . '		if(objField[i].checked) {   ' . "\r\n" . '		   j=j+1;   ' . "\r\n" . '		}   ' . "\r\n" . '	} ' . "\r\n" . '	if( j > maxNum ){' . "\r\n" . '		var theObjIn = eval("document.getElementById(\'auto_focus_"+questionID+"\')");' . "\r\n" . '		theObjIn.scrollIntoView(true);' . "\r\n" . '		theObjIn.focus();' . "\r\n" . '		$.notification(""+ strText + ":the answer you have selected is more than "+ maxNum +"!");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	else {' . "\r\n" . '		if( j==0 )	{' . "\r\n" . '			var theObjIn = eval("document.getElementById(\'auto_focus_"+questionID+"\')");' . "\r\n" . '			theObjIn.scrollIntoView(true);' . "\r\n" . '			theObjIn.focus();' . "\r\n" . '			$.notification("" + strText + ":you must give one choice at least!" );   ' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '		else return true;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//检测自动选项最少几项' . "\r\n" . 'function CheckAutoMinClick(objField,questionID, strText,minNum )' . "\r\n" . '{' . "\r\n" . '	var j=0,theShowObj;   ' . "\r\n" . '	for( i=0;i<objField.length;i++ ) {   ' . "\r\n" . '		if(objField[i].checked) {   ' . "\r\n" . '		   j=j+1;   ' . "\r\n" . '		}   ' . "\r\n" . '	} ' . "\r\n" . '	if( j < minNum ){' . "\r\n" . '		var theObjIn = eval("document.getElementById(\'auto_focus_"+questionID+"\')");' . "\r\n" . '		theObjIn.scrollIntoView(true);' . "\r\n" . '		theObjIn.focus();' . "\r\n" . '		$.notification(""+ strText + ":the answer you have selected is less than "+ minNum +"!");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '	else {' . "\r\n" . '		if( j==0 )	{' . "\r\n" . '			var theObjIn = eval("document.getElementById(\'auto_focus_"+questionID+"\')");' . "\r\n" . '			theObjIn.scrollIntoView(true);' . "\r\n" . '			theObjIn.focus();' . "\r\n" . '			$.notification("" + strText + ":you must give one choice at least!" );   ' . "\r\n" . '			return false;' . "\r\n" . '		}' . "\r\n" . '		else return true;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoOptionSamePage(baseID,isList,questionID,isNeg)' . "\r\n" . '{' . "\r\n" . '     var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			   for( i=0;i<objField.options.length;i++ )' . "\r\n" . '			   {' . "\r\n" . '				  theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '				  theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '				  if( theOptionObj != null ){' . "\r\n" . '					  if( objField.options[i].selected && objField.options[i].value != \'\')' . "\r\n" . '					  {' . "\r\n" . '						  theOptionObj.style.display = \'\';' . "\r\n" . '					  }' . "\r\n" . '					  else' . "\r\n" . '					  {' . "\r\n" . '						  if( isNeg == 1 )' . "\r\n" . '						  {' . "\r\n" . '							  if( objField.options[i].value != \'99999\') //前述问题中的排除项' . "\r\n" . '							  {' . "\r\n" . '								  theOptionObj.style.display = \'none\';' . "\r\n" . '								  if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '							  }' . "\r\n" . '						  }' . "\r\n" . '						  else' . "\r\n" . '						  {' . "\r\n" . '							  theOptionObj.style.display = \'none\';' . "\r\n" . '							  if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						  }' . "\r\n" . '					  }' . "\r\n" . '				  }' . "\r\n" . '			   }					   ' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			  for( i=0;i<objField.length;i++ ) {' . "\r\n" . '					theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '				    theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '					if( theOptionObj != null ){' . "\r\n" . '						if(objField[i].checked )' . "\r\n" . '						{' . "\r\n" . '							theOptionObj.style.display = \'\';' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '						    if( isNeg == 1 )' . "\r\n" . '							{' . "\r\n" . '								if( objField[i].value != \'99999\') //前述问题中的排除项' . "\r\n" . '								{' . "\r\n" . '									theOptionObj.style.display = \'none\';' . "\r\n" . '									if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								theOptionObj.style.display = \'none\';' . "\r\n" . '								if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '							}								' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '			  }' . "\r\n" . '		}' . "\r\n" . '	    if( isNeg == 1 ) //有排除项' . "\r\n" . '	 	{' . "\r\n" . '		      theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '			  theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '			  if( getRadioCheckBoxValue(objField) != \'\' ) ' . "\r\n" . '			  {' . "\r\n" . '				  theOptionObj.style.display = \'\';' . "\r\n" . '			  }' . "\r\n" . '			  else' . "\r\n" . '			  {' . "\r\n" . '				  theOptionObj.style.display = \'none\';' . "\r\n" . '				  if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '			  }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoOptionNoSamePage(baseID,theAllValue,theSelectValue,questionID,isNeg)' . "\r\n" . '{' . "\r\n" . '    var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	var theSelectNum = 0;' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '		theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i] + ",") == -1 )' . "\r\n" . '			{' . "\r\n" . '				if( isNeg == 1 ) //有排除项' . "\r\n" . '				{' . "\r\n" . '					if( theAllValueArray[i] != \'99999\')  //本题中的99999选项' . "\r\n" . '					{' . "\r\n" . '						theOptionObj.style.display = \'none\';' . "\r\n" . '						if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					theOptionObj.style.display = \'none\';' . "\r\n" . '					if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				theSelectNum++;' . "\r\n" . '				theOptionObj.style.display = \'\';' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	if( isNeg == 1 ) //有排除项' . "\r\n" . '	{' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '		theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '		if( theSelectNum != 0 ) ' . "\r\n" . '		{' . "\r\n" . '		    theOptionObj.style.display = \'\';' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theOptionObj.style.display = \'none\';' . "\r\n" . '			if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . '//自动选项同页展现' . "\r\n" . 'function getAutoOptionSamePageIsNeg(baseID,isList,questionID,isNeg,baseIsHaveOther)' . "\r\n" . '{' . "\r\n" . '     var objField = eval( "document.Survey_Form.option_" + baseID );' . "\r\n" . '	 if (objField != null ){' . "\r\n" . '		 if( isList == 1 )  //列表框' . "\r\n" . '		 {' . "\r\n" . '			   for( i=0;i<objField.options.length;i++ )' . "\r\n" . '			   {' . "\r\n" . '				  theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '				  theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_"+objField.options[i].value+"\')");' . "\r\n" . '				  if( theOptionObj != null ){' . "\r\n" . '					  if( objField.options[i].selected != true && objField.options[i].value != \'\')' . "\r\n" . '					  {' . "\r\n" . '						  if( isNeg == 1 )' . "\r\n" . '						  {' . "\r\n" . '							  if( objField.options[i].value != \'99999\') //前述问题中的排除项' . "\r\n" . '							  {' . "\r\n" . '								  theOptionObj.style.display = \'\';' . "\r\n" . '							  }' . "\r\n" . '						  }' . "\r\n" . '						  else' . "\r\n" . '						  {' . "\r\n" . '							  theOptionObj.style.display = \'\';' . "\r\n" . '						  }' . "\r\n" . '					  }' . "\r\n" . '					  else' . "\r\n" . '					  {' . "\r\n" . '						  theOptionObj.style.display = \'none\';' . "\r\n" . '						  if( isNeg == 1 )' . "\r\n" . '						  {' . "\r\n" . '							  if( objField.options[i].value != \'99999\') //前述问题中的排除项' . "\r\n" . '							  {' . "\r\n" . '								  if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '							  }' . "\r\n" . '						  }' . "\r\n" . '						  else' . "\r\n" . '						  {' . "\r\n" . '							  if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '						  }' . "\r\n" . '					  }' . "\r\n" . '				  }' . "\r\n" . '			   }' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			  for( i=0;i<objField.length;i++ ) {' . "\r\n" . '					theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '				    theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_"+objField[i].value+"\')");' . "\r\n" . '					if( theOptionObj != null ){' . "\r\n" . '						if(objField[i].checked != true )' . "\r\n" . '						{' . "\r\n" . '						    if( isNeg == 1 )' . "\r\n" . '							{' . "\r\n" . '								if( objField[i].value != \'99999\')  //前述问题中的排除项' . "\r\n" . '								{' . "\r\n" . '									theOptionObj.style.display = \'\';' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								theOptionObj.style.display = \'\';' . "\r\n" . '							}								' . "\r\n" . '						}' . "\r\n" . '						else' . "\r\n" . '						{' . "\r\n" . '							theOptionObj.style.display = \'none\';' . "\r\n" . '						    if( isNeg == 1 )' . "\r\n" . '							{' . "\r\n" . '								if( objField[i].value != \'99999\')  //前述问题中的排除项' . "\r\n" . '								{' . "\r\n" . '									if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '								}' . "\r\n" . '							}' . "\r\n" . '							else' . "\r\n" . '							{' . "\r\n" . '								if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '							}' . "\r\n" . '						}' . "\r\n" . '					}' . "\r\n" . '			  }' . "\r\n" . '		}' . "\r\n" . '	    if( isNeg == 1 ) //有排除项' . "\r\n" . '	 	{' . "\r\n" . '		      theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '			  theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '			  if( getCheckBoxHaveNoCheck(objField,baseIsHaveOther) == true ) ' . "\r\n" . '			  {' . "\r\n" . '				  theOptionObj.style.display = \'\';' . "\r\n" . '			  }' . "\r\n" . '			  else' . "\r\n" . '			  {' . "\r\n" . '				  theOptionObj.style.display = \'none\';' . "\r\n" . '				  if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '			  }' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getAutoOptionNoSamePageIsNeg(baseID,theAllValue,theSelectValue,questionID,isNeg)' . "\r\n" . '{' . "\r\n" . '    var theSelectNum = 0;' . "\r\n" . '	var theAllValueArray = theAllValue.split(\',\');' . "\r\n" . '	for(i=0;i<=theAllValueArray.length-1;i++){' . "\r\n" . '		theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_"+theAllValueArray[i]+"\')");' . "\r\n" . '		if( theOptionObj != null )' . "\r\n" . '		{' . "\r\n" . '			if( theSelectValue.indexOf(","+theAllValueArray[i] + ",") != -1 )' . "\r\n" . '			{' . "\r\n" . '				theOptionObj.style.display = \'none\';' . "\r\n" . '				if( isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					if( theAllValueArray[i] != \'99999\' )   //前述问题中的排除项' . "\r\n" . '					{' . "\r\n" . '						if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '			else' . "\r\n" . '			{' . "\r\n" . '				if( isNeg == 1 )' . "\r\n" . '				{' . "\r\n" . '					if( theAllValueArray[i] != \'99999\' )   //前述问题中的排除项' . "\r\n" . '					{' . "\r\n" . '						theOptionObj.style.display = \'\';' . "\r\n" . '						theSelectNum++;' . "\r\n" . '					}' . "\r\n" . '				}' . "\r\n" . '				else' . "\r\n" . '				{' . "\r\n" . '					theOptionObj.style.display = \'\';' . "\r\n" . '				}' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	if( isNeg == 1 ) //有排除项' . "\r\n" . '	{' . "\r\n" . '	    theOptionObj = eval("document.getElementById(\'auto_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '		theInputObj = eval("document.getElementById(\'eqcheck_"+baseID+"_"+questionID+"_99999\')");' . "\r\n" . '		if( theSelectNum != 0 ) ' . "\r\n" . '		{' . "\r\n" . '		    theOptionObj.style.display = \'\';' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			theOptionObj.style.display = \'none\';' . "\r\n" . '			if(theInputObj != null) theInputObj.getElementsByTagName("input")[0].checked = false;' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . '' . "\r\n" . 'function getCheckBoxHaveNoCheck(objField,baseIsHaveOther)' . "\r\n" . '{' . "\r\n" . '	var isHaveNoCheck = false;' . "\r\n" . '	if( objField.length == null )' . "\r\n" . '	{' . "\r\n" . '		if( objField.tagName.toLowerCase() == \'input\')' . "\r\n" . '		{' . "\r\n" . '			if ( !objField.checked)  isHaveNoCheck = true;' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ){' . "\r\n" . '			    if( !objField.item(i).selected && objField.item(i).value != \'\' ) ' . "\r\n" . '			    {' . "\r\n" . '			       isHaveNoCheck = true;' . "\r\n" . '				   break;' . "\r\n" . '			    }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		if( objField[0].tagName.toLowerCase() == \'input\')' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.length;i++){		' . "\r\n" . '				if ( !objField[i].checked && objField[i].value != \'\' )' . "\r\n" . '			    {' . "\r\n" . '				   	if( objField[i].value == \'99999\' ) //互斥项' . "\r\n" . '					{' . "\r\n" . '						continue;' . "\r\n" . '					}' . "\r\n" . '				   	if( baseIsHaveOther != 1 && objField[i].value == \'0\' )' . "\r\n" . '					{' . "\r\n" . '						continue;' . "\r\n" . '					}' . "\r\n" . '			        isHaveNoCheck = true;' . "\r\n" . '				    break;' . "\r\n" . '			    }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			for( i=0;i<objField.options.length;i++ ){' . "\r\n" . '			    if( !objField.item(i).selected && objField.item(i).value != \'\' )' . "\r\n" . '			    {' . "\r\n" . '			       isHaveNoCheck = true;' . "\r\n" . '				   break;' . "\r\n" . '			    }' . "\r\n" . '			}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	return isHaveNoCheck;' . "\r\n" . '}' . "\r\n" . '';

?>
