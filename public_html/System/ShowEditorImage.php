<?php
//dezend by http://www.yunlu99.com/
echo '<html>' . "\r\n" . '<head>' . "\r\n" . '<meta http-equiv=content-language content=zh-cn>' . "\r\n" . '<meta http-equiv=content-type content="text/html; charset=gbk">' . "\r\n" . '<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">' . "\r\n" . '<LINK href="../CSS/Base.css" rel=stylesheet>' . "\r\n" . '<script type="text/javascript" src="../JS/Jquery.min.js.php"></script>' . "\r\n" . '<script type="text/javascript" src="../JS/Jquery.notification.js.php"></script>' . "\r\n" . '<link type="text/css" rel="stylesheet" href="../CSS/Notification.css" />' . "\r\n" . '<SCRIPT language=javascript src="../JS/CheckQuestion.js.php"></SCRIPT>' . "\r\n" . '<SCRIPT language=javascript src="../JS/CheckEditorImage.js.php"></SCRIPT>' . "\r\n" . '<style>' . "\r\n" . ' td { padding:2px 5px 2px 5px;}' . "\r\n" . ' #jquery-notification-message {width:100%;}' . "\r\n" . '</style>' . "\r\n" . '<SCRIPT type=text/javascript>' . "\r\n" . 'function IsDigit(){' . "\r\n" . '   return ((event.keyCode >= 48) && (event.keyCode <= 57));' . "\r\n" . '}' . "\r\n" . 'function Check_Form_Validator(){' . "\r\n" . '	var ie = document.all && !window.opera;' . "\r\n" . '	if( ie )' . "\r\n" . '	{' . "\r\n" . '		if( IsInCheckBox(document.Image_Form.picType,1) )' . "\r\n" . '		{' . "\r\n" . '			if (!CheckNotNull(document.Image_Form.picImage, "上传图片文件")) {return false;}' . "\r\n" . '		}' . "\r\n" . '		else' . "\r\n" . '		{' . "\r\n" . '			if (!CheckNotNull(document.Image_Form.wmvpath, "视频文件所在的地址")) {return false;}' . "\r\n" . '			var AllowExt=".flv|.mp4|";' . "\r\n" . '			var theFileURL = Trim(document.Image_Form.wmvpath.value);' . "\r\n" . '			var FileExt = theFileURL.substr(theFileURL.lastIndexOf(".")).toLowerCase();' . "\r\n" . '			if( AllowExt.indexOf(FileExt + "|") == -1) ' . "\r\n" . '			{' . "\r\n" . '				$.notification("视频文件的扩展名仅允许指定.flv|.mp4类型");' . "\r\n" . '				return false;' . "\r\n" . '			}' . "\r\n" . '			if (!CheckNotNull(document.Image_Form.wmvwidth, "视频文件的宽度")) {return false;}' . "\r\n" . '			if (!CheckNumber(document.Image_Form.wmvwidth, "视频文件的宽度",50,1024)) {return false;}' . "\r\n" . '			if (!CheckNotNull(document.Image_Form.wmvheight, "视频文件的高度")) {return false;}' . "\r\n" . '			if (!CheckNumber(document.Image_Form.wmvheight, "视频文件的高度",50,860)) {return false;}' . "\r\n" . '		}' . "\r\n" . '	}' . "\r\n" . '	else' . "\r\n" . '	{' . "\r\n" . '		$.notification("本系统功能在非IE浏览器工作可能不正常，请依据附属文件管理页面说明的指引完成此功能动作。");' . "\r\n" . '		return false;' . "\r\n" . '	}' . "\r\n" . '}' . "\r\n" . 'function AjaxCallBack(backMsg,fileType,picWidth,picHeight,backURL) {' . "\r\n" . '	var htmlStr;' . "\r\n" . '	switch( fileType )' . "\r\n" . '	{' . "\r\n" . '		case 1:  //图片' . "\r\n" . '		    htmlStr  = "<img SRC=" + backMsg + " border=0>";' . "\r\n" . '		break;' . "\r\n" . '		case 2:  //Flash' . "\r\n" . '		    htmlStr = "<embed src=" + backMsg + " quality=high wmode=transparent width="+picWidth+" height=" + picHeight + "  pluginspage=http://www.macromedia.com/shockwave/download/index.cgi?P1_Prod_Version=ShockwaveFlash type=application/x-shockwave-flash></embed>";' . "\r\n" . '		break;' . "\r\n" . '		case 4:  //flv,mp4' . "\r\n" . '			htmlStr = "<embed src=\'"+backURL+"JS/flvplayer.swf\' flashvars=\'&autoplay=true&sound=70&buffer=2&vdo="+backMsg+"\' width="+ picWidth + "height=" + picHeight + " allowFullScreen=\'true\' quality=\'best\' wmode=\'transparent\' pluginspage=\'http://www.macromedia.com/go/getflashplayer\' type=\'application/x-shockwave-flash\'></embed>";' . "\r\n" . '		break;' . "\r\n" . '	}' . "\r\n" . '	parent.editTextRange.pasteHTML(htmlStr);' . "\r\n" . '	parent.hidePopWin();' . "\r\n" . '}' . "\r\n" . 'function Init()' . "\r\n" . '{' . "\r\n" . '	document.getElementById(\'picImage\').focus();' . "\r\n" . '}' . "\r\n" . '</SCRIPT>' . "\r\n" . '<meta content="mshtml 6.00.3790.0" name=generator></head>' . "\r\n" . '<body oncontextmenu="return false" onload="javascript:Init();">' . "\r\n" . '  <table class=datatable style="line-height: 150%;border-collapse:collapse;" cellspacing=0 cellpadding=0 bordercolor=#cacaca border=1 width=100%>' . "\r\n" . '  <form name="Image_Form" enctype="multipart/form-data" method="post" action="AjaxEditorImage.php" onsubmit="return Check_Form_Validator()" target="hidden_frame">' . "\r\n" . '	  <DIV class=position>位置：&nbsp; 我的桌面 &raquo; 插入图片或视频</DIV>' . "\r\n" . '      <tr><td colspan="2" bgcolor="#f9f9f9"><b>插入图片或视频</b></td></tr>' . "\r\n" . '      <TR> ' . "\r\n" . '         <TD width=24%><input type="radio" name="picType" value="1" checked>&nbsp;<span class=red>选择本地文件：</span></TD>' . "\r\n" . '         <TD><input type="file" name="picImage" size="48" onchange="CheckExt(this)"><br/>' . "\r\n" . '		     <b><font color=red>*</font></b>文件扩展名限制在.jpg|.gif|.png|.swf<br/>' . "\r\n" . '		     <b><font color=red>*</font></b>图片文件限制在（宽*高：1200 px* 1000 px，大小：700K）' . "\r\n" . '		 </TD>' . "\r\n" . '      </TR>' . "\r\n" . '       <TR> ' . "\r\n" . '         <TD><input type="radio" name="picType" value="2">&nbsp;<span class=red>插入视频：</span></TD>' . "\r\n" . '         <TD>地址：<input id="wmvpath" name="wmvpath" size=58 value="http://"><br/>' . "\r\n" . '             宽度：<input id="wmvwidth" name="wmvwidth" onkeypress="event.returnValue=IsDigit();" value=320 size=7 maxlength="4"><br/>' . "\r\n" . '			 高度：<INPUT id="wmvheight" name="wmvheight" onkeypress="event.returnValue=IsDigit();" value=280 size=7 maxlength="4"><br/>' . "\r\n" . '		     <b><font color=red>*</font></b>文件扩展名限制在.flv|.mp4<br/>' . "\r\n" . '		 </TD>' . "\r\n" . '      </TR>' . "\r\n" . '  <table><table width=100%>' . "\r\n" . '     <TR><td width=23%></td>' . "\r\n" . '         <TD> ' . "\r\n" . '			<input class=inputsubmit type="submit" name="AddSubmit" id="submitAction" value="确定">' . "\r\n" . '            <input class=inputsubmit type="button" name="close" value="关闭" onClick="javascript:parent.hidePopWin();">' . "\r\n" . '         </TD>' . "\r\n" . '     </TR>' . "\r\n" . '	 <iframe name=\'hidden_frame\' id="hidden_frame" style=\'display:none\'></iframe>' . "\r\n" . '  </form>' . "\r\n" . '</table>' . "\r\n" . '</body></html>';

?>
